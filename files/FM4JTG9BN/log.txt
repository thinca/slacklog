]51;["call","Tapi_reg",["set","\"","diff --git a/macros/vimreg.sh b/macros/vimreg.sh\nindex d42a360..8c478c2 100644\n--- a/macros/vimreg.sh\n+++ b/macros/vimreg.sh\n@@ -24,7 +24,11 @@ vimreg() {\n     cat \"$fifo\"\n     rm \"$fifo\"\n   else\n-    __call_tapi_reg set \"$reg\" \"$(cat)\"\n+    # fifo=$(mktemp -u)\n+    # mkfifo \"$fifo\"\n+    # $(cat) >$fifo\n+    # __call_tapi_reg set \"$reg\" \"$fifo\"\n+    __call_tapi_reg set \"$reg\" \"$(cat)\" | tee log\n   fi\n }\n \ndiff --git a/plugin/tapi_reg.vim b/plugin/tapi_reg.vim\nindex 3e22e2f..5504de8 100644\n--- a/plugin/tapi_reg.vim\n+++ b/plugin/tapi_reg.vim\n@@ -8,12 +8,14 @@ set cpo&vim\n \n \n function! Tapi_reg(bufnr, args) abort\n+  PP! [a:bufnr, a:args]\n   if empty(a:args)\n     return\n   endif\n   if a:args[0] ==# 'set' && len(a:args) >= 3\n     if !s:set_clipboard(a:args[1], a:args[2])\n-      call call('setreg', a:args[1:])\n+      let [reg, value] = a:args[1:2]\n+      call setreg(reg, value)\n     endif\n   elseif a:args[0] ==# 'get' && len(a:args) >= 3\n     if a:args[1] ==# '--list'\n@@ -28,9 +30,12 @@ function! Tapi_reg(bufnr, args) abort\n endfunction\n \n function! s:set_clipboard(reg, value) abort\n-  if (a:reg ==# '+' || a:reg ==# '*') && !has('clipboard') && s:is_wsl()\n-    call system('clip.exe', a:value)\n-    return !v:shell_error\n+  if (a:reg ==# '+' || a:reg ==# '*') && !has('clipboard')\n+    let cmd = s:is_wsl() ? 'clip.exe' : has('macunix') ? 'pbcopy' : ''\n+    if !empty(cmd)\n+      call system('clip.exe', a:value)\n+      return !v:shell_error\n+    endif\n   endif\n   return 0\n endfunction"]]