[{"client_msg_id":"553b7739-880c-4982-9f82-b54796c486ba","type":"message","user":"U6XP9LZ6V","text":"vim.exe が 8.2.0539 ～ 8.2.0548 のどこかで壊れた。`j` 連打でスクロールしても、一番下の行しか更新されない。怪しいのは 8.2.0547 かな？","ts":"1586774610.099000","team":"T03C4RC8V","reactions":[{"name":"fuita","count":4,"users":["UAZ33BKV2","U9S4G0LJW","U7JL1UKKL","UEBF2KQTD"]},{"name":"sweat_smile","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rEsaM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b3ce075d-549d-457e-a43e-51f436551906","type":"message","user":"UFZL441S8","text":"longcat　が　おそってきた！\nとかではなく(;´Д`)えー…VTP のフラグが立ってないか倒れてしまったかのどちらかでその症状になります、今から再検討をかけます…","ts":"1586775802.101700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5ARS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"485efe6f-ae0b-4b16-8fdd-f52e8af0748c","type":"message","user":"UFZL441S8","text":"当方ではいまのところ再現できていません、os_win32.c の FEAT_RESTORE_ORG_SCREEN を FEAT_RESTORE_ORIG_SCREEN に置換して治りますか？\nすみません、お手隙の際にで構いませんので、見てみてください…","ts":"1586776781.104500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y=Lhv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3f6b4ef2-2e7b-4884-a41a-944df8e8ba98","type":"message","user":"U6XP9LZ6V","text":"ORG -&gt; ORIG にしてみましたが、ダメでした。\n8.2.0547 を revert したら現象は起きなくなったので、それが原因なのは確定しました。","ts":"1586779275.106500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=JN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bf07a8ad-4328-4aa2-9c26-12984a18d30d","type":"message","user":"UB88NP1PY","text":"うっかり間違ってこんな形で `job_start` を呼び出してしまったんですが、この呼び出しの後で SIGSEGV が発生することがあることが分かりました。\n```call job_start(['grep', '-nE', ['foo', 'bar'], '.vimrc'])```","ts":"1586785654.110700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UFpc6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eeb4287d-3461-4869-8fa2-5e8843f73f7b","type":"message","user":"UB88NP1PY","text":"`job_start` -&gt; `build_argv_from_list` -&gt; `tv_get_string_chk` で期待しないリストに気付いたあとに `vim_free` して、`return FAIL` で `job_start` に戻ってきた後に `theend` に飛んで、そこでまた `argv` の要素を vim_free (double free) しているのが問題じゃないかと思ってます。","ts":"1586785681.111000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4qR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"283bc60c-400e-4e8b-8305-05e8f395fd5e","type":"message","user":"U9S4G0LJW","text":"一発でSEGVした","ts":"1586785687.111200","team":"T03C4RC8V","reactions":[{"name":"pray","count":1,"users":["UB88NP1PY"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ROb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e3a4e095-91a9-41af-8e91-f71f39fa87ae","type":"message","user":"U9S4G0LJW","text":"Linux Vim8.2.0566ですが、再現しますね","ts":"1586785742.111900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OZbGd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"487d2985-18ab-442a-8249-d2711008f0e9","type":"message","user":"U03C6TEAZ","text":"1個目しか確認してないですね。","ts":"1586785787.112100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Mpy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2c3412b3-bdbf-4159-97e1-a5e9c0547395","type":"message","user":"U03C6TEAZ","text":"<https://github.com/vim/vim/blob/d1caa941d876181aae0ebebc6ea954045bf0da24/src/channel.c#L5980>","ts":"1586785823.112300","attachments":[{"fallback":"GitHub: vim/vim","id":1,"title":"vim/vim","title_link":"https://github.com/vim/vim/blob/d1caa941d876181aae0ebebc6ea954045bf0da24/src/channel.c#L5980","text":"The official Vim repository. Contribute to vim/vim development by creating an account on GitHub.","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/blob/d1caa941d876181aae0ebebc6ea954045bf0da24/src/channel.c#L5980","original_url":"https://github.com/vim/vim/blob/d1caa941d876181aae0ebebc6ea954045bf0da24/src/channel.c#L5980"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cSG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"12b0752e-4da6-4a6b-a48a-7b452b13eece","type":"message","user":"UB88NP1PY","text":"素人考えだと、`build_argv_from_list` で vim_free した後に `(*argv)[i] = NULL` すればいいかなと思ったんですけどどうでしょう。","ts":"1586785983.113500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sfqR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a11fc093-6df9-44a6-a52a-616a3f8b574b","type":"message","user":"UB88NP1PY","text":"あー、それとも先に全部の要素を確認する？","ts":"1586786108.113900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RH="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ca4c30f8-7dda-433e-8c78-ff1263c52684","type":"message","user":"U03C6TEAZ","text":"はい。いいと思います。","ts":"1586787238.114100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y1d="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"32a280fe-0e28-4868-86f1-669bb1c486c4","type":"message","user":"UB88NP1PY","text":"確認どうもありがとうございます:bow: `(*argv)[i] = NULL` ですよね？正直 `conpty_term_and_job_init` と `winpty_term_and_job_init` から呼ばれているほうに side effect がないかどうかあまり分かっていないのですが。","ts":"1586787433.115900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fwJMR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"160c5563-853e-467d-9084-124e75dde735","type":"message","user":"UB88NP1PY","text":"PR 出しました。\n<https://github.com/vim/vim/pull/5926>","ts":"1586789466.116200","attachments":[{"fallback":"GitHub: Fix double free due to unexpected nesting list arg for job_start() by mnishz · Pull Request #5926 · vim/vim","id":1,"title":"Fix double free due to unexpected nesting list arg for job_start() by mnishz · Pull Request #5926 · vim/vim","title_link":"https://github.com/vim/vim/pull/5926","text":"Problem: job_start() doesn&amp;#39;t know if each argv element has already been freed. Solution: Set NULL to each argv element. Describe the bug Vim is halted by SIGSEGV. To Reproduce...","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/pull/5926","original_url":"https://github.com/vim/vim/pull/5926"}],"team":"T03C4RC8V","reactions":[{"name":"+1","count":4,"users":["U9S4G0LJW","U77U7B85A","U0M7GCBPD","UGHD6GP16"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xS3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
