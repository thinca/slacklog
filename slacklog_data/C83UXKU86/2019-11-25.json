[{"client_msg_id":"3cfc0473-5869-402c-adab-58433fa2c88e","type":"message","user":"U6XP9LZ6V","text":"rand() が入る機運が高まってきた。\n<https://github.com/vim/vim/pull/1277#issuecomment-557936490>","ts":"1574640886.147500","attachments":[{"fallback":"GitHub: [todo] add rand(), srand() by mattn · Pull Request #1277 · vim/vim","id":1,"title":"[todo] add rand(), srand() by mattn · Pull Request #1277 · vim/vim","title_link":"https://github.com/vim/vim/pull/1277#issuecomment-557936490","text":"This add Xorshift random generator. In general implementation, srand() may be called from some plugins in several times. So it need to have statefull random generator like Xorshift. Below is an usa...","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/pull/1277#issuecomment-557936490","original_url":"https://github.com/vim/vim/pull/1277#issuecomment-557936490"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yuyU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5482360d-b5fa-4691-b9d5-d2f9c2723179","type":"message","user":"U03C71D7H","text":"rand() の PR 眺めてたんですが、 `srand()` の実装がまだ終わってない?","ts":"1574650538.148100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4cxV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"efa5f9a6-8985-4467-b624-304d10c607ae","type":"message","user":"U03C6TEAZ","text":"xorshift の srand って最初の項目のみユーザに指定させる物が多いんですが、そうじゃない方がいいです？","ts":"1574650638.148800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+wiG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f8ed898e-e9d6-412f-8e79-9d03d009fabd","type":"message","user":"U03C71D7H","text":"いや、ドキュメントだと負数の場合に時間を使うって書いてあるんですけど、その実装がなさそうだな、と\nあと引数を省略した場合が固定値ですけど、これっていいんでしょうか?","ts":"1574650775.149800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"M7v"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d5979ad1-e91d-4ad2-ba05-a670abd2182f","type":"message","user":"U03C6TEAZ","text":"完全にそこ抜けてますね。","ts":"1574650918.150400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JMM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56c8881f-04dc-4d47-b1e6-255a9fafc79f","type":"message","user":"U03C6TEAZ","text":"<https://github.com/vim/vim/pull/1277/files#diff-8b45c2119adf39fb1ea787e5b46cd3e4R4093>","ts":"1574650944.151100","attachments":[{"fallback":"GitHub: [todo] add rand(), srand() by mattn · Pull Request #1277 · vim/vim","id":1,"title":"[todo] add rand(), srand() by mattn · Pull Request #1277 · vim/vim","title_link":"https://github.com/vim/vim/pull/1277/files#diff-8b45c2119adf39fb1ea787e5b46cd3e4R4093","text":"This add Xorshift random generator. In general implementation, srand() may be called from some plugins in several times. So it need to have statefull random generator like Xorshift. Below is an usa...","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":250,"thumb_height":250,"from_url":"https://github.com/vim/vim/pull/1277/files#diff-8b45c2119adf39fb1ea787e5b46cd3e4R4093","original_url":"https://github.com/vim/vim/pull/1277/files#diff-8b45c2119adf39fb1ea787e5b46cd3e4R4093"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RFs9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a38fc745-8b40-4611-a4f1-f43895e18e79","type":"message","user":"U03C6TEAZ","text":"これか","ts":"1574650946.151500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JL4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c2f665d8-a136-4f8f-a40c-54f1c08baf01","type":"message","user":"UAZ33BKV2","text":"乱数は、単純に乱数が欲い層と、ゲームや分析系の再現性のある乱数が設定できるものが欲い層がいますから、微妙?","ts":"1574650977.152100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KiNl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"38bff09a-bdf3-46c9-bcff-a72fd5473b3a","type":"message","user":"U03C71D7H","text":"そこは `rand()` 側なので微妙に違いそうだなぁ、と","ts":"1574651333.152600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lF=Q"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0456b211-69b2-476b-b4a1-acdb4b684c40","type":"message","user":"UAZ33BKV2","text":"あ、まあ乱数全体を指しての発言なので、 `srand()` とは関係ないですな","ts":"1574651405.153300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lpZ17"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"648b8eff-ca85-4b08-9dac-789f49821daa","type":"message","user":"U03C6TEAZ","text":"srand() 呼ばずに rand() だけ欲しい人いると思うんですよね。あと別のプラグインが srand() 読んだのに他のプラグインが srand() 呼び出すみたいなケースもある。","ts":"1574651522.154100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hK8aP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2373eb04-b202-490d-9729-0d1c3f7ff56b","type":"message","user":"U03C71D7H","text":"実際、それはあった方がいいと思います。","ts":"1574651556.154400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"u992"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f14f92a7-9163-401e-aa81-a61c9d907acc","type":"message","user":"U03C71D7H","text":"それはそれとしてプラグインでちゃんとシードを保存して使う場合、ひとまず初期値として `srand()` を使うと思うので、\n\n\n```let s:plugin_seed = srand()\n\nlet r = rand(s:plugin_seed)```\n\nみたいなコードをプラグイン作者は書くと思うんですが、現状だと引数なし `srand()` は毎回全く同じ値を返す実装なのでゲームを作った場合毎回同じ展開になってしまいますね…","ts":"1574651664.156500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/Mi0W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6f1e83b2-a61c-439b-9643-4d7f60ae8f4a","type":"message","user":"U03C6TEAZ","text":"あとは `srand()` で `time(NULL)` するコードがあれば良さそうかな。","ts":"1574651721.157300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"K4Qx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"597e6b4e-824c-4847-a053-105cc1a9a4b4","type":"message","user":"U03C71D7H","text":"`srand(-1)` で `time(NULL)` ですかね?","ts":"1574651792.157900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"S7JR="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eac49a48-65a3-4dd0-aced-e8782db032ac","type":"message","user":"U03C71D7H","text":"引数なしの場合も毎回いい感じに違う値が返ってきてくれると嬉しい…内部で `rand()` (引数なし)を呼び出してその値を使うとかで良いので","ts":"1574651834.158700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uY1L"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4583e44e-f235-4dfe-bc6e-373cd71259f6","type":"message","user":"U03C6TEAZ","text":"-1 いらんな","ts":"1574651959.160600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3+E0g"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4d011548-65e5-4566-a1e0-2d0cdf34c51f","type":"message","user":"U03C6TEAZ","text":"`rand()` → 内部的に `time(NULL)` で種初期化(`srand()` 相当)、rand() だけできればよさげ。","ts":"1574651995.161000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZE8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"425c932b-e860-42dd-bb05-945cf8739d93","type":"message","user":"U03C71D7H","text":"えーと、つまり `srand()` が私が今言った挙動になる?","ts":"1574652316.162000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r/njE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4ad3277e-89dc-474d-9042-9bdc8c8ef77c","type":"message","user":"U03C6TEAZ","text":"`srand()` と `srand(-1)` 同じでいいよね (srand(-1) 廃止)という意味で言いました。","ts":"1574652660.162800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UgI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3e786187-d1ee-41d7-8832-31f6e9389db6","type":"message","user":"U03C71D7H","text":"なるほど","ts":"1574652695.163100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"A/B4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8f6b5171-01a3-4b71-a784-f858e5e2ed8e","type":"message","user":"U03C6TEAZ","text":"`srand()` で time(NULL)","ts":"1574652698.163200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kx9F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dbb77f38-d10c-44dc-b497-d1270dfa581d","type":"message","user":"U03C71D7H","text":"そう言えば生成される値が 32 bit 値なことに Bram も触れてますね。今の Vim script は標準で 64 bit なので、今のままにするにしてもドキュメントで補足があるといいかもしれないですね","ts":"1574652781.164100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jwd1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b0c43c2a-dafa-4aec-9bf6-e9f40a1fca0e","type":"message","user":"U03C71D7H","text":"64 bit の値が欲しい場合は 2 回生成して shift を…と思ったけど Vim script には shift() がないやん","ts":"1574652874.164700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/wJsx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a563e21e-9eb4-4a8e-8496-fec9e76eb80c","type":"message","user":"U03C6TEAZ","text":"64bit 対応してテストも if で分けるとかの方がいいんだろうか。","ts":"1574652901.165100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7w9Io"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ac7886e8-1288-427d-8c0f-24fada713857","type":"message","user":"U03C71D7H","text":"どうするのがいいんだろw","ts":"1574653007.165600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"48V"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7f55b75b-c335-4a5d-9215-27cc1ae7047e","type":"message","user":"UAZ33BKV2","text":"そして、64bitがunsignedではないので、負の数まで考えて作らないとダメになる...かな?","ts":"1574653024.166000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yZHEF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3eb49cbc-4d86-4300-b1ed-f40d2b21a65a","type":"message","user":"UAZ33BKV2","text":"(64bitはtinyでもonかな...?、がちょっとわかってなくて気になる)","ts":"1574653076.166900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oUl5O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cfef442d-3031-4a5f-81fd-f74ce50e3498","type":"message","user":"U03C71D7H","text":"そもそも今って `-num64` でのビルドは可能なんだっけ","ts":"1574653097.167300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XmGhu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"726cfe15-e1c0-401d-b632-303a37b66680","type":"message","user":"UAZ33BKV2","text":"が、よくわからない...永続化されたfeatureもそれなりにありますよねー...、num64はいってるかな?","ts":"1574653144.168100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ygq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"407bf63d-cf98-4488-b7a5-cf17f7903700","type":"message","user":"U03C71D7H","text":"`rand() * float2nr(pow(2, 32)) + rand()`","ts":"1574653292.170300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1okO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"95432220-951d-4de7-80c6-0bfd4f9ae115","type":"message","user":"U6XP9LZ6V","text":"コンパイラが対応していれば勝手にnum64はonになるけど、vim.h辺りをいじればoffにできたっけ？忘れた。","ts":"1574653355.172100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bf66e1e7-9202-4f65-b06f-b7d3b191e98d","type":"message","user":"UBRTB4N5C","text":"32bit の乱数2個をくっつけて 64bit の乱数を生成って分布に不安がありそう。 <http://www001.upp.so-net.ne.jp/isaku/rand.html>","ts":"1574654024.172800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IHkqg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c0c66276-4758-4fd9-a848-cf6dea6555e0","type":"message","user":"U03C71D7H","text":"実際どうするのがいいのか知見がまったくない","ts":"1574656725.173500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0GmGi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"df9700ff-8659-4ed7-8ff1-aac801c642cb","type":"message","user":"U06BRP8VD","text":"線形合同法の2つをくっつけるのはめちゃくちゃ悪手ですね。ログ読んでないのでどのくらいの強度が必要なのかわかりませんけど。","ts":"1574658119.174300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BhCu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7d4616f5-4e24-4bb7-9e2d-9d49c73bb20a","type":"message","user":"U06BRP8VD","text":"メルセンヌ・ツイスタも登場から20年以上経つのか…","ts":"1574658236.174600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+Q1I"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ea5b5362-97aa-48b9-af78-ac98ee1dca4e","type":"message","user":"U06ECBRTJ","text":"```MTは、１５０年から５０年ぐらい前に研究された、 当時は社会的効用の望めなかった ようなタイプの純粋数学、特に古い数論に基づくアルゴリズムです。近年、純粋 数学に対する風当たりが強く、大学などでも数学科が閉鎖されて代わりに応用的な 学科が作られたりしていますが、これが長期的に見て良いことかは疑問に思います。 純粋数学は、見えにくいところで、思いがけない大きな成果を 挙げていき続けています。このことを、心の隅に置いて頂けると幸いです。 ```","ts":"1574658515.175300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"khp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"349b074f-dbce-4855-ae30-f5d81ddce98b","type":"message","user":"UAZ33BKV2","text":"分布の安全性の意味で、メルセンヌツイスタなら連結でもそれなりかも?\nというか素で64bitで生成して、32bitはカットオフで出すように作ったほうがいいか...","ts":"1574658536.176200","edited":{"user":"UAZ33BKV2","ts":"1574658858.000000"},"team":"T03C4RC8V","reactions":[{"name":"tashikani","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FMIXA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d57788b6-6c6c-4a45-b9d8-a9bfac942140","type":"message","user":"U06ECBRTJ","text":"公式サイトによると、アルゴリズムの元はもっと前なんですね","ts":"1574658540.176300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ru3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"76703092-9a83-4a7a-9dfc-4c1e2d9ce0a9","type":"message","user":"U06BRP8VD","text":"MT19337出てきたときは、あらゆるところに導入を図ったわw","ts":"1574658810.176900","team":"T03C4RC8V","reactions":[{"name":"goodpoem","count":2,"users":["UAZ33BKV2","U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"18qwu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
