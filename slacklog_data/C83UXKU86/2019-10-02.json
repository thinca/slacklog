[{"client_msg_id":"9854d63a-82ae-4025-bd10-59f34e8f74b3","type":"message","user":"UAZ33BKV2","text":"環境(Linux、Windows、Mac)依存というか、リンクするlibcなライブラリによるのかもしれませんが、あまりよくない気はしますね...","ts":"1569999824.120200","team":"T03C4RC8V","reactions":[{"name":"bug","count":1,"users":["U7D5LRRQD"]},{"name":"sorena","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0596febb-0171-4d46-9536-56c2d0f6a068","type":"message","user":"U03C6TEAZ","text":"どの部分でしょうか？","ts":"1569999856.120400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e7930f9f-e5a8-4073-81c2-1967a21d838d","type":"message","user":"U03C6TEAZ","text":"`ga.ga_data` が NULL のまま `ga_append` が使われてるという事かな？","ts":"1569999939.120900","thread_ts":"1569999939.120900","reply_count":2,"replies":[{"user":"U7D5LRRQD","ts":"1570000873.122900"},{"user":"U7D5LRRQD","ts":"1570000921.123200"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1209f06f-d28a-407c-896a-b23b00e47f57","type":"message","user":"U03C6TEAZ","text":"最近のCだと mem_realloc/realloc の第一引数 NULL で malloc と同じ動作をするのは仕様な気がしますね。","ts":"1570000109.121500","team":"T03C4RC8V","reactions":[{"name":"angxing","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0f9b6b4f-2e39-4f52-b139-18b00ac921d0","type":"message","user":"UAZ33BKV2","text":"最近のCのライブラリがリンクするならいいけど、マイナー環境かつ古いとよくなさそう、くらいかなあ?","ts":"1570000154.122400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f648e6b1-8d33-4d9a-b2f4-6febb22f7931","type":"message","user":"U03C6TEAZ","text":"第二引数が 0 のやつはまだ環境依存が残ってそうだけど。","ts":"1570000157.122500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"369cb8fd-0cf3-480d-8ad5-3383b3e43f1b","type":"message","user":"U03C6TEAZ","text":"いっそコメント消すでもいいかもしれない。","ts":"1570000171.122800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6f8eca77-9f64-42b1-b838-e5d7d3f02c50","type":"message","user":"U7D5LRRQD","text":"です:+1:\n例えば `eval_to_string()` のここらへんとかですね。\n`ga_append()` 内部で `ga_data` への `vim_realloc()` が発生しているように見受けられます！\n```c\n\t    ga_init2(&amp;ga, (int)sizeof(char), 80);\n\t    if (tv.vval.v_list != NULL)\n\t    {\n\t\tlist_join(&amp;ga, tv.vval.v_list, (char_u *)\"\\n\", TRUE, FALSE, 0);\n\t\tif (tv.vval.v_list-&gt;lv_len &gt; 0)\n\t\t    ga_append(&amp;ga, NL);\n\t    }\n\t    ga_append(&amp;ga, NUL);\n```","ts":"1570000873.122900","thread_ts":"1569999939.120900","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":null,"root":{"client_msg_id":"e7930f9f-e5a8-4073-81c2-1967a21d838d","type":"message","user":"U03C6TEAZ","text":"`ga.ga_data` が NULL のまま `ga_append` が使われてるという事かな？","ts":"1569999939.120900","thread_ts":"1569999939.120900","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null}},{"client_msg_id":"64612828-570b-4c06-991e-866473e76db1","type":"message","user":"U7D5LRRQD","text":"（ `ga_init()` や `ga_init2()` が `ga.ga_data` をNULLに初期化している）","ts":"1570000921.123200","thread_ts":"1569999939.120900","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":null,"root":{"client_msg_id":"e7930f9f-e5a8-4073-81c2-1967a21d838d","type":"message","user":"U03C6TEAZ","text":"`ga.ga_data` が NULL のまま `ga_append` が使われてるという事かな？","ts":"1569999939.120900","thread_ts":"1569999939.120900","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null}},{"client_msg_id":"b3450276-55d4-4d5b-a72b-93142babae64","type":"message","user":"U7D5LRRQD","text":"なるほど、最近の開発ライブラリだと大丈夫そうなのですね。\nよかったです :sunglasses:","ts":"1570001003.125000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0fa96be0-f8da-4f1d-945c-361f00fc9a24","type":"message","user":"U03C6TEAZ","text":"`ga_init2` のあと `ga_grow` するの、かなり昔からやってるので、報告きてないって事はかまわないって事だと思っています。","ts":"1570001006.125100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7ce7523c-65e6-4e4d-848a-9d88bb3bb1ab","type":"message","user":"U7D5LRRQD","text":"ww :angxing:","ts":"1570001033.125500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"67e450c5-e7f9-44c7-8952-91aa9ab9231c","type":"message","user":"U7986PPFH","text":"<https://qiita.com/AoiMoe/items/0e654a81d2ee70792070#comment-22c036ee3ad8ffffb0b6>","ts":"1570002458.125900","attachments":[{"fallback":"Qiita: reallocの怪 - Qiita","id":1,"title":"reallocの怪 - Qiita","title_link":"https://qiita.com/AoiMoe/items/0e654a81d2ee70792070#comment-22c036ee3ad8ffffb0b6","text":"# 三行で頼む[^1] [^1]: なお、この話はもともとツイッターでやってたものを記事として書き起こしたものです。[まとめ](<http://togetter.com/li/1056979>) - **realloc(ptr, 0...","thumb_url":"https://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png","thumb_width":200,"thumb_height":200,"from_url":"https://qiita.com/AoiMoe/items/0e654a81d2ee70792070#comment-22c036ee3ad8ffffb0b6","original_url":"https://qiita.com/AoiMoe/items/0e654a81d2ee70792070#comment-22c036ee3ad8ffffb0b6"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7faff2e0-5b1b-4c0b-8e59-0da4eb6f5347","type":"message","user":"U7986PPFH","text":"`realloc(NULL, size)` `malloc(size)` の等価性はC90からあるようですが","ts":"1570002511.126800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"86faa15c-a8b4-429a-913e-67402dbc3e11","type":"message","user":"U03C6TEAZ","text":"~<http://dawsonjon.github.io/Chips-2.0/user_manual/c_library.html> (C89)~\n&gt;  If ptr is a null pointer, the realloc function behaves like the malloc function for the specified size.~~","ts":"1570002621.127200","edited":{"user":"U03C6TEAZ","ts":"1570002710.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4efd8bc9-09cb-4e56-b542-59f19ef1db82","type":"message","user":"U03C6TEAZ","text":"あ、この C89 ってのは関数単位か。","ts":"1570002663.127500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cb95e816-aa7c-40c8-8250-a4c7836c2e3f","type":"message","user":"UAZ33BKV2","text":"うへえ","ts":"1570002912.128100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ad085eb8-b85b-4d5c-9fc7-5cdc136597af","type":"message","user":"U03C6TEAZ","text":"て事はコメント削除かなw","ts":"1570003245.128900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ac9989a3-6cee-40e1-a132-e277eb3759ab","type":"message","user":"U03C6TEAZ","text":"develop.txt には\n&gt; The minimal C compiler version supported is C89, also known as ANSI C.\nと書かれてる。","ts":"1570003270.129400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ede0ff60-4e09-4480-93cf-80e798e5879c","type":"message","user":"UAZ33BKV2","text":"そもそもreallocは使わないほうがよさそうな気はしちゃうけど...リサイズ自体は必要なんですよね...","ts":"1570003282.129700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3bf96d3b-6d91-4559-ab60-0f32985ef66d","type":"message","user":"U03C6TEAZ","text":":help C89","ts":"1570003295.129900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U894RTUJY","text":"```\nC COMPILER                              *style-compiler* *ANSI-C* *C89* *C99*\n \nサポートされている最小の C コンパイラのバージョンは C89 (ANSI C とも呼ばれてい\nる) である。C99 のような後継の標準規格はあまり普及していない、もしくは少なくと\nも 100% サポートされているわけではない。したがって C99 のいくつかの機能だけを\n使用し、その他の使用は (少なくとも現時点では) 禁止する。\n \n現存するパッチに対してマージの問題を引き起こすため、C99の機能を使う変更を至る\n所に入れてはいけない。新しくコードを書く場合、もしくは既存のコードを書き直す場\n合に限り使用してもよい。\n \nコメント  \n \n慣習的に Vim では /* コメント */ を使用する。特にファイルと関数のヘッダに関し\nてはこれを維持するつもりである。新しいコードもしくは変更される行については、\n// コメント を使用してもよい。特にコードの後ろに続くコメントなど:\n        int some_var;  // single line comment useful here\n \n列挙型 (Enums)  \n \n列挙型の末尾の要素にコンマ (trailing comma) が付いていてもよい。C89 では認めら\nれていなかった。\n \n型 (Types)  \n \n\"long long\" は使用してもよく、64 bit を想定している。printf では %lld を使用す\nること。同じように \"long long unsigned\" では %llu を使用する。\n \n使用してはいけないもの  \n \nこれらの C99 の機能は、コンパイラのサポートが不十分なため使用してはいけない。\n- ステートメントの後の宣言 (MSVC 2012 はこれをサポートしていない)。すべての宣\n  言はブロックの先頭になければならない。\n- 可変長配列 (C11 でもこれはオプショナルな機能である)。\n- _Bool 型と _Complex 型。\n- \"inline\" (ほとんど必要ない、コンパイラに最適化させよう。)\n- フレキシブル配列メンバ: HP-UX C コンパイラはサポートしていない。(John\n  Marriott)\n```","ts":"1570003295.130000","bot_id":"B894RTUCU","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"f4b93661-c845-4321-898d-43e9534b2d3d","type":"message","user":"UAZ33BKV2","text":"```\nサポートされている最小の C コンパイラのバージョンは C89 (ANSI C とも呼ばれてい\nる) である。C99 のような後継の標準規格はあまり普及していない、もしくは少なくと\nも 100% サポートされているわけではない。\n```\nもうそろそろC99が基本でいいかなと思うけど、サポートする環境の状況が不明確なので確定できなさそう","ts":"1570003353.130800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03378a01-31f3-46f5-b9cc-1475bc264fad","type":"message","user":"U6XP9LZ6V","text":"いまだに公式のCIで使ってるVCが2010で、それが、ブロックの途中での変数宣言が使えないんですよね。今のところBramは2008辺りを最低バージョンと考えてる模様。","ts":"1570005770.136100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"77f3b33d-ebad-4228-9f09-bba6dd8c39fe","type":"message","user":"U6XP9LZ6V","text":"最低バージョンを2013まで上げればC99の機能がかなり使えるようになるけど。","ts":"1570005878.138000","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4ef90d5e-1677-4adb-a5c3-f7921174188d","type":"message","user":"U03C6TEAZ","text":"ブロック中変数が使えないおかげで変数未初期化の警告も１個あった気がする。","ts":"1570007371.138600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0c3bc4c7-b5e9-4608-9872-332ce223e7cf","type":"message","user":"U7D5LRRQD","text":"<https://github.com/vim/vim/pull/4634>\n多分全部、言われたこと直しました！！！ :muscle:","ts":"1570015781.139100","attachments":[{"fallback":"GitHub: Support 'template string' ('string interpolation') by aiya000 · Pull Request #4634 · vim/vim","id":1,"title":"Support 'template string' ('string interpolation') by aiya000 · Pull Request #4634 · vim/vim","title_link":"https://github.com/vim/vim/pull/4634","text":"This motivation is here =&gt; #4491 :) This is a version that omitted the &amp;#39;_&amp;#39; support. (Please see #4491 (comment)) Please take this patch if you agree to this :+1: Or let&amp;#39;s discuss again ...","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/pull/4634","original_url":"https://github.com/vim/vim/pull/4634"}],"team":"T03C4RC8V","reactions":[{"name":"sasu","count":1,"users":["U0M7GCBPD"]},{"name":"confetti_ball","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a5aa9810-c0bb-41b6-ba47-f6bdcd37995b","type":"message","user":"U7D5LRRQD","text":"脳の筋肉がCに適応してきた！！！","ts":"1570015807.139500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"28dc786b-2f42-44d6-846e-b757ab613e04","type":"message","user":"U03C6TEAZ","text":"だいぶコード短くなったw","ts":"1570016074.140000","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U7D5LRRQD"]},{"name":"blob_dance","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1d9aa8e6-afd0-44d3-bece-621b7d92a082","type":"message","user":"U7D5LRRQD","text":"前のアルゴリズムはほんとダメで、Bramが指摘してくれてよかったです……","ts":"1570016463.141300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2a790b8-ec3b-4466-b01e-ca2bb2ad0f67","type":"message","user":"U7D5LRRQD","text":"一応報告？確認？なのですが、 `vim_realloc()` の注意書きに\n```c\n// Note: a NULL argument for vim_realloc() is not portable, don't use it.\n```\nというのがあって、しかしながら下記のように、NULLな `ga.ga_data` を `vim_realloc()` するようなコードがeval.cとかとかに偏在している気がします……？\n```c\ngarray_T\tga;\nga_init2(&amp;ga, 1, 80);\nga_append(&amp;ga, foo);  // or ga_concat()?\n```\n\n動いてるし、いいのかな……？","ts":"1569999267.119300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
