[{"client_msg_id":"3507c2d6-3569-4745-b314-3d9ee3e44529","type":"message","user":"U7986PPFH","text":"<https://github.com/vim/vim/compare/master...ichizok:feature/get_job_cwd>\nこれです","ts":"1564820276.385500","thread_ts":"1564793573.371900","attachments":[{"fallback":"GitHub: vim/vim","id":1,"title":"vim/vim","title_link":"https://github.com/vim/vim/compare/master...ichizok:feature/get_job_cwd","text":"The official Vim repository. Contribute to vim/vim development by creating an account on GitHub.","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/bfaba/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/compare/master...ichizok:feature/get_job_cwd","original_url":"https://github.com/vim/vim/compare/master...ichizok:feature/get_job_cwd"}],"parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","reactions":[{"name":"raised_hands","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"edf35a40-80e3-4372-aca1-dae2e4f6d377","type":"message","user":"UDDCM376D","text":"Vimのセッションってターミナルを復元はするけど、ターミナルのいるパスまでは復元してくれないのか…\nターミナルを復元対象にするなら、現在いるパスも復元できるようにしたほうがよさそうだけど、需要あるかな。。？\n\nちなみに自分は需要あります","ts":"1564773602.326100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5794ea59-e2a7-4d8c-85b8-7ae666c7e324","type":"message","user":"U9S4G0LJW","text":"便利そう","ts":"1564773661.326700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"890a5c3d-cc5c-4ec5-a2de-ff6e53025d2f","type":"message","user":"UDDCM376D","text":"そしたらtmuxからほぼ乗り換えれる","ts":"1564773759.327200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9e27b9cb-28e7-41bf-8f8d-2d8a1a69af5a","type":"message","user":"UDDCM376D","text":"セッションファイルの中身を見てみたら、 `lcd` のあとに `terminal` があるから、カレントディレクトリで開くっぽいけど、開かない\n\n```\nlcd ~/dev/go/src/github.com/skanehira/docker.vim\nwincmd w\nargglobal\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","ts":"1564773833.328700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"93bc1891-ae4f-49bc-8d93-23bbb43d9628","type":"message","user":"UDDCM376D","text":"ん？\nターミナルがセッションに保存されないケースがあるな","ts":"1564773969.329300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5604187c-4346-44eb-ba45-9cd6ed5acd00","type":"message","user":"UDDCM376D","text":"あ、うそ","ts":"1564774019.329500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d2621462-7476-4fa5-aa9f-c230c7d543ed","type":"message","user":"UDDCM376D","text":"寝ぼけてた。。。t","ts":"1564774193.329900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6e270cb0-4b50-4575-8294-732e47356a16","type":"message","user":"UDDCM376D","text":"ターミナルの現在いるパスを取得する方法あるかな","ts":"1564775212.330300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7c1c47d4-939e-431e-ac0a-817eea10ac9d","type":"message","user":"UDDCM376D","text":"Vimってlibtermを使っているんでしたっけ？","ts":"1564775681.331100","edited":{"user":"UDDCM376D","ts":"1564775684.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6e3597e3-6ca5-4061-91b9-edb7b4a3ccd8","type":"message","user":"U0M7GCBPD","text":"libterm をリポジトリに取り込んで libterm 自体の修正もしてるはずですね (なので変更する場合は vim のリポジトリ内のやつを変更する必要がある)","ts":"1564788166.333300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a9d27a8c-567b-4e95-b5c4-6fb869d48311","type":"message","user":"U0M7GCBPD","text":"とはいえ普通に libterm 関係ない話に見える","ts":"1564788194.334200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1690f901-4b28-4074-83e7-34eab37b1aba","type":"message","user":"U0M7GCBPD","text":"ゴリラさんが言ってるように lcd してればそこでシェル開くはず","ts":"1564788254.335400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aa87bc5e-4e36-4a95-936e-8f3d3178a6e1","type":"message","user":"U0M7GCBPD","text":"と思ったらそれは解決してたっぽいな…","ts":"1564788265.335800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a79e4691-7a84-4e95-b6d1-683d60e9adad","type":"message","user":"U0M7GCBPD","text":":terminal で走らせてるシェルのカレントディレクトリを知りたいって話ですかね？","ts":"1564788324.336800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1bfd0b94-11dc-4781-8603-e9d155ec70c4","type":"message","user":"U0M7GCBPD","text":"そうだとしたらカレントディレクトリは bash が持ってる情報なので libterm は関係ないです","ts":"1564788365.337700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1b21c5a6-4cc1-4dfb-9cc3-e7f87c187b7e","type":"message","user":"U03C4RC8X","text":"(tyruさんがvimconf発表提出するまでの期限あと2日か・・・どきどき)","ts":"1564788393.338200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a56e1b9e-e8e2-457c-84c0-92e5982b7fc5","type":"message","user":"U0M7GCBPD","text":"ノー :no_good:","ts":"1564788421.338500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f419131e-5019-43de-968f-6313bb2e0396","type":"message","user":"U0M7GCBPD","text":"しません :innocent:","ts":"1564788449.338800","team":"T03C4RC8V","reactions":[{"name":"interrobang","count":1,"users":["U03C4RC8X"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a638e101-69c5-42a9-8a62-0f1d1c46b771","type":"message","user":"U03C4RC8X","text":"168 名前：名無しさん＠４周年[] 投稿日：2019-08-03 10:43 ID:X7vkUwRR\nいよいよ明日がVimConf CFP締め切りですよ！\n\nむっちゃドキドキしてきた…。\n\nVim使いの皆さん、今日くらいはVim活は休んで明日に備えますよね？","ts":"1564788534.340100","team":"T03C4RC8V","reactions":[{"name":"goodpoem","count":1,"users":["U0M7GCBPD"]},{"name":"gativim","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"215b8b5a-6ffa-4290-94e2-24acfa6cf5ed","type":"message","user":"U0M7GCBPD","text":"寝ようと思ってたけどゴリラさんが言った bash で cd すると vim の cwd も変わるやつ作ってみよう","ts":"1564788855.341100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2c0e937f-6230-44a3-aba2-4ee328c201c7","type":"message","user":"U03C6TEAZ","text":"ちなみに libvterm すね","ts":"1564791071.341900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2fb4038b-05bf-496b-a5a9-e9b389f90545","type":"message","user":"UDDCM376D","text":"一応セッションのファイルを貼っておきます\nterminalを復元する時、なぜかウィンドウを分割してenewしてからterminal実行しているのが原因みたいです\n\n分割したウィンドウのディレクトリが$HOMEになっているので、結果ディレクトリが復元されない。\nterminalを復元する前に、もともとterminalがいたパスをlcdするコマンドがあると一番望ましいかなと。\n\nそうなるとVim本体でセッション情報を出力する時にターミナルのパス情報をlibtermから取れれば、それを書き出せばやりたいことを実現できるのでは？と考えた次第です","ts":"1564791087.342000","files":[{"id":"FM12REY3X","created":1564791087,"timestamp":1564791087,"name":"vim","title":"vim","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"UDDCM376D","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":1633,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FM12REY3X/vim","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FM12REY3X/download/vim","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/UDDCM376D/FM12REY3X/vim","permalink_public":"https://slack-files.com/T03C4RC8V-FM12REY3X-f90ca70973","edit_link":"https://vim-jp.slack.com/files/UDDCM376D/FM12REY3X/vim/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"136383a4-06e6-4b04-a824-339d0e36a8db","type":"message","user":"UDDCM376D","text":"なんか綴違うなと思ったら `libvterm` だった\nありがとございます","ts":"1564791107.342900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"76d255f4-867c-46e1-bcf9-f411bd73a142","type":"message","user":"U03C6TEAZ","text":"terminal のカレントディレクトリ取るのは ichizok さんがパッチ作ってたけどマージされたんだっけ。","ts":"1564791166.344400","edited":{"user":"U03C6TEAZ","ts":"1564796811.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"55ffee28-e8b7-4185-8562-66d39715d4c6","type":"message","user":"UDDCM376D","text":"なんと","ts":"1564791183.344700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6d6cf474-a1c3-4f7a-a613-9ac2d5e31359","type":"message","user":"U0M7GCBPD","text":"便利そう","ts":"1564791235.345000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ee1212d1-6100-4844-965c-d2b032d21d57","type":"message","user":"U0M7GCBPD","text":"いっそ任意の pid の cwd 取る関数追加してほしさがある (多分↑ができるならできるはず？)","ts":"1564791275.345700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9592e8a3-29dc-470b-ba8f-510bf16ab2b2","type":"message","user":"U0M7GCBPD","text":"`term_getpid()` みたいなのないのか","ts":"1564791307.346000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6181086c-fda0-42df-b8b2-152f746d104e","type":"message","user":"U0M7GCBPD","text":"<@UDDCM376D> シェルで `cd` したら vim も :cd するやつできました <https://github.com/tyru/sync-term-cwd.vim>","ts":"1564791344.346800","attachments":[{"fallback":"GitHub: tyru/sync-term-cwd.vim","id":1,"title":"tyru/sync-term-cwd.vim","title_link":"https://github.com/tyru/sync-term-cwd.vim","text":"Sync your shell's working directory to Vim's working directory - tyru/sync-term-cwd.vim","thumb_url":"https://avatars2.githubusercontent.com/u/48169?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/bfaba/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/tyru/sync-term-cwd.vim","original_url":"https://github.com/tyru/sync-term-cwd.vim"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bf01dcc4-c20b-43b2-a6cb-d798dac54a3c","type":"message","user":"U0M7GCBPD","text":".bashrc で `source (repo)/macros/synctermcwd.sh` すれば動くはずです","ts":"1564791388.347500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"65cb4338-9958-4638-8fea-10f3a365fe31","type":"message","user":"UDDCM376D","text":"おお","ts":"1564791413.348100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e1d13d2b-010d-4165-8ad7-b0017cbde49c","type":"message","user":"U0M7GCBPD","text":"変数で任意の `:cd` コマンドを指定できるので、カレントタブページのウィンドウのみ `:lcd` するとかできます &gt;`let g:synctermcwd_cd_command = 'windo lcd'`","ts":"1564791449.348600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4ad3d7b8-7916-4e3e-99f1-8e545bba4d70","type":"message","user":"U0M7GCBPD","text":"ここ <#C83UXKU86|dev> だった","ts":"1564791465.348800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5ba609e6-47c4-448f-88b0-d4950e610d0d","type":"message","user":"UDDCM376D","text":"どういう仕組なんですかか？","ts":"1564791480.349100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0354a18d-9569-475b-b00d-c45cc3568c5a","type":"message","user":"U0M7GCBPD","text":"bash 側も vim script も10行以内なんでめちゃくちゃシンプルです","ts":"1564791509.349700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c759741-17f4-4b16-81ec-7a0bc4dd582e","type":"message","user":"U0M7GCBPD","text":"macros/synctermcwd.sh\n```\ncd() {\n  builtin cd \"$@\" || return $?\n  if [ \"$VIM_TERMINAL\" ]; then\n    printf '\\e]51;[\"call\",\"Tapi_SyncTermCwd\",\"%s\"]\\x07' \"$PWD\"\n  fi\n}\n```\nplugin/synctermcwd.vim\n```\nfunction! Tapi_SyncTermCwd(_, cwd) abort\n  let cd = get(g:, 'synctermcwd_cd_command', 'cd')\n  execute cd a:cwd\nendfunction\n```","ts":"1564791552.350400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03a21864-9390-41d0-8768-22cd7c53fdc9","type":"message","user":"U0M7GCBPD","text":"これだけ","ts":"1564791557.350600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c43741a8-255c-457c-9b48-cdadc3d9c4f1","type":"message","user":"UDDCM376D","text":"`\\e]51;[\"call\",\"Tapi_SyncTermCwd\",\"%s\"]\\x07' \"$PWD\"` これがなんなのか全然わからないですｗ","ts":"1564791591.351300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"15dfcd5c-5186-4651-9308-f323cca78b08","type":"message","user":"U0M7GCBPD","text":"terminal-api を使って $PWD を vim に教えてるだけです","ts":"1564791591.351400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e6be0d4c-cd0d-4627-8f2c-cdfa75ff0dc7","type":"message","user":"UDDCM376D","text":"`terminal-api` なる存在があったのを思い出した","ts":"1564791610.352000","team":"T03C4RC8V","reactions":[{"name":"benri","count":1,"users":["U0M7GCBPD"]},{"name":"+1","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fdf0101e-48a4-448b-9229-2334b557b81a","type":"message","user":"UDDCM376D","text":"まったくわからないので、とりあえずヘルプ読みます","ts":"1564791681.352500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7116875e-b49c-4d24-91b2-bc97e6f89b00","type":"message","user":"UDDCM376D","text":"```\n本体は常にリストになっており、終わりを見つけやすいです: ]&lt;07&gt;\n&lt;Esc&gt;]51;msg&lt;07&gt; シーケンスは \"Emacs shell\" のためにxtermによって予約されてい\nます。私たちがここでやっていることに似ています。\n```\nなるほど、このエスケープシーケンで囲うのか","ts":"1564791807.353100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9ca2970e-ef81-4268-bd98-a1ccf93407db","type":"message","user":"UDDCM376D","text":"あれ","ts":"1564791979.353500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a8cd45b-9a9e-4462-8865-5b27d502809a","type":"message","user":"UDDCM376D","text":"もともとやりたいことは\nセッション保存する時、ターミナルのパスも保存して復元したい\nですが、terminal-apiを使えば実現可能…？","ts":"1564792033.354600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21b027a9-1668-4473-94df-37f3fec9caf5","type":"message","user":"U0M7GCBPD","text":"あれ、それって解決したんじゃなかったでしたっけ？","ts":"1564792174.355200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"34816ef6-f49d-494d-8015-d4c35f801edf","type":"message","user":"U0M7GCBPD","text":"<https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700>","ts":"1564792229.355500","attachments":[{"fallback":"[August 2nd, 2019 12:23 PM] sho19921005: セッションファイルの中身を見てみたら、 `lcd` のあとに `terminal` があるから、カレントディレクトリで開くっぽいけど、開かない\n\n```\nlcd ~/dev/go/src/github.com/skanehira/docker.vim\nwincmd w\nargglobal\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","id":1,"author_id":"UDDCM376D","author_name":"ゴリラ","author_subname":"ゴリラ","author_link":"https://vim-jp.slack.com/team/UDDCM376D","author_icon":"https://avatars.slack-edge.com/2019-06-23/667212021009_557c3073c5b377011dbb_48.png","text":"セッションファイルの中身を見てみたら、 `lcd` のあとに `terminal` があるから、カレントディレクトリで開くっぽいけど、開かない\n\n```\nlcd ~/dev/go/src/github.com/skanehira/docker.vim\nwincmd w\nargglobal\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #dev","ts":1564773833.328700,"from_url":"https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700","original_url":"https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ffb555b7-2841-4f76-84a6-fca6727d95d7","type":"message","user":"UDDCM376D","text":"いえ","ts":"1564792230.355700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"81f10baf-3270-456d-9b19-e7927b24a0ff","type":"message","user":"UDDCM376D","text":"解決していないですｗ","ts":"1564792245.356000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"650c06cb-4e94-44cc-b801-4ee9ae0830e3","type":"message","user":"UDDCM376D","text":"解決するにはターミナルのパスをセッションに出力するしか無いかなと","ts":"1564792293.357100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1f4bd185-835f-47d8-82c4-2159d4aee1f9","type":"message","user":"U0M7GCBPD","text":"terminal-api でもできますけど、 `sessionoptions` で curdir あればいけるかと思ってた","ts":"1564792309.357200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51d8ccd9-d123-4f31-a40b-2c6fc1b65ac8","type":"message","user":"U0M7GCBPD","text":"bash 起動時に↑みたいな感じで `$PWD` を渡せばいけると思いますよ","ts":"1564792351.357800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ef5a2ddb-bbac-4adc-b639-0e3ce3a62af9","type":"message","user":"U0M7GCBPD","text":".bashrc にこれがあればいけそう\n```\n  if [ \"$VIM_TERMINAL\" ]; then\n    printf '\\e]51;[\"call\",\"Tapi_SyncTermCwd\",\"%s\"]\\x07' \"$PWD\"\n  fi\n```","ts":"1564792402.358600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f09de99b-be31-43e6-a279-b505343465e4","type":"message","user":"UDDCM376D","text":"あ、 `$PWD` ではなく、セッション保存時のパスを復元したいんです","ts":"1564792403.358700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fafc0aa7-82c3-4956-95bd-761399c8c97a","type":"message","user":"U0M7GCBPD","text":"あ、そうでした (寝ぼけてた)","ts":"1564792432.359600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8e6ccbe2-2034-45c5-b5a9-b3e1b80edf79","type":"message","user":"UDDCM376D","text":"今、tmuxの代わりにVimだけでなんとかならないかなって試しています","ts":"1564792442.359800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bab2c741-d799-41a5-b2f1-0162bddda5f2","type":"message","user":"UDDCM376D","text":"セッションでターミナルのパスさえ復元できれば最低限代替できそうかなって感じです","ts":"1564792464.360300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c66c7f7c-eb05-4746-9241-8f022d2e2304","type":"message","user":"UDDCM376D","text":"なので、Vim本体をいじるしかないかなと\n↓の感じにすればパスを復元できるはず\n```\nlcd {terminal-path}\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","ts":"1564792541.361500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aac1a53b-8239-4799-9411-7f7fc8bf7380","type":"message","user":"U0M7GCBPD","text":"もしセッションファイルが置いてあるディレクトリに cd するんなら `set sessionoptions+=sesdir` でいけそうですが、そうではない？","ts":"1564792575.362100","edited":{"user":"U0M7GCBPD","ts":"1564792586.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"549656e8-2eaf-4c60-a603-741139e5f524","type":"message","user":"UDDCM376D","text":"はい\n単純にセッションを保存するときのターミナルパスを復元したいです","ts":"1564792670.363200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd73953a-60ff-494f-ad1d-c2d1cc2529de","type":"message","user":"UDDCM376D","text":"シンプルにいえばｗ","ts":"1564792676.363300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c3f8c7f-bfa0-4e1a-828f-bcdded4f6c4e","type":"message","user":"UDDCM376D","text":"セッションを保存\nVimを閉じる\n`Vim -S session` で元通り","ts":"1564792703.364100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ddb6b733-17cf-4f87-ba90-5a36a799898b","type":"message","user":"UDDCM376D","text":"ってのをやりたいです","ts":"1564792715.364600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b8b0aac5-1bce-47ea-ab7c-add5c189cd33","type":"message","user":"U0M7GCBPD","text":"なるほど\nVim 本体を直す場合なら `wincmd w` があるのが原因そうなので、 `wincmd w` を `terminal ...` の後に持ってくるとかで直りそうです","ts":"1564792795.365800","thread_ts":"1564792795.365800","reply_count":1,"replies":[{"user":"U0M7GCBPD","ts":"1564792835.365900"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a4416c3b-a69d-4343-97ac-f133151349cc","type":"message","user":"U0M7GCBPD","text":"<https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700>","ts":"1564792835.365900","thread_ts":"1564792795.365800","attachments":[{"fallback":"[August 2nd, 2019 12:23 PM] sho19921005: セッションファイルの中身を見てみたら、 `lcd` のあとに `terminal` があるから、カレントディレクトリで開くっぽいけど、開かない\n\n```\nlcd ~/dev/go/src/github.com/skanehira/docker.vim\nwincmd w\nargglobal\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","id":1,"author_id":"UDDCM376D","author_name":"ゴリラ","author_subname":"ゴリラ","author_link":"https://vim-jp.slack.com/team/UDDCM376D","author_icon":"https://avatars.slack-edge.com/2019-06-23/667212021009_557c3073c5b377011dbb_48.png","text":"セッションファイルの中身を見てみたら、 `lcd` のあとに `terminal` があるから、カレントディレクトリで開くっぽいけど、開かない\n\n```\nlcd ~/dev/go/src/github.com/skanehira/docker.vim\nwincmd w\nargglobal\nterminal ++curwin ++cols=238 ++rows=20 /bin/bash\n```","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #dev","ts":1564773833.328700,"from_url":"https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700","original_url":"https://vim-jp.slack.com/archives/C83UXKU86/p1564773833328700"}],"parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a1dc1d72-0f60-45af-a0c9-7d053dacfdde","type":"message","user":"UDDCM376D","text":"`wincmd w` を後に持ってくるだけではだめと思います\n直前 `lcd` した場所で復元はしますが、ターミナルのパスとは限らないので…","ts":"1564793185.367500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"11629a29-a7e1-4057-bae8-937f0aa4c936","type":"message","user":"U0M7GCBPD","text":"なるほど &gt;直前 `lcd` した場所","ts":"1564793279.368300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b06023a5-ecfb-460c-b83d-1c0360dafb44","type":"message","user":"UDDCM376D","text":"ここでセッション書き出していますね\n```\n    int\nterm_write_session(FILE *fd, win_T *wp)\n{\n    term_T *term = wp-&gt;w_buffer-&gt;b_term;\n\n    /* Create the terminal and run the command.  This is not without\n     * risk, but let's assume the user only creates a session when this\n     * will be OK. */\n    if (fprintf(fd, \"terminal ++curwin ++cols=%d ++rows=%d \",\n\t\tterm-&gt;tl_cols, term-&gt;tl_rows) &lt; 0)\n\treturn FAIL;\n#ifdef MSWIN\n    if (fprintf(fd, \"++type=%s \", term-&gt;tl_job-&gt;jv_tty_type) &lt; 0)\n\treturn FAIL;\n#endif\n    if (term-&gt;tl_command != NULL &amp;&amp; fputs((char *)term-&gt;tl_command, fd) &lt; 0)\n\treturn FAIL;\n\n    return put_eol(fd);\n}\n```","ts":"1564793287.368500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ba8b3bc0-5fab-4102-ad7a-5b446e464fbb","type":"message","user":"UDDCM376D","text":"`term_T` にパス情報とかは流石に入っていないよね…","ts":"1564793318.369300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"41e1a4fe-962b-4c1d-98ed-604a24e77961","type":"message","user":"UDDCM376D","text":"clangのLSPがまともに動かなくてstructを探すの苦労する。。。","ts":"1564793343.370000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7f1063d9-ddbf-4071-8071-d83f3f965fe6","type":"message","user":"U0M7GCBPD","text":"ichizok さんのカレントディレクトリのパッチではどうやってるんだろ (というかパッチ見つけられてないので知ってたら誰か URL 教えてほしい…)\nLinux は `/proc/{pid}/cwd` とかで取れるけど","ts":"1564793573.371900","thread_ts":"1564793573.371900","reply_count":2,"replies":[{"user":"U7986PPFH","ts":"1564820276.385500"},{"user":"U0M7GCBPD","ts":"1564851439.385800"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a875b0da-483b-45ae-936a-55477b08faa2","type":"message","user":"UDDCM376D","text":"同じくパッチをURLを知りたい。。。","ts":"1564793594.372300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9cd81b1a-a7bc-420e-99d1-7bc810bc632c","type":"message","user":"U0M7GCBPD","text":"ちなみに自分はセッションまともに使ったことないので中身よくわからんです…","ts":"1564793611.372600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c0e061fc-0e3c-4809-9f98-222c5cf42b34","type":"message","user":"UDDCM376D","text":"セッションは、Vim scriptの塊なだけです","ts":"1564793634.373100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f1724337-754c-488c-9023-4f13f3a8c723","type":"message","user":"UDDCM376D","text":"なので `:so session` で復元できたりします","ts":"1564793657.373700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bc867e2c-730b-44bf-b579-5183848ea02c","type":"message","user":"UDDCM376D","text":"`terminal.c` にパスをごにょごにょする処理がないっぽい","ts":"1564793756.374100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"USLACKBOT","text":"Reminder: <https://github.com/vim-jp/vital.vim/settings/hooks> から <http://drone.io|drone.io> のやつ消す","ts":"1564794009.374200","bot_id":"B01","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"bd255c20-fddd-4bfa-985a-b862b4261bb9","type":"message","user":"UDDCM376D","text":"`term_setrestore({buf}, {command})` で復元できそう","ts":"1564795034.374500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9d4b8eb7-4466-47f6-9472-e426c657f8c3","type":"message","user":"U03C71D7H","text":"ターミナル内で何かプログラムが動いていた場合はどうなるんだろう","ts":"1564795162.374900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cd8abac0-ae16-44b2-b5a4-699f07afa202","type":"message","user":"UDDCM376D","text":"それはどうしようもないですねｗ","ts":"1564795410.375100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"41097ddb-b995-4280-8ed7-375e5ec7b145","type":"message","user":"UDDCM376D","text":"止めるしか無い","ts":"1564795425.375400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"ULPLDSYV8","text":"<@ULPLDSYV8> has joined the channel","ts":"1564795671.375600","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"33d1fc63-f40c-4575-99b1-c2aefd19462c","type":"message","user":"UDDCM376D","text":"とりあえず `term_setrestore({buf}, {command})` で復元はできました","ts":"1564798363.379800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5fda2f71-d079-490c-a665-a1511ab8a5a5","type":"message","user":"UG6DF6W87","text":"Vim の tmux 化(session 機能部分)、clientserver 機能のラッパーとして作ることを考えはじめました","ts":"1564798537.382100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f1e6553f-a143-4b52-8015-9e4e3ef439ba","type":"message","user":"UDDCM376D","text":"あー","ts":"1564798610.382300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b66ce247-6448-410a-8377-a85d2a06d3ee","type":"message","user":"UDDCM376D","text":"それなら行けそう","ts":"1564798614.382500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f392d15b-d6e3-4622-b51c-679fbf3794d0","type":"message","user":"UDDCM376D","text":"あー","ts":"1564798628.382700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"698bd471-8af6-4c99-95a0-9530c2576e66","type":"message","user":"UDDCM376D","text":"良いこと思いついた","ts":"1564798636.383000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"06ed1668-266b-435e-b6ce-2b9abb383239","type":"message","user":"UDDCM376D","text":"流石にjob実行の状態を戻すのは無理だけど、サーバーを建てるのは良さそう","ts":"1564798658.383500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b949abcf-fcd2-4ff3-8356-bd584c3afe7f","type":"message","user":"UDDCM376D","text":"よし、最低限実現したいことはできた","ts":"1564798763.384000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3D3CE89C-80D8-44D0-BA13-16FCE45F4A79","type":"message","user":"UBDMG6N2J","text":"vim の tmux 化きになる。","ts":"1564806252.384900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f5f24740-446b-4213-856f-86cb8fa72dae","type":"message","user":"UDDCM376D","text":"<https://vim-jp.slack.com/archives/C03C4RC9F/p1564807467262400>","ts":"1564807517.385100","attachments":[{"fallback":"[August 2nd, 2019 9:44 PM] sho19921005: キーバインドちょっと慣れないけど、慣れたら普通に結構行けそう","id":1,"author_id":"UDDCM376D","author_name":"ゴリラ","author_subname":"ゴリラ","author_link":"https://vim-jp.slack.com/team/UDDCM376D","author_icon":"https://avatars.slack-edge.com/2019-06-23/667212021009_557c3073c5b377011dbb_48.png","text":"キーバインドちょっと慣れないけど、慣れたら普通に結構行けそう","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #random","ts":1564807467.262400,"from_url":"https://vim-jp.slack.com/archives/C03C4RC9F/p1564807467262400","original_url":"https://vim-jp.slack.com/archives/C03C4RC9F/p1564807467262400"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
