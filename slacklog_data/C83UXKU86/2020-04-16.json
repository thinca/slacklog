[{"client_msg_id":"6b9eb202-b7c6-44e4-9a1d-690652c243d8","type":"message","user":"U7H4TJEG0","text":"doautoallの中でwinnr(‘$’)がおかしな値を返す気がする","ts":"1587030327.132700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1evr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"747515b1-a700-470f-90ae-10e7dab4bc9f","type":"message","user":"U7H4TJEG0","text":"```:tabnew\n:au WinEnter * echom winnr('$')\n:doautoall WinEnter```\nこれが 2 1 になる…","ts":"1587030412.133400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TzdTN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c1a5c9f8-0986-4658-8345-af5cb42331fc","type":"message","user":"U7H4TJEG0","text":"別のタブだと常に2になるのか","ts":"1587030514.133800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eWpBj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e7a74f32-19ad-4f86-bb3c-45e4fa96a376","type":"message","user":"U7H4TJEG0","text":"いや、 今のタブの winnr(‘$’) + 1 になってるのかな","ts":"1587030558.134100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pp5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"04741248-31d0-475f-b2a3-710c47687147","type":"message","user":"UAZ33BKV2","text":"たしかにそんな感じになりますね\n:help winnr","ts":"1587030609.134500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Kql4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"019f6698-124d-48d6-93ad-dba55f07a640","type":"message","user":"UAZ33BKV2","text":":help winnr","ts":"1587030616.134700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=+B8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UPZHKAM7W","text":"```\n                                                        *winnr()*\nwinnr([{arg}])  結果は現在のウィンドウを示す数値。最上位のウィンドウは1であ\n                る。ポップアップウィンドウは0を返す。\n \n                省略可能な引数{arg}は以下の値をサポートする:\n                        $       最後のウィンドウの番号(ウィンドウ数)\n                        #       最後にアクセスしたウィンドウの番号(|CTRL-W_p|\n                                の行き先)。前のウィンドウがないか、別のタブペー\n                                ジにある場合は、0が返される。\n                        {N}j    現在のウィンドウの下N番目のウィンドウの番号\n                                (|CTRL-W_j| の行き先)。\n                        {N}k    現在のウィンドウの上N番目のウィンドウの番号\n                                (|CTRL-W_k| の行き先)。\n                        {N}h    現在のウィンドウの左N番目のウィンドウの番号\n                                (|CTRL-W_h| の行き先)。\n                        {N}l    現在のウィンドウの右N番目のウィンドウの番号\n                                (|CTRL-W_l| の行き先)。\n                この番号は|CTRL-W_w|と \":wincmd w\" で使える。|:wincmd|\n                |tabpagewinnr()|と|win_getid()|も参照。\n                例:  \n                        let window_count = winnr('$')\n                        let prev_window = winnr('#')\n                        let wnum = winnr('3k')\n \n                |method| としても使用できる:  \n                        GetWinval()-&gt;winnr()\n```","ts":"1587030617.134800","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"22547447-4851-4fdd-8a40-73ba80499224","type":"message","user":"UAZ33BKV2","text":"``` $       最後のウィンドウの番号(ウィンドウ数)```\nだからそうなるような...?","ts":"1587030636.135100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HdK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c044f4e1-ba3c-490e-aa14-6ff7130c7455","type":"message","user":"U7H4TJEG0","text":"わからない…","ts":"1587030688.135300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YXoc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"94F3900C-9351-43BC-8812-87C5D78CE23F","type":"message","user":"UBQ2H65JQ","text":"私もわからない… WinEnterイベントに登録したコマンドがほかにあるとか","ts":"1587030741.136400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VLh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"72084a7b-3b25-46f8-ac09-23dd58b76763","type":"message","user":"U7H4TJEG0","text":"aucmd_prepbufあたり読んだらだいたい分かった","ts":"1587034275.136700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"x=tw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c3030bc5-51a3-4fe0-ba45-05ba2c8d71f9","type":"message","user":"U03C6TEAZ","text":"あれ、なんか変なんでしたっけ？","ts":"1587038588.138000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Vn7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"edd86550-6f9f-4481-92dd-cd6e299dcc91","type":"message","user":"U03C6TEAZ","text":"(期待値が分かってない)","ts":"1587038635.138800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"u1S"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68c433d5-8525-4006-ae9e-aa9559223bf8","type":"message","user":"U7H4TJEG0","text":"私も何を期待するかわからない…","ts":"1587039630.139100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pV+i"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1bdcf5fd-8a86-46e7-bb58-eaabf2d7cb78","type":"message","user":"U7H4TJEG0","text":"hidden windowかどうかを判定できれば嬉しい…","ts":"1587039663.139600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ttxN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03837af7-142c-4fd9-9eb4-df8fcbcc90c1","type":"message","user":"U03C6TEAZ","text":"a-, ようやく意味が分かった。","ts":"1587040218.140100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YI7D"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3bcea123-67e7-4de7-94f8-454e05f44e26","type":"message","user":"U03C6TEAZ","text":"タブ毎のウィンドウ数が出るべきって事ですね。","ts":"1587040314.140500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZgF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bbf3aa70-2883-4db5-8988-fe7dd9c37453","type":"message","user":"U03C6TEAZ","text":"だとすると doautoall WinEnter を実行してる時の curwin がおかしいはず。","ts":"1587040352.141400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Zs8ZX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1176f175-ab1d-4298-8f11-ba69f61be26f","type":"message","user":"U7H4TJEG0","text":"なんか最初はそう思ったんですが、doautoallの対象はバッファなのでそれも違うかなとか","ts":"1587040409.141700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pM9u"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d0bda8e5-ba68-4fd1-98df-dfdf3f8a9ef4","type":"message","user":"U03C6TEAZ","text":"なるほど。","ts":"1587040429.142000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bMW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e4da4f66-8ef0-48d3-8cc4-348dc74a4c9c","type":"message","user":"U03C6TEAZ","text":"doau はカレントバッファに適用か。","ts":"1587040545.143500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1aD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a826540c-674d-4fbb-a276-82a6120b7f6c","type":"message","user":"U03C6TEAZ","text":"とすると数字が2個でるのがおかしい？","ts":"1587040564.143900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EctRs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1a95be49-74b5-4f4f-bc53-aec799c2fd6e","type":"message","user":"U7H4TJEG0","text":"doautoallでイベントが発火されたときのabufが、アクティブなタブ内に表示されてるかが分かれば十分なんですが、これが意外と難しい","ts":"1587040962.146200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Id+y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1283a5f3-e024-43e1-80ff-832d0d4dc680","type":"message","user":"U03C6TEAZ","text":"あ、よく見てなかった。doautoall だった。","ts":"1587041235.147600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yVs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"64a80191-8ec6-4719-9700-b6ef98410319","type":"message","user":"U03C6TEAZ","text":"じゃぁ2つでるのは正しいか。","ts":"1587041261.147900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=jY9O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"19812a85-a2a5-420e-844c-a9cd69ddc46b","type":"message","user":"U7H4TJEG0","text":"はい、2つでるのは大丈夫です","ts":"1587041301.148200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vVrK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cc5768fb-c51f-473f-a43a-aa396764255a","type":"message","user":"U03C6TEAZ","text":"new してから↑の実行すると 2 2 1 か。","ts":"1587042285.149500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SiFYs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6406983d-c208-4e24-becd-fe8a1065b464","type":"message","user":"U7H4TJEG0","text":"(`au WinEnter * echom tabpagebuflist()` にすると挙動が分かりやすいです)","ts":"1587042370.149800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xt0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"04ac4ed7-4fff-4583-a41f-4fc3dcad1318","type":"message","user":"U03C6TEAZ","text":"なるほど。","ts":"1587042409.150100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/m="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"73004f18-b99f-4929-a8e0-446a9fb30363","type":"message","user":"U03C6TEAZ","text":"tabnew の時の挙動ぽい。","ts":"1587042426.150400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+CtJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7b8b70d3-2b83-4d42-9509-8de246f90a5b","type":"message","user":"U03C6TEAZ","text":"tabnew の時にバッファを作ってウィンドウ作ってそのウィンドウに当てはめてるのかなぁ。","ts":"1587042450.150900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tqU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5fe5bc14-e845-4e03-9783-d5c425786723","type":"message","user":"U03C6TEAZ","text":"splitwindow 使ってる。","ts":"1587042528.151200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zn+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f201ea8b-faa8-4af6-8692-2c471dba1436","type":"message","user":"U03C6TEAZ","text":"ex_splitview があやしそう。","ts":"1587042593.151400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lokt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e74c41aa-1147-4f61-aed1-201534a2804e","type":"message","user":"U03C71D7H","text":"ソースコードを見てないけど、実際の挙動をあれこれ試した感じだと、カレントタブページに表示されているバッファはそこを使う、そうでない場合は一時的に分割してそこにバッファを表示して実行、ということをしてそう","ts":"1587042709.151900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HwGP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68076f23-6456-4363-bc3d-e2dc5479898e","type":"message","user":"U7H4TJEG0","text":"そういう感じです","ts":"1587042822.152200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Wnt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"08d3eb86-3f71-4e68-b2a2-4b20a04cc59c","type":"message","user":"U03C6TEAZ","text":"あ、じゃあ。リストアが腐ってるか。","ts":"1587042886.152900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k07"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd9e6fcb-42c7-4df1-a1a1-666d6bf18d36","type":"message","user":"U7H4TJEG0","text":"実装が分かってたらバグとは言えないんですよね、わかりにくいだけで。ただし本当に今のタブに表示されいたかどうかが判定できなくなってる。","ts":"1587043124.153900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aJcL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"05c6cb20-417f-4ac8-b8d0-636d4177e9e0","type":"message","user":"U03C6TEAZ","text":"起動して `:tabnew` してそれぞれのタブで `echo tabpagebuflist()` したら `[1]` と `[2]` が出るので doautoall に副作用があるって感じになる。","ts":"1587043238.154900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6K4+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9c43b29-5bff-4c46-b037-d9d0bb169b74","type":"message","user":"U03C6TEAZ","text":"↑のを実行したあと元のタブに戻って ball したらバッファが出てくる。","ts":"1587043449.155300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JtCn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2d9b7c32-437f-4592-b4f4-ffd7c279e581","type":"message","user":"U03C6TEAZ","text":"簡単じゃないなー。","ts":"1587044105.155700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ymX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
