[{"client_msg_id":"fa3a984f-8d5a-4953-a458-2cb49b249a1d","type":"message","user":"U7JL1UKKL","text":"filetypeの検出は高速化が必要だよね","ts":"1603887114.014700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"O5nU"}]},{"client_msg_id":"fd83ca28-a5c4-41ed-9848-ce49094f9bb7","type":"message","user":"U03C71D7H","text":"あとは `setf` への対応は必要だな。単に辞書を2つに分けるのが手っ取り早いかな","ts":"1603887006.014200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KOW"}]},{"client_msg_id":"c95a8e33-1890-45d0-bb51-920d1e3a70bc","type":"message","user":"U03C71D7H","text":"それなら、もし仮にこの方式を導入するとしたらその際に全部書き換えちゃえば済みそうかなぁ","ts":"1603886878.013400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wthX"}]},{"client_msg_id":"a155dc17-fc11-4952-a57b-89fd704607bc","type":"message","user":"U6XP9LZ6V","text":"filetype.vim は完全に Bram の管理下と言っていいかな。パッチ番号振られることもあるし。","ts":"1603886850.013000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VyV"}]},{"client_msg_id":"af90c2da-5d15-45c9-9985-f4fb439dbaf6","type":"message","user":"U03C71D7H","text":"filetype.vim は大量の autocmd を登録しますからね。実装を知らないので本当かはわからないけど、これらの大半がただの辞書への代入に変わると速くならないだろうか","ts":"1603886828.012500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xVZ"}]},{"client_msg_id":"9f4881bc-683f-4feb-9077-f3e99c2b47c1","type":"message","user":"U03C71D7H","text":"と言うか filetype はそれぞれメンテナがいるはずなのだけど、filetype.vim がどうやって生成されているのかよく知らない","ts":"1603886753.011300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hhW"}]},{"client_msg_id":"c76206c0-2c68-450f-9012-dcba49fa6d82","type":"message","user":"U6XP9LZ6V","text":"filetype.vim のロード時間も意外と馬鹿にできかったような","ts":"1603886734.011000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3SY/U"}]},{"client_msg_id":"9445f9b9-4609-4446-bfa1-0e3e468e7dc6","type":"message","user":"U03C71D7H","text":"今妄想している案\n\n1. なんか適当な検出用の Dict を用意します: ex `g:ftdetect_exts`\n2. 拡張子だけで filetype が判断できるものは、 `ftdetect/*.vim` 内で、この辞書に登録をします\n\n```if exists('g:ftdetect_exts')\n  let g:ftdetect_exts['rb'] = 'ruby'\nelse\n  autocmd BufNewFile,BufReadPost *.rb setlocal filetype=ruby\nendif```\nもちろん旧来の方式と同居します。互換性大事。\n\n3. $VIMRUNTIME/filetype.vim の先頭で、開こうとしているファイルの拡張子から `g:ftdetect_exts` を引き、あれば filetype に設定する\n\n問題は既存の設定の移行をどうやるか","ts":"1603886705.010300","edited":{"user":"U03C71D7H","ts":"1603886988.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"c9E"}]},{"client_msg_id":"9f862800-9ac4-4c32-9862-822a4e416874","type":"message","user":"U9S4G0LJW","text":"evallessな環境は気にしなくてよさそう","ts":"1603886587.008600","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":1,"users":["U7HFY4HFY"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rMT4c"}]},{"client_msg_id":"1311554b-2ffd-44ea-8505-81bf0087265d","type":"message","user":"U03C71D7H","text":"ftdetect も全部 Vim script で、ものによっては式使ってる","ts":"1603886583.008400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TFpRO"}]},{"client_msg_id":"c071b35b-74d6-4d95-96bf-bd47fd19a857","type":"message","user":"U9S4G0LJW","text":"`N  *+eval*\t\t式評価 {訳注: Vim script} |eval.txt|`","ts":"1603886576.008100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6olEP"}]},{"client_msg_id":"2939d45d-1158-4530-b33c-1e81a6947474","type":"message","user":"U7HFY4HFY","text":"あー","ts":"1603886560.007700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2fZ1"}]},{"client_msg_id":"38f8f77d-0f46-4847-804c-51e870347c14","type":"message","user":"U9S4G0LJW","text":"`N  *+syntax*\t\t構文強調 |syntax|`","ts":"1603886556.007500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F=5p"}]},{"client_msg_id":"3d098c03-d8be-4bbc-afb9-80f3fbdd2503","type":"message","user":"U03C71D7H","text":"syntax/*.vim が Vim script だし…","ts":"1603886551.007400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7XQdz"}]},{"client_msg_id":"65c21e7b-fd94-4295-9a2a-a275e060ad95","type":"message","user":"U03C71D7H","text":"timy だとそもそも syntax 効かなくないですっけ? そんなことない?","ts":"1603886543.007000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vhu"}]},{"client_msg_id":"38c954ae-5a3b-4c1a-8509-fe41bd6214a8","type":"message","user":"U7HFY4HFY","text":"tinyでつかえます？","ts":"1603886502.006400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"n+vl"}]},{"client_msg_id":"c4fb70ef-a6c6-4e53-9da3-371a7973b3ef","type":"message","user":"U9S4G0LJW","text":":naruho:","ts":"1603886448.005600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"s8F"}]},{"client_msg_id":"6f7c15f6-ce63-4b55-b192-9d3b0e67b9f4","type":"message","user":"U03C71D7H","text":"セッションから復元する際とかは1度に大量のファイルを開くんですよ","ts":"1603886438.005400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ed4P"}]},{"client_msg_id":"d32b183e-4d16-4249-9720-496ad2711229","type":"message","user":"U9S4G0LJW","text":"実装がアレという気持ちはわかる","ts":"1603886408.004900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Eyn"}]},{"client_msg_id":"fd986a49-b66d-45ef-9c01-ec5dd6710285","type":"message","user":"U9S4G0LJW","text":"Vimを使っている時間のうちファイルを開く処理に使ってる時間ってそこまでないと思われる","ts":"1603886397.004500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uqVnE"}]},{"client_msg_id":"bc7d7545-93ad-421b-b87a-a94b680ae491","type":"message","user":"U03C71D7H","text":"Vim の ftdetect、拡張子だけで判別できるものは Dict で検出するような方式に移行できないだろうか、と言う妄想をしています\n現状で遅くて困ってるってことはまあないのだけど、どう考えてもスケーラブルじゃないし…\n可能性あるだろうか","ts":"1603886273.002100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"E03w"}]}]
