[{"client_msg_id":"7563a7da-254e-4300-a3f5-2d04a6cb0fb2","type":"message","user":"U6XP9LZ6V","text":"やっぱり conpty で test_terminal を流すとハングアップするんだよな。ハングアップしたところでデバッガでアタッチすると ClosePseudoConsole() の中で止まってるようだが…。（とりあえず 32bit 版で現象を確認。）","ts":"1595694743.178800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cS7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"856e6f26-cb3e-4f84-b829-4d0b80efd6b6","type":"message","user":"U6XP9LZ6V","text":"<https://docs.microsoft.com/ja-jp/windows/console/closepseudoconsole>","ts":"1595696910.179000","attachments":[{"fallback":"ClosePseudoConsole function - Windows Console","id":1,"title":"ClosePseudoConsole function - Windows Console","title_link":"https://docs.microsoft.com/ja-jp/windows/console/closepseudoconsole","text":"Closes a pseudoconsole from the given handle","thumb_url":"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png","blocks":null,"service_name":"docs.microsoft.com","service_icon":"https://docs.microsoft.com/favicon.ico","thumb_width":400,"thumb_height":400,"from_url":"https://docs.microsoft.com/ja-jp/windows/console/closepseudoconsole","original_url":"https://docs.microsoft.com/ja-jp/windows/console/closepseudoconsole"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/YB2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"468953b7-6120-4bac-911b-f3ee18df1bce","type":"message","user":"U6XP9LZ6V","text":"気になることが書いてある。\n&gt; Failure to drain the buffer may cause the Close call to wait indefinitely until it is drained or the communication channels are broken another way.","ts":"1595696955.179700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"z+zS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b429d704-15c4-4148-94eb-08e3a848301f","type":"message","user":"U6XP9LZ6V","text":"<https://docs.microsoft.com/ja-jp/windows/console/creating-a-pseudoconsole-session#ending-the-pseudoconsole-session>","ts":"1595697853.179900","attachments":[{"fallback":"Creating a Pseudoconsole session - Windows Console","id":1,"title":"Creating a Pseudoconsole session - Windows Console","title_link":"https://docs.microsoft.com/ja-jp/windows/console/creating-a-pseudoconsole-session#ending-the-pseudoconsole-session","text":"A pseudoconsole session will allow an application to host the activities of a character-mode application","thumb_url":"https://docs.microsoft.com/en-us/media/logos/logo-ms-social.png","blocks":null,"service_name":"docs.microsoft.com","service_icon":"https://docs.microsoft.com/favicon.ico","thumb_width":400,"thumb_height":400,"from_url":"https://docs.microsoft.com/ja-jp/windows/console/creating-a-pseudoconsole-session#ending-the-pseudoconsole-session","original_url":"https://docs.microsoft.com/ja-jp/windows/console/creating-a-pseudoconsole-session#ending-the-pseudoconsole-session"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"49to"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2fd3d204-e4cf-42d8-a3ad-37d821c163c6","type":"message","user":"U6XP9LZ6V","text":"&gt; Closing the session has several side effects which can result in a deadlock condition if the pseudoconsole is used in a single-threaded synchronous fashion.\nシングルスレッドだとデッドロックするかも、と","ts":"1595697929.180800","team":"T03C4RC8V","reactions":[{"name":"syobon","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"i2TuL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"699cc6fe-987e-4f7b-9e3e-34bfe0115d6d","type":"message","user":"U6XP9LZ6V","text":"ClosePseudoConsole() を別スレッドにすれば解決するのではと試してみたが、Vim自体が止まることはなくなったが、相変わらず ClosePseudoConsole() から応答が返ってこなくなることがあるようで失敗。どうしたものか。","ts":"1595732103.183500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5i7dS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"04b09f1a-c26b-4b9f-9555-004a253ea643","type":"message","user":"UAZ33BKV2","text":"厄介ですねえ...","ts":"1595734631.183800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"azf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
