[{"client_msg_id":"598ad5c0-06d8-42a2-a604-bb04a671bbdd","type":"message","user":"U03C6TEAZ","text":"ichizok さんの方でだいたい当たりついてるならお願いします。もしまだであれば続きやります。","ts":"1603637418.486400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sjn3"}]},{"client_msg_id":"b2594bfe-4438-4a1a-a371-bad370b8d4d3","type":"message","user":"U03C6TEAZ","text":"メッセージだけの問題なのか... 違うとこ深追いしすぎた。","ts":"1603585570.484200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xhij"}]},{"client_msg_id":"31aaf68a-0adb-4ff2-a4d2-a9093ecd8916","type":"message","user":"U7986PPFH","text":"cmdwinで例外発生すると、cmdwinから出るとき `did_emsg = FALSE` になるのに `*msg_list` は not NULL なので整合性が崩れているのか","ts":"1603580705.483400","edited":{"user":"U7986PPFH","ts":"1603582605.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xzi"}]},{"client_msg_id":"f3591403-f77d-4159-a88b-126cfa41ee3c","type":"message","user":"U7986PPFH","text":"completion 絡みの何かですかね","ts":"1603561647.480600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"u0eKH"}]},{"client_msg_id":"77ccd970-4f92-404b-8d75-2257f8173a59","type":"message","user":"U7986PPFH","text":"eskk もcmdwin閉じるときに `Vim(return):E565: Not allowed to change text or change window` が発生しているので","ts":"1603561598.480000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ffBb"}]},{"client_msg_id":"79b107d0-cb6c-49bb-8167-fe5d7bda224b","type":"message","user":"U03C6TEAZ","text":"eskk の方は `\u0026lt;c-f\u0026gt;\u0026lt;cr\u0026gt;` でも起きてるぽいんですよね。なんだろう。","ts":"1603561475.478600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"z3g"}]},{"client_msg_id":"0d5aa89e-0e2c-46d4-8e2c-d4318816b77a","type":"message","user":"U7986PPFH","text":"`\u0026lt;C-w\u0026gt;` というか、cmdwin の中から投げられた例外を処理するケースですね","ts":"1603561416.478000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oywj/"}]},{"client_msg_id":"cfff4b9f-6551-4c65-87cb-8a984a951b01","type":"message","user":"U03C6TEAZ","text":"eskk の方もスタックトレース見ると `current_exception` を double free してそうなのでもしかすると同じかもですが。","ts":"1603561357.477400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"B9l"}]},{"client_msg_id":"a6f50126-23cb-49f0-82bc-9918c664952e","type":"message","user":"U03C6TEAZ","text":"なるほど `\u0026lt;C-w\u0026gt;` まぜると落ちるのか。","ts":"1603561304.476700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YeS"}]},{"client_msg_id":"d17dacd6-78ee-4105-ba59-80abd5d2cd3f","type":"message","user":"U7986PPFH","text":"元の現象は free 後の領域に触ってしまうのが原因","ts":"1603560951.476300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dPv"}]},{"client_msg_id":"f9107e73-7c66-45e3-a369-c6ec2eeda21b","type":"message","user":"U7986PPFH","text":"test.vim\n```func Input() abort\n  try\n    return input('')\n  finally\n    \" NOP\n  endtry\nendfunc\ncall Input()```\n`vim --clean -S test.vim`\n`\u0026lt;C-f\u0026gt;\u0026lt;C-w\u0026gt;\u0026lt;C-w\u0026gt;\u0026lt;CR\u0026gt;`\nこれでも落ちますね、こっちはdouble-freeですが","ts":"1603560874.475500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y68FS"}]},{"client_msg_id":"752cbf9e-a426-499a-8d6d-0b011cf9b969","type":"message","user":"U9S4G0LJW","text":"そういやtryの方のスタックをダンプする手段ってあったっけ","ts":"1603557678.473300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/qN"}]},{"client_msg_id":"27690bb9-a8e1-416b-bcae-129bfeceb10e","type":"message","user":"U9S4G0LJW","text":"続きは明日やろう","ts":"1603557484.473000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bGo75"}]},{"client_msg_id":"f0a36e30-5d61-4408-8ccc-311378c3ba7c","type":"message","user":"U9S4G0LJW","text":"input_helper内のtry-finallyを除去するとSEGVはしないようになる、ただcmdwinを出して確定するとしばらく固まる","ts":"1603557472.472800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ApbHR"}]},{"client_msg_id":"903f3541-5959-44d7-8434-ce39cdabdf4e","type":"message","user":"U9S4G0LJW","text":"try-finallyが原因だから、やはり例外とcmdwinか","ts":"1603556887.472200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nPrS5"}]},{"client_msg_id":"70476eba-f355-48ed-b845-2ab579e77d1a","type":"message","user":"U9S4G0LJW","text":"ちがう","ts":"1603556362.471800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"X4o9B"}]},{"client_msg_id":"01bf21d1-0d31-40ba-9e3d-e2238896bf88","type":"message","user":"U9S4G0LJW","text":"vital側のinputsave()とinputrestoreを潰してもeskk側でs:inputが呼ばれていると死ぬな…","ts":"1603556029.471100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3fU7"}]},{"client_msg_id":"7a7b7c0c-7370-48ee-a86f-9158d1f32f7f","type":"message","user":"UAZ33BKV2","text":"この前もinputssaveで超絶技巧的な話題になったなあ","ts":"1603555237.469600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2umYL"}]},{"client_msg_id":"70b711e1-0ab8-4271-b8fc-f03df14749d5","type":"message","user":"U03C6TEAZ","text":"例外が絡んでそうなんですよね。","ts":"1603553367.468700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hdgeO"}]},{"client_msg_id":"96243d3f-b97b-4584-8422-9fca72cccfc0","type":"message","user":"U03C6TEAZ","text":"まだ最小手が見つけられてないんですよね。","ts":"1603552882.468500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q1tVF"}]},{"client_msg_id":"bebd3849-c2c6-4a11-9182-3cfc7192e766","type":"message","user":"U9S4G0LJW","text":"inputsaveか、ちょっと見てみよう","ts":"1603552786.468200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YNc"}]},{"client_msg_id":"9a2b94dc-1263-4783-b94f-9538ac6c1c6a","type":"message","user":"U9S4G0LJW","text":"そんな難問だったかー…","ts":"1603552745.467700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Au1"}]},{"client_msg_id":"7494727a-688f-4534-b022-4a5e49c864f8","type":"message","user":"U03C6TEAZ","text":"これわからんなー。むずい。","ts":"1603552651.466000","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":1,"users":["U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"I1Rns"}]},{"client_msg_id":"683cb043-31ad-409c-968c-0b3ad965ea36","type":"message","user":"U03C6TEAZ","text":"\u003chttps://github.com/vim-jp/issues/issues/1356\u003e","ts":"1603552645.465700","attachments":[{"fallback":"GitHub: eskk.vimの辞書登録時にcmdwinを呼んで確定するとVimがクラッシュする · Issue #1356 · vim-jp/issues","id":1,"title":"eskk.vimの辞書登録時にcmdwinを呼んで確定するとVimがクラッシュする · Issue #1356 · vim-jp/issues","title_link":"https://github.com/vim-jp/issues/issues/1356","text":"不具合の内容 eskk.vim で辞書登録を行う際に (初期状態の場合)により cmdwin を呼び出した上で確定しようとすると Vim が落ちます。 切り分けができていないのでこのような報告になっていますが自力で解決できそうにないのですみません。 現象・ログ gdb の backtrace です #0 utf_ptr2char (p=0x6c6c616320202020 \u0026lt;error...","thumb_url":"https://avatars2.githubusercontent.com/u/1051958?s=400\u0026v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/vim-jp/issues/issues/1356","original_url":"https://github.com/vim-jp/issues/issues/1356"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JYSM"}]}]
