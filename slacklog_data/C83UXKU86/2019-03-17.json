[{"client_msg_id":"ee46d744-adb6-4631-ad40-05214302f92b","type":"message","user":"U03C71D7H","text":"textprop の件、free() のタイミングで invalid pointer で落ちてるところまではわかったんですが、こういう場合調べるコツとかってあるでしょうか?","ts":"1552818245.300100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7a6c2488-2bbf-42c8-adcf-ee7465db7b35","type":"message","user":"U03C6TEAZ","text":"invalid pointer ってことはだいたい double free ですね。","ts":"1552818740.301100","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1eafcb46-b4b6-4f85-8586-0ad0f33792a8","type":"message","user":"U03C6TEAZ","text":"二回同じ箇所通ってるか、参照カウンタがどこかで足されてない。","ts":"1552818794.302500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3dc4061e-1b52-4cf6-a35d-916ecb607dbb","type":"message","user":"U06BRP8VD","text":"レアな可能性としてはバッファーオーバーラン","ts":"1552818834.303900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"91ad855b-7146-4665-9348-a76afb86ecff","type":"message","user":"U03C6TEAZ","text":"未初期化のまま free という可能性もありますね。笑","ts":"1552818869.305300","team":"T03C4RC8V","reactions":[{"name":"laughing","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3d916a58-6b46-46ce-a510-a64f8284d009","type":"message","user":"U06BRP8VD","text":"落ちたタイミングでstacktraceとれないかしら? それあるとある程度何が起こってるかわかるかも。","ts":"1552818901.306200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a78a7ca3-97d8-44ce-915a-eed7e85b2f13","type":"message","user":"U03C6TEAZ","text":"なのでコツとしてはアロケーションと参照カウンタまわりのソースを読むのがいいかも。","ts":"1552818920.306900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3d9d359d-11d8-49f2-bc8c-801f6c204944","type":"message","user":"U03C6TEAZ","text":"落ちた時点で bt","ts":"1552818943.308000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a9f9fc6b-ec55-4573-b789-6a318f4c803e","type":"message","user":"UAZ33BKV2","text":"ロギングするとしたら、allocate/freeな呼び出しで関数名とアドレスとカウントをとるとかですかね...","ts":"1552818962.308700","edited":{"user":"UAZ33BKV2","ts":"1552818979.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bd75948a-3c79-4210-9d4a-6d573a89f4f0","type":"message","user":"U06BRP8VD","text":"double freeを検出できるmallocの実装ないかしらね?","ts":"1552818977.308800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"70763b8c-1250-4ef3-853a-dc379728e4ac","type":"message","user":"UAZ33BKV2","text":"カウント管理があるなら、解放でデクリメントでマイナス回になりそうだけど...それをチェックするデバッグコードでも入れます?","ts":"1552819027.309800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"df2b08cd-13a5-418f-88f4-b6bb29228d0d","type":"message","user":"U06BRP8VD","text":"glibc だと MALLOC_CHECK_=1 で遅くなるけど double free 許容するの?!","ts":"1552819068.310600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"977daa46-17bc-4f97-a37e-ae5d969eb0f9","type":"message","user":"UAZ33BKV2","text":"(これ以上はあれこれ言えるレベルではないな...)","ts":"1552819084.311000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ce0fdb4f-f3cd-4b7a-9a4c-2286d3a0b168","type":"message","user":"U03C71D7H","text":"```\n#5  0x00005555556ba449 in vim_free (x=0x555555b881bf) at misc2.c:1810\n#6  0x000055555569f634 in ml_close (buf=0x555555b501f0, del_file=1) at memline.c:847\n#7  0x000055555569f6fb in ml_close_all (del_file=1) at memline.c:871\n#8  0x0000555555702644 in mch_exit (r=0) at os_unix.c:3297\n#9  0x00005555558622df in getout (exitval=0) at main.c:1541\n#10 0x0000555555644d69 in ex_quit_all (eap=0x7fffffffd1c0) at ex_docmd.c:7394\n#11 0x000055555563afe5 in do_one_cmd (cmdlinep=0x7fffffffd400, sourcing=1, cstack=0x7fffffffd4f0, fgetline=0x0, cook\n#12 0x000055555563841d in do_cmdline (cmdline=0x7fffffffe027 \"qa!\", fgetline=0x0, cookie=0x0, flags=11) at ex_docmd.\n#13 0x0000555555637a1b in do_cmdline_cmd (cmd=0x7fffffffe027 \"qa!\") at ex_docmd.c:634\n#14 0x0000555555864686 in exe_commands (parmp=0x555555b21060 &lt;params&gt;) at main.c:2943\n#15 0x00005555558613ad in vim_main2 () at main.c:798\n#16 0x0000555555860c5f in main (argc=10, argv=0x7fffffffdb78) at main.c:441\n```","ts":"1552819189.312400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"75f9fb6b-6941-4def-87cc-50a913056d49","type":"message","user":"U03C71D7H","text":"ここまで取れた感じです","ts":"1552819203.312800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9604ef1d-e6f8-4e7e-a8f8-7a1c338ff933","type":"message","user":"U06BRP8VD","text":"カウントは管理、解放時にデクリメントを忘れてdouble freeを引き起こしているんじゃないか、っていう推測なので今回の件ではそこいじるのあんま効果なさそうなんですよね。","ts":"1552819211.312900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"772af479-c855-4758-8ca5-af42a9781f59","type":"message","user":"U06BRP8VD","text":"あるぇ? 終了時におちてんの?","ts":"1552819229.313400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"65289981-ae51-427c-9614-efd560c389a8","type":"message","user":"U03C71D7H","text":"あ、ですね。:q で落ちます (↑では :qa!)","ts":"1552819254.314000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"60bb71d8-ae45-4981-b2e7-ae559bd0980b","type":"message","user":"U03C71D7H","text":"Vim のソースを追う練習と思ってやってるのだけど、再現コードをここに貼ったらあっという間に特定されて練習にならなさそうで怖いなと思って貼れてないw","ts":"1552819299.314700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"19bbbc1f-2009-44d5-aa76-60d72d20cd5c","type":"message","user":"U06BRP8VD","text":"では僕ならこの先どう追うか、だけ示しときますね。","ts":"1552819340.315500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"387d0dcb-660e-4871-ab2d-987ba0d4f8cd","type":"message","user":"U03C71D7H","text":"ありがたや :pray:","ts":"1552819356.316200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a66a617b-26ea-4670-9052-e95d1739c7ff","type":"message","user":"U06BRP8VD","text":"memfile.c は閉じてる可能性が高いので、落ちてる場所をみると","ts":"1552819365.316500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f7052068-406d-46f0-b8ba-1ca6c9f5b650","type":"message","user":"U06BRP8VD","text":"ml_line_ptr の freeなんですね。","ts":"1552819374.316800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd8d2825-3f1f-4ddf-8a95-4843b06944f7","type":"message","user":"U06BRP8VD","text":"この値を別の場所で参照している場所をチェックして、コピーからのfreeするケースがないかチェックするのと、","ts":"1552819407.317500","edited":{"user":"U06BRP8VD","ts":"1552819457.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"550dbc87-e78c-4913-a129-07e8c869698d","type":"message","user":"U06BRP8VD","text":"ml_close 内に double free を妨げる細工をしてみます。","ts":"1552819460.318100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec6d3f40-14b3-4b5d-b48b-1af7a85f4936","type":"message","user":"U06BRP8VD","text":"たぶん後者を先にやったほうが良い。","ts":"1552819466.318300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8b12d354-7748-445f-af99-436961cacf07","type":"message","user":"U03C71D7H","text":"おお","ts":"1552819472.318600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4028a803-af30-401a-a058-b85561259500","type":"message","user":"U06BRP8VD","text":"なんならそこのfreeでptrを記録するだけでも良いかも。","ts":"1552819513.319200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f135d273-6566-45fc-a7dd-c6a9d2b484cf","type":"message","user":"U06BRP8VD","text":"同じptrが2度表示されたらml_close()が2回呼び出しされることが問題で、そうでなければ誰かがコピーしているって","ts":"1552819542.319800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2693525-d042-464e-b402-bd22eadb60d4","type":"message","user":"U03C71D7H","text":"記録するのはどうするのがラクでしょう?","ts":"1552819562.320100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"49f1dd23-bf46-45f7-ad25-c4f1e1f4cab5","type":"message","user":"U06BRP8VD","text":"stdout/err にかいて vim -g -f で起動するってのはどう? で出力を sort | uniq -c でカウントする。","ts":"1552819630.321100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"54b1ac1e-f248-4e67-a7ab-294d29c0851c","type":"message","user":"U03C71D7H","text":"うっ、X 環境ない…","ts":"1552819649.321600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9f14bda8-1fb1-4494-ab23-6784b0d54d9d","type":"message","user":"U06BRP8VD","text":"お、素なのか。","ts":"1552819668.321900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"540331b0-0fe4-4360-bf61-be16a77b50a1","type":"message","user":"U03C71D7H","text":"素です…","ts":"1552819674.322300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"47a9c074-3d2c-4b91-9709-3df45c20f3d2","type":"message","user":"UBQ2H65JQ","text":"私はfopen()で適当にファイルに書き出しちゃうなぁ","ts":"1552819708.323500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d0130bc-263c-496e-8b7e-2aecd96473a9","type":"message","user":"U06BRP8VD","text":"毎回fopen &amp; fprint &amp; fcloseですね。","ts":"1552819722.324100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3aace37f-d509-4108-85a5-33ba0d7a30f1","type":"message","user":"U9S4G0LJW","text":"前にデバッグしたときはファイル開いてメッセージ書いて閉じるマクロ書いてたな","ts":"1552819730.324700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d853c322-13db-42a4-8b5a-80c2caa98de6","type":"message","user":"U06BRP8VD","text":"めんどいけど確実","ts":"1552819730.324800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ef9a207c-cbf7-4a89-8df9-0f4f3c065edc","type":"message","user":"U03C71D7H","text":"なるほどなるほど。それでやってみます！","ts":"1552819737.325100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8ea8d180-51e6-4567-89d8-df058026b611","type":"message","user":"U06BRP8VD","text":"Winだと_RPTXあるんですけどね。","ts":"1552819744.325400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"30e68e89-a0db-4ea3-a63f-2c5fcaa584eb","type":"message","user":"U06BRP8VD","text":"gdbはないのかなぁ?","ts":"1552819748.325700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec0e2446-ab8a-4335-b6f6-5d6874a382f9","type":"message","user":"UBQ2H65JQ","text":"WindowsだとOutputDebugStringとかも使うけど","ts":"1552819792.327300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f8d6993d-77cf-4c64-aea9-bf5199dc509f","type":"message","user":"U06BRP8VD","text":"stderr に書いて、起動時にリダイレクトするって手は使えないのかしら?","ts":"1552819827.328500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3EA2F154-C784-4114-A1D5-E60FA9D9912F","type":"message","user":"U7986PPFH","text":"ASAN有効にしてビルドすると、double freeの場合1回目のfreeの箇所を報告してくれますよ","ts":"1552819873.329600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9f9dfb6-f49a-40c0-8253-777109dbe18d","type":"message","user":"U03C71D7H","text":"おお、有力情報","ts":"1552819922.329800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"C2CE9AB8-D48E-45A1-9D4F-B61E557A6EAB","type":"message","user":"U7986PPFH","text":".travis.ymlにASANビルドしているjobがあるので参考になります","ts":"1552820079.332100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"591ff50c-8c08-4e52-a3b0-e4990409b5c0","type":"message","user":"U03C71D7H","text":"ありがとうございます！","ts":"1552820099.332300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92290e05-e09c-4651-b20c-705b7fdb32cb","type":"message","user":"U03C71D7H","text":"とりあえず愚直に fopen で書き出して見たところ、同じポインタが2回 free されてますね…","ts":"1552820332.332800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1dd4c137-2a1f-44cb-932e-4afefe89be36","type":"message","user":"U03C71D7H","text":"ASAN を試して1回目のfreeの場所を探してみよう","ts":"1552820349.333100","team":"T03C4RC8V","reactions":[{"name":"a","count":2,"users":["U03C4RC8X","U9S4G0LJW"]},{"name":"sa","count":2,"users":["U03C4RC8X","U9S4G0LJW"]},{"name":"nri","count":2,"users":["U03C4RC8X","U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0a76658f-c09f-40bb-99ba-f3418dbf92a4","type":"message","user":"U03C71D7H","text":"(やばいビルド方法全然わからない…めっちゃ調べてる)","ts":"1552821438.335500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ae1a23e5-660a-446e-a2c7-202e3a3039aa","type":"message","user":"U06BRP8VD","text":"え、つまりml_close が2回呼ばれてる?","ts":"1552821542.336100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9a77b799-592f-4c46-86da-cdceeb200f9e","type":"message","user":"U06BRP8VD","text":"あ、そんときの buf が違ってるかのうせいがあるのか。","ts":"1552821562.336500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"992d29fc-70fb-4f7e-9a35-72630bcb906d","type":"message","user":"U03C71D7H","text":"`&amp;buf-&gt;b_ml.ml_line_ptr` を記録したところ、同じアドレスが2回記録されていた感じですね","ts":"1552821616.337000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9314beab-9f21-4d20-8743-0e8c0ac79efd","type":"message","user":"U06BRP8VD","text":"buf-&gt;b_ml.ml_mfp で double close から守ってるハズなんで、bufか buf-&gt;b_ml の値が違ってると思うんですよね。","ts":"1552821626.337200","edited":{"user":"U06BRP8VD","ts":"1552821676.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ebdd7296-8248-4e8a-a018-91fd6d0e84b9","type":"message","user":"U03C71D7H","text":"naru-hodo","ts":"1552821684.337500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"55c5d050-22e0-4a42-b280-166439d3e489","type":"message","user":"U06BRP8VD","text":"`buf-&gt;b_fname` をprintすれば十分かも。","ts":"1552821877.337900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92e757bb-7037-4391-94bd-4c8d0904a751","type":"message","user":"U03C6TEAZ","text":"それって clean 状態で再現しますか？","ts":"1552821983.338900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2e200e7a-c0d4-4949-ba20-012ca49b804e","type":"message","user":"U03C71D7H","text":"buf を記録したんですが2回とも同じでした…","ts":"1552821984.339000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"006d67b2-431f-4cca-944a-24710d5649a1","type":"message","user":"U03C71D7H","text":"clean ですね","ts":"1552821991.339200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cda83e67-05e8-4634-86e7-246afc63666e","type":"message","user":"U03C71D7H","text":"`vim -u NONE -i NONE -N -S ~/textprop.vim -c qa!` (.vim は再現用スクリプト)","ts":"1552822024.339800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8edb123f-1333-4869-af77-50e91c737e2f","type":"message","user":"U03C6TEAZ","text":"だいたい buf の二重 free が発生するのって autocmd 関連なんですよね。","ts":"1552822106.341000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51903a8e-f428-4b65-b024-2bd9cc89a80d","type":"message","user":"U03C71D7H","text":"b_fname は出してないですがスクリプト中では無名バッファしか出てこないのでたぶん何もわからなそう…","ts":"1552822144.341600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b415aab4-df8a-409a-a401-e79488fdd5c1","type":"message","user":"U03C71D7H","text":"`vim_free(buf-&gt;b_ml.ml_line_ptr);` の行に breakpoint 張って gdb で追ってみたら初回通過時にすでに Program received signal SIGABRT, Aborted. が出てる","ts":"1552823184.342700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b4d15b29-90be-471b-958f-38a44c6089b4","type":"message","user":"U06BRP8VD","text":"ん? となると `buf-&gt;b_ml.ml_mfp` によるガードが効いてない?","ts":"1552823257.343400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"42a2177c-1a3f-4bd2-98d4-30280fb5cdcf","type":"message","user":"U03C71D7H","text":"その後 cont するとまた同じ場所に来ててその時2回目の書き出しが発生しているっぽい? Aborted と言ってるのにその後動いてるのがよくわかってない (たぶんCの基礎知識が足りてない)","ts":"1552823295.344200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c02bbcf8-da3c-4fdb-9a94-f22e5c5aaa8f","type":"message","user":"U03C71D7H","text":"うーん、ごはん休憩！","ts":"1552823323.344400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61456203-55bd-42e9-9a07-446889e9666a","type":"message","user":"U06BRP8VD","text":"WinのLINK.EXEがとにかく遅いの、LLVMのlldで代替して解決できないだろうか?","ts":"1552826971.344800","edited":{"user":"U06BRP8VD","ts":"1552826985.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"670cdb57-1abf-494f-a406-207970c4273a","type":"message","user":"U06BRP8VD","text":"それとも新しいVSのLINK.EXE使ったら速いんかしら?","ts":"1552827020.345400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51899465-ea4b-41cb-b917-dafb3813bf54","type":"message","user":"U06BRP8VD","text":"とりあえず Visual Studio 2015 (14.0)の  LINK.EXE でやっても速くはならんかった。","ts":"1552829425.346000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","text":"os_win32.c にあるこの関数の説明って、もはや実態と合ってないのかな? たしかに g_PlatformId はセットしているんだけど、この区別(NTか95か)を付ける必要はもうなくて `win8_or_later` を判断するのと win32_enable_privilege() を呼び出すのと。","ts":"1552830023.346600","files":[{"id":"FH1P1NS5T","created":1552830023,"timestamp":1552830023,"name":"-.cpp","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"cpp","pretty_type":"C++","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":129,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FH1P1NS5T/-.cpp","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FH1P1NS5T/download/-.cpp","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FH1P1NS5T/-.cpp","permalink_public":"https://slack-files.com/T03C4RC8V-FH1P1NS5T-2931e2cd44","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FH1P1NS5T/-.cpp/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"1c655626-0841-457e-b621-66d601d5995e","type":"message","user":"U06BRP8VD","text":"ユニバーサルCRTになると、アプリにランタイムを同梱するのはナンセンスっぽいな。","ts":"1552832080.347500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92778aa3-84cc-4c77-b234-635f3f45cc24","type":"message","user":"U06BRP8VD","text":"vcruntime140.dll を同梱する意味もないはず、だよなぁ?","ts":"1552832164.347900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec3fbce3-0210-4459-9aca-11a3b3d73acd","type":"message","user":"U06BRP8VD","text":"いやそっちは未だに必須なんか?","ts":"1552832183.348100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5714a905-abbf-4f51-98a0-01e10aa7547b","type":"message","user":"U03C6TEAZ","text":"VS の link 最適化してるから遅いんですよね。","ts":"1552832624.349100","thread_ts":"1552832624.349100","reply_count":1,"replies":[{"user":"U06BRP8VD","ts":"1552833275.352100"}],"team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"62dca72f-ba22-4e89-936b-005d3cb5a053","type":"message","user":"U06BRP8VD","text":"いまほとんど素に近い Win 10 を調べたら入ってなかったわ。","ts":"1552832637.349500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d5a6960-d9ce-4f46-a051-79adbae24a27","type":"message","user":"U03C6TEAZ","text":"でもいいバイナリ吐くので我慢してる","ts":"1552832649.350100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9caab0f5-d90c-4af9-84ba-cdf80d24a970","type":"message","user":"U06BRP8VD","text":"VCRUNTIMEはユニバーサルCRTとは別に必要なのか…","ts":"1552832696.350700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7e9c0535-c17c-4a38-baea-88e79bf88128","type":"message","user":"U06BRP8VD","text":"これってCのときにも効きます? C++ならばいろいろ納得なんですけど。","ts":"1552833275.352100","thread_ts":"1552832624.349100","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25565d67-da56-4a03-b459-ddb3778cb1c8","type":"message","user":"U06BRP8VD","text":"手元のWindows で素の 8.1.1009 の src/testdir で nmake -f Make_dos.mak したら幾つかテストが失敗するんだけど、AppVeyor のほうでは失敗してない。何が違うんだろう? 手元がMSVC10 だからかなぁ…あとは iconv が古いとか…\n\n失敗してるのは test_terminal.vim, test_undo.vim, test_alot_utf8.vim","ts":"1552750188.291900","edited":{"user":"U06BRP8VD","ts":"1552750334.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dd7cf68f-50dc-40e8-b202-d210389a10c4","type":"message","user":"U03C6TEAZ","text":"テストの幾つかは日本語ロケールだと失敗したと思います。","ts":"1552750407.292400","team":"T03C4RC8V","reactions":[{"name":"cat-salute","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b6cc894d-8076-4347-80de-84abdd5fb945","type":"message","user":"U06BRP8VD","text":"test_undo.vim は再実行したら成功したっぽい","ts":"1552750619.292600","edited":{"user":"U06BRP8VD","ts":"1552750629.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bbd5a6ea-006d-44a6-a26f-acac08e09770","type":"message","user":"U06BRP8VD","text":"たしかに term は回りは出力からも日本語ロケールっぽい匂いがする。ただ使ってるiconvの古さもあってやや不安…","ts":"1552750677.293600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"40a995a4-01f7-435d-b5c6-a52dd0a98fb4","type":"message","user":"U06BRP8VD","text":"gui と win32 ターゲットは今まだ意味がない(=専用のテストがない)状態か。","ts":"1552750789.294400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e58127fb-bb9b-4f14-8f84-a8135c62c664","type":"message","user":"U06BRP8VD","text":"test_undo.vim やっぱ単品で実行したり、一回全体実行して失敗したあと再テストするとうまくいく。なんか状態持ってんのかなぁ?","ts":"1552751540.295700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"01c61ccc-db3d-4ae5-949f-8b7f1005e589","type":"message","user":"U03C6TEAZ","text":"persistent undo が効いてるとか？","ts":"1552751674.296000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c7dc6da-4c6c-4bd5-98ae-1d8fec2a89e7","type":"message","user":"U06BRP8VD","text":"でも   testdir だから -u NONE -U NONE --noplugins ですよねぇ…","ts":"1552752291.296600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"607b4952-2978-404e-a0bc-076d402f513c","type":"message","user":"U06BRP8VD","text":"さっき test_alot.vim も気まぐれで失敗した(再実行したら通った)w","ts":"1552752364.297100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9240f39b-7668-4d83-82b5-932aa175ea58","type":"message","user":"U06BRP8VD","text":"起動はできるけど実際のDLLが読み込まれない(使おうとすると使えない)言ってるんかな?\n<https://github.com/oneclick/rubyinstaller2/issues/144#issuecomment-473401772>","ts":"1552753006.297800","thread_ts":"1552753006.297800","attachments":[{"fallback":"GitHub: Please embed dependency manifest into the Ruby DLL · Issue #144 · oneclick/rubyinstaller2","id":1,"title":"Please embed dependency manifest into the Ruby DLL · Issue #144 · oneclick/rubyinstaller2","title_link":"https://github.com/oneclick/rubyinstaller2/issues/144#issuecomment-473401772","text":"What problems are you experiencing? Currently, when an application other than ruby(w).exe tries to load Ruby DLL ((x64-)msvcrt-ruby2X0.dll), the ruby_builtin_dlls directory must be added in the PAT...","thumb_url":"https://avatars0.githubusercontent.com/u/840186?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/bfaba/img/unfurl_icons/github.png","thumb_width":250,"thumb_height":250,"from_url":"https://github.com/oneclick/rubyinstaller2/issues/144#issuecomment-473401772","original_url":"https://github.com/oneclick/rubyinstaller2/issues/144#issuecomment-473401772"}],"reply_count":7,"replies":[{"user":"U6XP9LZ6V","ts":"1552961078.383700"},{"user":"U06BRP8VD","ts":"1552961533.384000"},{"user":"U6XP9LZ6V","ts":"1552962330.384200"},{"user":"U06BRP8VD","ts":"1552962354.384400"},{"user":"U06BRP8VD","ts":"1552962379.384600"},{"user":"U6XP9LZ6V","ts":"1552962601.384800"},{"user":"U06BRP8VD","ts":"1552962652.385000"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"851b14af-d13b-4aba-b684-492d7ade0ac2","type":"message","user":"U03C71D7H","text":"termdebug の使い方を知りたくて ujihisa さんの発表資料を見てたのだけど、基本デモなので資料だけだと全然わからん ／(^o^)＼","ts":"1552783584.298100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"F21CA693-A444-447B-8F18-45C29E8C97A5","type":"message","user":"U03C4RC8X","text":"わかり力高めよう","ts":"1552784314.298600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"CC016B88-42E4-4C14-B108-69E5EA07263E","type":"message","user":"U03C4RC8X","text":"今度gdb本貸せます","ts":"1552784326.299000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"756ea4ed-70f4-4e9a-bcbd-9e4e73bf957e","type":"message","user":"U03C71D7H","text":"gdb力高めたい","ts":"1552784360.299200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
