[{"client_msg_id":"12ff10f9-664d-4922-825c-dc8804d05e0c","type":"message","user":"U7D5LRRQD","text":"tmp.vim\n```if 0\n  echo $\"${10}\"\nendif```\n```$ vim -u tmp.vim --noplugin```\nこれでtemplate-string対応したvimが無事signal ABRTするのですが、tmp.vimの内容をtest_template_string.vimに書いても死にません :thinking_face:","ts":"1582977292.151900","thread_ts":"1582977292.151900","reply_count":2,"replies":[{"user":"U6XP9LZ6V","ts":"1582978831.160100"},{"user":"U7D5LRRQD","ts":"1582979071.161600"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ahNc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6613dbcb-dc4e-4b61-99f7-b18ac7b42c28","type":"message","user":"U7D5LRRQD","text":"`src/testdir/Makefile` を見る限り、テストは `runtest.vim` が頑張ってるのかな？　と思うのですが、全容をおいきれず……\nアドバイスください :bow:","ts":"1582977439.153300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"awRhf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d24bda6-312e-4cb9-9c97-645a654f637b","type":"message","user":"U03C6TEAZ","text":"issue no どれでしたっけ。","ts":"1582977547.153600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EC4w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8699868e-13b7-417f-a00f-b00da3320415","type":"message","user":"U6XP9LZ6V","text":"<https://github.com/vim/vim/pull/4634>","ts":"1582977634.153800","attachments":[{"fallback":"GitHub: Support 'template string' ('string interpolation') by aiya000 · Pull Request #4634 · vim/vim","id":1,"title":"Support 'template string' ('string interpolation') by aiya000 · Pull Request #4634 · vim/vim","title_link":"https://github.com/vim/vim/pull/4634","text":"This motivation is here =&gt; #4491 :) This is a version that omitted the &amp;#39;_&amp;#39; support. (Please see #4491 (comment)) Please take this patch if you agree to this :+1: Or let&amp;#39;s discuss again ...","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/pull/4634","original_url":"https://github.com/vim/vim/pull/4634"}],"team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5lauR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1e446eff-b39f-4b7c-a5cd-7ae2e363428e","type":"message","user":"U03C6TEAZ","text":"azamasu","ts":"1582977660.154200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"i5UIj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c709569-e687-4bb4-83ff-55ba33b96dfe","type":"message","user":"U7D5LRRQD","text":"ありがとうございます :bow:","ts":"1582977669.154400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Lrnh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9e08bf4-21e8-4207-b0f6-b0a5e7b6b4e3","type":"message","user":"U6XP9LZ6V","text":"3737行目、evaluate == FALSEの時に解放しようとして落ちてるっぽい。","ts":"1582978289.155200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XE5a"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9c05ce7d-1a71-443d-94c1-88f2c4834cc8","type":"message","user":"U7D5LRRQD","text":"ありがとうございます！\nそれなのですが、3784行目でcurrent.ga_dataがNULLになっているのが本質的な問題かなと思っていて、でも `$\"${10}\"` の、   `*arg == \"${10}\\\"\"` からの `current.ga_data == NULL` って状況が全くわからないです……。\n直前で `ga_init2()` してるはずなのに……","ts":"1582978611.158200","edited":{"user":"U7D5LRRQD","ts":"1582978665.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UFg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8e5fb784-a7c8-424c-a561-f93d9602ed09","type":"message","user":"U7D5LRRQD","text":"それで結果的に~ `eval1(\"\", &amp;result, 0)` ~ `eval1(NULL, &amp;result, 0)` をして、 result.vval.v_stringにメモリゴミっぽいものが入って…… という動きかと思うのですが、なぜ testだと正しく動くのか（ ちゃんと `ga_init2(&amp;current)`されているのか？）がわからない……\nって感じです :hand::sob::hand:","ts":"1582978784.160000","edited":{"user":"U7D5LRRQD","ts":"1582978901.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MlpL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"638b8bc8-0822-4bad-a442-cc22d2b5eae4","type":"message","user":"U6XP9LZ6V","text":"malloc/free 間違ってる系のバグは必ず落ちるとは限りませんから、LinuxならASANやvalgrind、Windowsならデバッグビルドしたりするのが良いかと。","ts":"1582978831.160100","thread_ts":"1582977292.151900","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GTi"}],"root":{"client_msg_id":"12ff10f9-664d-4922-825c-dc8804d05e0c","type":"message","user":"U7D5LRRQD","text":"tmp.vim\n```if 0\n  echo $\"${10}\"\nendif```\n```$ vim -u tmp.vim --noplugin```\nこれでtemplate-string対応したvimが無事signal ABRTするのですが、tmp.vimの内容をtest_template_string.vimに書いても死にません :thinking_face:","ts":"1582977292.151900","thread_ts":"1582977292.151900","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ahNc"}]}},{"client_msg_id":"cc190d79-e54a-442e-9832-0246dd23aea6","type":"message","user":"U6XP9LZ6V","text":"3707行目でevaluate==FALSEの時に、resultに正しい値が入っているのを期待してはいけないのでは？初期化されずにゴミが入っているのかと。","ts":"1582978960.161400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"njz3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8aa22c8c-2bab-411f-bb4b-f152283d6c0c","type":"message","user":"U7D5LRRQD","text":"一応、手元でvalgrindのdefiniately lostは直していて、ASANはCIで問題がおきたら確認する（なんでか環境構築がうまく行かないため）っていうのはしています :sunglasses:","ts":"1582979071.161600","thread_ts":"1582977292.151900","parent_user_id":"U7D5LRRQD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RW6Y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5310b43b-ee64-450e-91ad-d93fbe12af03","type":"message","user":"U6XP9LZ6V","text":"あ、 `current.ga_data == NULL` はまだ見てない","ts":"1582979100.162200","team":"T03C4RC8V","reactions":[{"name":"tired_face","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6P6MZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c6180d54-b268-448d-a4a2-734c587dd051","type":"message","user":"U7D5LRRQD","text":"ところでなんか、新しいslackのリッチな入力方式が使いにくい……","ts":"1582979157.163000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2Tgu8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c5fd4002-5851-4f06-b5e2-2f68abddc516","type":"message","user":"UAZ33BKV2","text":"offにできはするらしいですよ\n(自分は慣れた)","ts":"1582979191.163400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pQj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"49dd7744-fcfe-438a-8c25-715df05c0b85","type":"message","user":"U6XP9LZ6V","text":"ga_init2しただけではga_dataはNULLですよね","ts":"1582979355.165100","thread_ts":"1582979355.165100","reply_count":1,"replies":[{"user":"U7D5LRRQD","ts":"1582979428.165900"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"S3F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f2e2c025-170d-4e19-8dde-6c9b79c17e8e","type":"message","user":"U7D5LRRQD","text":"まじだ！\nありがとうございます。offにできました","ts":"1582979356.165200","thread_ts":"1582979356.165200","reply_count":1,"replies":[{"user":"U7D5LRRQD","ts":"1582979375.165500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vA68"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59ee806e-4dfd-47c7-ad1b-ca73e8722f74","type":"message","user":"U7D5LRRQD","text":"<https://slack.com/intl/ja-jp/help/articles/360039953113-%E3%83%87%E3%82%B9%E3%82%AF%E3%83%88%E3%83%83%E3%83%97%E3%81%A7%E6%9B%B8%E5%BC%8F%E8%A8%AD%E5%AE%9A%E3%82%92%E8%A1%8C%E3%81%86>","ts":"1582979375.165500","thread_ts":"1582979356.165200","parent_user_id":"U7D5LRRQD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3ynA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"315587b9-3c39-4829-9110-01c7190cfc69","type":"message","user":"U7D5LRRQD","text":"その直後に `ga_append(&amp;current, quote)` しているので、NULLではなくなるかと思ってます :hand:","ts":"1582979428.165900","thread_ts":"1582979355.165100","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Mo6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1b9bc478-58ad-4b7a-8f25-ed94b439212a","type":"message","user":"U03C6TEAZ","text":"```diff --git a/src/eval.c b/src/eval.c\nindex 20e0a15f0..3f22ed5d9 100644\n--- a/src/eval.c\n+++ b/src/eval.c\n@@ -3704,6 +3704,7 @@ eval_template_current(garray_T *current, int evaluate)\n     typval_T   result;\n     char_u     *to_eval_current = (char_u *) current-&gt;ga_data;\n\n+    init_tv(&amp;result);\n     if (!eval1(&amp;to_eval_current, &amp;result, evaluate))\n     {\n        ga_clear(current);```","ts":"1582979432.166100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F5n9m"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d45f38a-b52d-40e1-94d2-e85b495c7dab","type":"message","user":"U03C6TEAZ","text":"これで直りませんか。","ts":"1582979437.166300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GdP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"555e7166-8956-417c-bb76-64e4f38ae8d4","type":"message","user":"U7D5LRRQD","text":"オッ","ts":"1582979444.166500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+t="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c3f2595f-964d-4f51-af97-5318e3f2688e","type":"message","user":"U7D5LRRQD","text":"な……なおった！！\nありがとうございます！！ :bow: :bow: :bow:\nなんで！！！","ts":"1582979499.166900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fGyHg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"94aa23bc-37bd-4863-9aae-2911d5e05748","type":"message","user":"U03C6TEAZ","text":"vim のソース見続けて10何年のオッサン力です。","ts":"1582979533.167900","team":"T03C4RC8V","reactions":[{"name":"sasumatsu","count":2,"users":["U9S4G0LJW","U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y3x"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c13fe8d2-7193-4a06-acd5-b886b7353f24","type":"message","user":"U6XP9LZ6V","text":"僕の指摘とmattnさんの修正は同じこと言ってますね。","ts":"1582979544.168100","thread_ts":"1582979544.168100","reply_count":1,"replies":[{"user":"U7D5LRRQD","ts":"1582979625.168700"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"De54"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29a2e5a4-551d-4d86-b9a2-396d31e192d1","type":"message","user":"U03C6TEAZ","text":"ゴミ開放してるんでしょうね。","ts":"1582979569.168300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0yAKs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e391144d-ea51-4f5d-ac6b-a88eb00d4c5b","type":"message","user":"U7D5LRRQD","text":"すみません、理解できてませんでした :bow:\nありがとうございます！","ts":"1582979625.168700","thread_ts":"1582979544.168100","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mDMs+"}],"root":{"client_msg_id":"c13fe8d2-7193-4a06-acd5-b886b7353f24","type":"message","user":"U6XP9LZ6V","text":"僕の指摘とmattnさんの修正は同じこと言ってますね。","ts":"1582979544.168100","thread_ts":"1582979544.168100","reply_count":1,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"De54"}]}},{"client_msg_id":"2e144ceb-4425-40a6-a436-be0f94946cd8","type":"message","user":"U6XP9LZ6V","text":"&gt; `current.ga_data == NULL` って状況が全くわからないです……。\n本当にそうなってました？(手元ではそこは未確認)","ts":"1582979661.169800","thread_ts":"1582979661.169800","reply_count":5,"replies":[{"user":"U7D5LRRQD","ts":"1582979761.170800"},{"user":"U7D5LRRQD","ts":"1582979774.171000"},{"user":"U6XP9LZ6V","ts":"1582980063.171700"},{"user":"U7D5LRRQD","ts":"1582980153.172200"},{"user":"U7D5LRRQD","ts":"1582980193.172800"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/0Me"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3ce60148-5cb1-4036-bc6d-613b5fc69eb7","type":"message","user":"U03C6TEAZ","text":"個人的にはソースのネストがもう少し減ってもOKかなという感じ。 `eval_template_current` は無くてもいいな、くらいの。","ts":"1582979711.170600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kQ8Y/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5eb63c66-72b6-40ca-8212-e5c956a1b779","type":"message","user":"U7D5LRRQD","text":"```Core was generated by `./src/vim -u tmp.vim --noplugin'.\nProgram terminated with signal SIGABRT, Aborted.\n#0  0x00007ff773c5522b in kill () from /usr/lib/libc.so.6\n(gdb) frame\n#0  0x00007ff773c5522b in kill () from /usr/lib/libc.so.6\n(gdb) frames\nUndefined command: \"frames\".  Try \"help\".\n(gdb) bt\n#0  0x00007ff773c5522b in kill () from /usr/lib/libc.so.6\n#1  0x000055fd1324f1c7 in may_core_dump () at os_unix.c:3369\n#2  0x000055fd1324f17f in mch_exit (r=1) at os_unix.c:3335\n#3  0x000055fd13383405 in getout (exitval=1) at main.c:1708\n#4  0x000055fd132118af in preserve_exit () at misc1.c:2155\n#5  0x000055fd1324cd52 in deathtrap (sigarg=6) at os_unix.c:1094\n#6  &lt;signal handler called&gt;\n#7  0x00007ff773c54f25 in raise () from /usr/lib/libc.so.6\n#8  0x00007ff773c3e897 in abort () from /usr/lib/libc.so.6\n#9  0x00007ff773c98258 in __libc_message () from /usr/lib/libc.so.6\n#10 0x00007ff773c9f77a in malloc_printerr () from /usr/lib/libc.so.6\n#11 0x00007ff773ca114c in _int_free () from /usr/lib/libc.so.6\n#12 0x000055fd13214731 in vim_free (x=0x55fd13214b2a &lt;ga_grow+227&gt;) at misc2.c:1803\n#13 0x000055fd1316306d in eval_template_current_into_result (current=0x7ffcd5bff400, result=0x7ffcd5bff3e0, quote=34 '\"', evaluate=0)\n    at eval.c:3737\n#14 0x000055fd131631d1 in get_template_string_tv (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:3784\n#15 0x000055fd13160e6c in eval7 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0, want_string=0) at eval.c:2630\n#16 0x000055fd1316095f in eval6 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0, want_string=0) at eval.c:2372\n#17 0x000055fd131603e2 in eval5 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:2187\n#18 0x000055fd1315ff2f in eval4 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:2036\n#19 0x000055fd1315fd81 in eval3 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:1957\n#20 0x000055fd1315fbda in eval2 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:1889\n#21 0x000055fd1315f9f2 in eval1 (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:1817\n#22 0x000055fd13167b63 in ex_echo (eap=0x7ffcd5bff8c0) at eval.c:6406\n#23 0x000055fd13195602 in do_one_cmd (cmdlinep=0x7ffcd5bffaf8, sourcing=1, cstack=0x7ffcd5bffbe0, fgetline=0x55fd132a9526 &lt;getsourceline&gt;, \n    cookie=0x7ffcd5c00180) at ex_docmd.c:2491\n#24 0x000055fd13192921 in do_cmdline (cmdline=0x55fd15357a90 \"if 0\", fgetline=0x55fd132a9526 &lt;getsourceline&gt;, cookie=0x7ffcd5c00180, \n    flags=7) at ex_docmd.c:978\n#25 0x000055fd132a8dbf in do_source (fname=0x7ffcd5c01d7b \"tmp.vim\", check_other=0, is_vimrc=0, ret_sid=0x0) at scriptfile.c:1362\n#26 0x000055fd1338587b in source_startup_scripts (parmp=0x55fd1342fba0 &lt;params&gt;) at main.c:3194\n#27 0x000055fd13381bb6 in main (argc=4, argv=0x7ffcd5c00358) at main.c:432\n(gdb) frame 14\n#14 0x000055fd131631d1 in get_template_string_tv (arg=0x7ffcd5bff800, rettv=0x7ffcd5bff810, evaluate=0) at eval.c:3784\n3784                is_eval_current_success = eval_template_current_into_result(\n(gdb) p *arg\n$1 = (char_u *) 0x55fd15357ba9 \"${10}\\\"\"\n(gdb) p current\n$2 = {ga_len = 0, ga_maxlen = 0, ga_itemsize = 1, ga_growsize = 80, ga_data = 0x0}```","ts":"1582979761.170800","thread_ts":"1582979661.169800","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6mkUM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d88d4fa-70fb-4354-92eb-6e86a617abd0","type":"message","user":"U7D5LRRQD","text":"こんな感じでした\n（読めるかな……）","ts":"1582979774.171000","thread_ts":"1582979661.169800","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"883FN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ff6cbec2-3f98-444c-8a4c-45322b0dfca6","type":"message","user":"U6XP9LZ6V","text":"eval_template_current で ga_clear を呼んで current がクリアされた後の状態を見てませんかね？","ts":"1582980063.171700","thread_ts":"1582979661.169800","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9yl5X"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c2f3025-f173-4d01-bd48-b0798a911399","type":"message","user":"U7D5LRRQD","text":"`eval_template_current` 消してみました :sunglasses:","ts":"1582980078.172100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fv2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"be8164c2-8f67-4ac7-abff-ae05564e497a","type":"message","user":"U7D5LRRQD","text":"あ、そうか！\ngdbでrunしてるときの気持ちで見てましたが、core dump読むときは、全て最後のメモリ結果が表示されるのでした\n（よね……？）","ts":"1582980153.172200","thread_ts":"1582979661.169800","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1kGI8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fdbc7426-57a9-4133-b701-d5af2c8bc736","type":"message","user":"U7D5LRRQD","text":"うおおお、全ての謎が解決しました。\nいつもありがとうございます！ :pray: :pray: :pray:","ts":"1582980193.172800","thread_ts":"1582979661.169800","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Vl3Vh"}],"root":{"client_msg_id":"2e144ceb-4425-40a6-a436-be0f94946cd8","type":"message","user":"U6XP9LZ6V","text":"&gt; `current.ga_data == NULL` って状況が全くわからないです……。\n本当にそうなってました？(手元ではそこは未確認)","ts":"1582979661.169800","thread_ts":"1582979661.169800","reply_count":5,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/0Me"}]}},{"client_msg_id":"f0d47690-d7d3-48c2-8efe-d491ffe5d5dd","type":"message","user":"U7D5LRRQD","text":"k-takataさんとmattnさんの嗅覚すごい……","ts":"1582980266.173500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kEg0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f5076a99-ab92-4a16-b65a-197d09aa9449","type":"message","user":"U6XP9LZ6V","text":"eval_template_current_into_result() は current を読んで結果を返すだけかと思ったら、current をクリアしちゃうのはわかりにくい気がします。\nget_template_string_tv() の中で、eval_template_current_into_result() から戻ってきてからクリアした方が分かりやすくないかな。","ts":"1582981380.176200","thread_ts":"1582981380.176200","reply_count":7,"replies":[{"user":"U7D5LRRQD","ts":"1582982637.176900"},{"user":"U6XP9LZ6V","ts":"1582984087.183000"},{"user":"U6XP9LZ6V","ts":"1582985173.183200"},{"user":"U7D5LRRQD","ts":"1582985745.183800"},{"user":"U7D5LRRQD","ts":"1582985907.184100"},{"user":"U6XP9LZ6V","ts":"1582986793.185900"},{"user":"U7D5LRRQD","ts":"1582987184.186700"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3zZI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"95a1a644-1dbc-4a6f-b924-43aed2da7466","type":"message","user":"U03C6TEAZ","text":"カバレッジは落ちてるけどテストはパスしてそうですね。 <https://travis-ci.org/vim/vim/builds/656643296>","ts":"1582981403.176700","attachments":[{"fallback":"Travis CI - Test and Deploy Your Code with Confidence","id":1,"title":"Travis CI - Test and Deploy Your Code with Confidence","title_link":"https://travis-ci.org/vim/vim/builds/656643296","text":"Travis CI enables your team to test and ship your apps with confidence. Easily sync your projects with Travis CI and you'll be testing your code in minutes.","blocks":null,"service_name":"travis-ci.org","service_icon":"https://cdn.travis-ci.org/favicon-b4e438ec85b9ae88d26b49538bc4e5ce.png","from_url":"https://travis-ci.org/vim/vim/builds/656643296","original_url":"https://travis-ci.org/vim/vim/builds/656643296"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TEyP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a6569ae3-3eb5-46ef-bbd4-085e63f26e77","type":"message","user":"U7D5LRRQD","text":"確かに。\n外出ししてみました :hand:","ts":"1582982637.176900","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ycY7Q"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"588abd08-64a4-4981-af3a-c6daa4e3c617","type":"message","user":"U7D5LRRQD","text":"ぬっ。\nカバレッジってどうやって上げればいいんでしょうか……","ts":"1582982657.177300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BFlda"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6f2c090c-9df5-41e8-8896-60272dafe8f7","type":"message","user":"U03C6TEAZ","text":"要点だけパスしてれば無理に上げる必要はないんじゃないですかね。","ts":"1582982908.177800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mJ5z"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e2af56eb-21ce-4cd3-a657-98793d43c136","type":"message","user":"U03C6TEAZ","text":"無理にテストコード足してもプロレスになるだけだし。","ts":"1582982930.178300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JOq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3462f97c-dd26-41cc-9278-0f3257b83002","type":"message","user":"U7D5LRRQD","text":"プロレスw\nそしたら、valgrindで検出できたdefiniately lostsや、CIでのasan異常とか出てないと思うので、大丈夫っぽそう……？","ts":"1582983039.179300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9ybP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"154b30fb-96e3-4fc0-bbb8-f9f85685a2bb","type":"message","user":"U7D5LRRQD","text":"今いちおう、my vimrcをtemplate string対応に書き換えて、検査してます！","ts":"1582983056.179700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"j0K9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c3ee1a2-d2a3-4988-8c6f-bac328384cfe","type":"message","user":"U03C6TEAZ","text":"テストの異常系が薄いかなという印象です。","ts":"1582983138.180000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"l6lB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"298cd7da-95d7-4492-824f-a4214b656f42","type":"message","user":"U7D5LRRQD","text":"思いつくあたりは試したつもりなので、どんなのがあるとよいでしょうか","ts":"1582983276.180400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DM+41"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ad34e6e8-07a0-42bc-8c62-4f8a350af5c4","type":"message","user":"U7D5LRRQD","text":"さっきの `if 0` とかか","ts":"1582983295.180700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1AG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dbb991cb-5502-4c60-a920-af6a4c190d38","type":"message","user":"U03C6TEAZ","text":"中の eval で例外が発生する物とか。","ts":"1582983350.181200","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U7D5LRRQD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xKG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bbfbf75d-2266-4a6c-aa94-55647645a42f","type":"message","user":"U7D5LRRQD","text":"評価するとEXXXが発生する関数を `${}` の中で呼び出して、ちゃんとEXXXがcatchできるか。\nって感じですかね","ts":"1582983411.181900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"LWpAU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"abc2c3d1-7041-4d7a-b7df-74fc431ecbeb","type":"message","user":"U7D5LRRQD","text":"おっ、なんかlambda scopeな変数に異常がありそう","ts":"1582983439.182300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KfKb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"569a45dd-cca5-4b20-8db7-db518fa8617e","type":"message","user":"U7D5LRRQD","text":"lambda scopesなテストと、異常系テスト2件、足してみました :+1:","ts":"1582983974.182800","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U03C6TEAZ"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sSbdJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b898f63a-98fe-4400-8d98-481ea8fbf65b","type":"message","user":"U6XP9LZ6V","text":"3715行目と3780行目の ga_clear(current) は不要になったと思います。","ts":"1582984087.183000","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1J/Sa"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"364b0885-bae7-46ca-9c47-8cde761097ad","type":"message","user":"U6XP9LZ6V","text":"間違えた、3780行目は必要","ts":"1582985173.183200","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+YB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"26a46a68-628d-4bc3-868c-ff70c5d36fa7","type":"message","user":"U03C6TEAZ","text":"イェガッパンは何を言ってるんだろう。","ts":"1582985498.183700","thread_ts":"1582985498.183700","reply_count":1,"replies":[{"user":"U6XP9LZ6V","ts":"1582986844.186100"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y5l4G"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21ffebfa-b1a8-4a6e-a508-d7aa801d298d","type":"message","user":"U7D5LRRQD","text":"あれ、 `eval_template_current_into_result()` 呼び出しの下の `ga_clear(&amp;current)` の下で `ga_append(&amp;current, quote)` してますが、 `ga_append()` ってメモリを確保しないのでしたっけ","ts":"1582985745.183800","thread_ts":"1582981380.176200","edited":{"user":"U7D5LRRQD","ts":"1582985819.000000"},"parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FAq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b2e3b67c-9949-41d5-84bb-68475e3f98a5","type":"message","user":"U7D5LRRQD","text":"`ga_clear(&amp;current)` 削除したら valgrindのdefinitely lostsが増えたので、必要っぽい……？？","ts":"1582985907.184100","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pND"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0eb3403c-093f-43b3-83e7-a87643e33729","type":"message","user":"U7D5LRRQD","text":"そっか、 `call({x -&gt; $'${x}'}, [10])` の `$'${x}'` が評価されるタイミングで `x` を評価しても、そのスコープにxはいないんだ……","ts":"1582986291.185500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hmwo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cee09515-99ea-49f0-99c9-482037d6f0e4","type":"message","user":"U7D5LRRQD","text":"あ、そういうやつじゃないか","ts":"1582986682.185800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"35E"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"73d713bd-4730-40b8-96b4-1123818ac726","type":"message","user":"U6XP9LZ6V","text":"現状は3780行目は必要です。\nただ、is_eval_current_success==FALSE でも `ga_append(&amp;current, quote);` を実行しているのはちょっと無駄な気もしますね。どうせクリアしてしまうので。","ts":"1582986793.185900","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"R1i0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8c5bc4e3-b64a-4dc0-9dfb-0b37723629de","type":"message","user":"U6XP9LZ6V","text":"無視でいいと思う","ts":"1582986844.186100","thread_ts":"1582985498.183700","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BADj"}],"root":{"client_msg_id":"26a46a68-628d-4bc3-868c-ff70c5d36fa7","type":"message","user":"U03C6TEAZ","text":"イェガッパンは何を言ってるんだろう。","ts":"1582985498.183700","thread_ts":"1582985498.183700","reply_count":1,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y5l4G"}]}},{"client_msg_id":"33f10fd7-74c2-4337-87ee-d4ca7dfdf735","type":"message","user":"U7D5LRRQD","text":"テスト通せました :fist:","ts":"1582987081.186600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qMoQt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d241a093-91b0-4a27-a099-69eaa688f749","type":"message","user":"U7D5LRRQD","text":"あ、そこか！\n無駄をなくしてみました :hand:","ts":"1582987184.186700","thread_ts":"1582981380.176200","parent_user_id":"U6XP9LZ6V","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"p5kp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a92e7bc4-ec05-47cc-b431-0de77dfb178d","type":"message","user":"U7D5LRRQD","text":"そして問題がまた見つかった","ts":"1582987236.187100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aGL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"27ec4855-1ed1-4892-b224-498c3bf8b7f7","type":"message","user":"U6XP9LZ6V","text":"lambdaの高速化パッチ、CIに掛けたら落ちた。調査する気が起きないので、一旦放棄…","ts":"1582933413.147900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8LO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ea24e8e5-f4af-4c23-a418-34e15a9b2535","type":"message","user":"U6XP9LZ6V","text":"GCで使ってるメモリーを回収されちゃってるのかな？","ts":"1582933532.148700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"I8Lf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9ee27ee3-2dd1-4499-b941-4c9a472cc8de","type":"message","user":"U03C6TEAZ","text":"GitHub Actions から python2 消えるっぽいですね。CI として python2 使ってる人はそろそろ覚悟を。","ts":"1582936670.150200","team":"T03C4RC8V","reactions":[{"name":"goodpoem","count":5,"users":["U9S4G0LJW","U06BRP8VD","UEBF2KQTD","U0M7GCBPD","U7JL1UKKL"]},{"name":"hai-small","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kkWV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
