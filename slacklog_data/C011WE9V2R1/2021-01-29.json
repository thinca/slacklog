[{"client_msg_id":"af0eb0c9-c3d2-4c0b-968b-b93b9d4f97a9","type":"message","user":"U019X06MFU1","text":"んだから現行の vim/libvterm に ConPTY の特殊挙動をハンドルできる機能追加をしてたんだけど、現状 ConPTY の HEAD って３種類ありまして\nいよいよ判別がつかないので、ったって挙動が３種３様で、まあ破綻してんですけどね(;´Д`)とっととレンダエンジン全部突っ込めやとは思ってます\nいちいち追っかけるのがきっついし Bram さんは libvterm author の leonerd さんの許可取っとるん？的な話に持ってくし…\nもともと libvterm のバッファ管理手法は ambiguous width に対応できる構造じゃないし、leonerd さんネットにいないようなんで手詰まり局面","ts":"1611911201.076400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BXBjZ"}]},{"client_msg_id":"ddade58c-1362-4c04-9f4f-54c44b8f71ab","type":"message","user":"U019X06MFU1","text":"あー(;´Д`)ビンゴ\nsrc/os_win32.c の read_console_input() から呼んでる (is|make)__ambiwidth__event() っすね\n最初は WT の特殊挙動だったんだけど cmd.exe の conhostV2 をまるごと WT のレンダエンジンに挿げ替える計画があるみたいで\n実際リリース毎に「機能の持ち込み」があったんすよ、絵文字とか ambi 系文字に Backspace を重ねたときの挙動とか\nしょうがないんでキーバッファのログ取ってバイトコードを読み下したうえで当て推量込みのバッファ捏造をやってみたところ動いたので、ってところ\n今でも前述２つの関数を外すと ambiwidth characters は入力できません、なんで WT でキーコード殺してるのかは意図がわからんですが…","ts":"1611910221.066600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r0rD"}]},{"client_msg_id":"d3487934-cbf7-4ada-9f23-f60c0ea32d23","type":"message","user":"UAZ33BKV2","text":"あー、nyagosの...","ts":"1611909877.061700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RgrRX"}]},{"client_msg_id":"8b6a647e-cd02-4ac0-b104-6f5492dea7b0","type":"message","user":"U6XP9LZ6V","text":"これ \u003chttps://zetamatta.hatenablog.com/entry/2020/09/29/130026\u003e","ts":"1611909705.060000","attachments":[{"fallback":"標準愚痴出力: ReadConsoleInput の U+2000～U+2FFFの一部の文字に対する奇妙な挙動 - 標準愚痴出力","id":1,"title":"ReadConsoleInput の U+2000～U+2FFFの一部の文字に対する奇妙な挙動 - 標準愚痴出力","title_link":"https://zetamatta.hatenablog.com/entry/2020/09/29/130026","text":"そもそもの発端は、この issue： Unicode · Issue #390 · zetamatta/nyagos ∞ (U+221E) という文字が入力できないという話。どうも、Unicode の U+2000～U+2FFF の一部のコードを右クリックで Windows のコンソールにペーストすると、ReadConsoleInput で得られるデータが妙なことになるようだ（だが、それにも関わらず、CMD.EXE はうまいこと拾ってるんだよな） それを確認するために、go-console-test という検証プログラムを作った。 まずは正常に入力される 「Ç (U+00C7)」を右クリックで…","image_url":"https://ogimage.blog.st-hatena.com/12704830469096112115/26006613633995737/1606829844","blocks":null,"ts":1601352026,"service_name":"標準愚痴出力","service_icon":"https://zetamatta.hatenablog.com/icon/touch","from_url":"https://zetamatta.hatenablog.com/entry/2020/09/29/130026","original_url":"https://zetamatta.hatenablog.com/entry/2020/09/29/130026"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"66GLe"}]},{"client_msg_id":"9f41bcd3-a70e-406c-a75c-550162da94f3","type":"message","user":"U6XP9LZ6V","text":"ここ最近のWin10のコンソールで、特定の文字コードの範囲の文字が入力できない問題があるの、報告しないとなあ。","ts":"1611909515.057900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RSU=5"}]},{"client_msg_id":"9540e0b3-0b54-4e4e-bf14-f3d45ff5c298","type":"message","user":"U019X06MFU1","text":"あれ(;´Д`) microsoft/terminal 下の検索 author:ntak で出てこなかったので記憶の混濁でした、失礼をば…\nVim 側のコードから WT/ConPTY のログを取った結果の記憶と、自分のミスでログ取りがうまくなかったかの検証をしなきゃなあと放置してた記憶が変形合体したのかなと\nvim/vim の issue で MS の ambiwidth に対する認識があまりにあまりでこれ colored が言っても駄目だなきっつぅと感じてほかの作業に移った思い出が…\nそうですね、新規 issue 案件です","ts":"1611906504.056600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8zL21"}]},{"client_msg_id":"86eb5335-f3ce-458f-913e-965515e9285e","type":"message","user":"U6XP9LZ6V","text":"ConPTY どのissueですか？新規issueを作るしかない？","ts":"1611900865.049800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NaoMH"}]},{"client_msg_id":"51b117c5-fa63-4c69-a0f6-12b588869bc2","type":"message","user":"UBQ2H65JQ","text":"わかる。バッチファイルでこんなことしたりするな\n\nfor /F \"usebackq delims==\" %%i in (`where /r \"%ProgramFiles(x86)%\" vcvarsall.bat`) do ( call \"%%i\" )","ts":"1611900725.048800","edited":{"user":"UBQ2H65JQ","ts":"1611900816.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nSdFE"}]},{"client_msg_id":"f24cfd29-4aaa-4a1a-879b-c2dfb1883926","type":"message","user":"U06ECBRTJ","text":"Windows って、実は WHERE コマンドが一番ファイル検索に便利なんじゃないだろうか","ts":"1611900278.047000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0hc"}]},{"client_msg_id":"8a9c85cc-79a8-44f2-9e41-d5e0cfa37381","type":"message","user":"U019X06MFU1","text":"このネタ前にも話したけどあれから一切の改善なしで一応突っ込んだ issue がよりによってトリアージ黒 (PRIOR-2) なんでザ・エンド","ts":"1611897680.044200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+csXQ"}]},{"client_msg_id":"231d7036-7bd7-4958-a993-9dc2c5cb8d3e","type":"message","user":"U019X06MFU1","text":"WT 内包版 ConPTY の STDOUT から来るべき ^[[?25l が全部 ^[[25l になっててカーソルが断じて消せず(;´Д`)俺のせい？","ts":"1611897180.040700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"I7qZ"}]},{"client_msg_id":"59e29077-33c8-4d8f-93d6-e1c437761aaf","type":"message","user":"UAZ33BKV2","text":"\u003chttps://forest.watch.impress.co.jp/docs/news/1303271.html\u003e","ts":"1611894452.037200","attachments":[{"fallback":"窓の杜: 「Windows Terminal」に待望の設定GUI ～v1.6プレビュー版で先行導入／正式版「Windows Terminal 1.5」にはハイパーリンク機能","id":1,"title":"「Windows Terminal」に待望の設定GUI ～v1.6プレビュー版で先行導入／正式版「Windows Terminal 1.5」にはハイパーリンク機能","title_link":"https://forest.watch.impress.co.jp/docs/news/1303271.html","text":"　米Microsoftは1月28日（現地時間）、「Windows Terminal 1.5」を正式リリースした。プレビュー版でテストされていたハイパーリンク機能などが利用できるようになった。併せて「Windows Terminal Preview 1.6」のリリースも発表されている。","image_url":"https://forest.watch.impress.co.jp/img/wf/list/1303/271/image2.jpg","blocks":null,"ts":1611883800,"service_name":"窓の杜","service_icon":"https://forest.watch.impress.co.jp/favicon.ico","from_url":"https://forest.watch.impress.co.jp/docs/news/1303271.html","original_url":"https://forest.watch.impress.co.jp/docs/news/1303271.html"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WCI"}]},{"client_msg_id":"7686e22f-4d5b-4024-9005-feda161c3455","type":"message","user":"UP6PA1UBE","text":"管理ツールを別の管理ツールで入れるとやらかしやすいので clone で入れてます","ts":"1611890955.037000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nMDom"}]},{"client_msg_id":"791474b2-e521-418e-850d-9c37c93401b0","type":"message","user":"UAZ33BKV2","text":"まあそこはREADMEにもありますからね(chocolateyのインストールラッパーは一応ケアしてるっぽいが)","ts":"1611890886.036300","edited":{"user":"UAZ33BKV2","ts":"1611890903.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"x0EB3"}]},{"client_msg_id":"20bc48cd-898d-427d-a0cf-3749b27ad5d1","type":"message","user":"UP6PA1UBE","text":"PATH設定だけは自分でうまいことやらないといけませんが","ts":"1611890844.035800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Yfb"}]},{"client_msg_id":"73707194-2fe6-4c79-a718-da623d9264dc","type":"message","user":"UAZ33BKV2","text":"おお(ちょっと前にためして、まだ微妙だったのだが)","ts":"1611890796.035400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MlA"}]},{"client_msg_id":"a4e03703-cd0a-4e95-9ae0-9de98c694841","type":"message","user":"UP6PA1UBE","text":"vbs で実装されてて本家 pyenv とは全然別物です。\nが、操作はだいたい同じようにできます。(前はいろいろ違った","ts":"1611890721.034800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TkM"}]},{"client_msg_id":"33a72f5b-1687-4ee2-bfbc-788fc94e27af","type":"message","user":"U06ECBRTJ","text":"ほー","ts":"1611890632.034000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ofMR"}]},{"client_msg_id":"7e1bda15-fbb1-4ae2-9fb7-944869592df2","type":"message","user":"UP6PA1UBE","text":"pyenv-win がいつの間にかまともになっていた\n以前はすべてのインストール可能なバージョンがハードコードされていたりいろいろアレだった","ts":"1611890543.033800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EAACm"}]},{"client_msg_id":"f6b0f97e-8d25-43c4-9295-1483758726f8","type":"message","user":"U06ECBRTJ","text":"`mingw-w64-x86_64-python-3.8.7-3` が最近来ましたね","ts":"1611890251.033000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ff9"}]},{"client_msg_id":"afe33dbb-a903-4a2b-8c44-59b142a5f146","type":"message","user":"U06ECBRTJ","text":"3.9 が来てたら、mingw-gvim-transparency のビルドがコケるので…","ts":"1611890226.032700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FWnW"}]},{"client_msg_id":"3966c981-095a-4347-bc1b-a9286acce398","type":"message","user":"U06ECBRTJ","text":"mingw-x64 に python3.9 が来る気配が無い","ts":"1611888754.031500","team":"T03C4RC8V","reactions":[{"name":"majika","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BrNw"}]}]
