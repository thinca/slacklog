[{"client_msg_id":"a29586dd-f86e-4c2c-b9e7-87098e2a8eaa","type":"message","user":"U8996GYBF","text":"funcnameというよりhandlerに統一した方が分かりやすいかな\nありがとうございました！","ts":"1590562812.352300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QYGw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"28c8d1a0-76ee-4e55-b30f-7fcb5e777265","type":"message","user":"UAZ33BKV2","text":"ので、さらにちょっと直す","ts":"1590562820.352600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oxF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a7716f1-f6fb-477e-8b32-067cb0fe4eb4","type":"message","user":"U03C6TEAZ","text":"funcref で `l:` いけたかな？","ts":"1590562836.352900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N=KAS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c2b2149c-6603-46ce-8e14-884a4d4dc638","type":"message","user":"U8R597E9H","text":"_実は動かしておりません。。。さすがです。。。_","ts":"1590562856.353200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+I=T"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b4c3dcd6-4d01-499b-9f13-2f0fda842feb","type":"message","user":"UAZ33BKV2","text":"こうかな?","ts":"1590562889.353600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mkQ0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8e171da9-5b7c-44f3-8cca-9edb734bd421","type":"message","user":"U8996GYBF","text":"`call call(string, [arg1, arg2])` は `call func(arg1, arg2)` みたいに展開されるってことですよね、多分","ts":"1590562943.354700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CCF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"19e55de8-0aa4-4dc0-92ca-e5aff009812c","type":"message","user":"U8996GYBF","text":"完全にVim script知らないと不可能なところだった・・・","ts":"1590562955.355100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FkB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"33c171f1-5d62-4094-8781-c9db143ee4d9","type":"message","user":"U8R597E9H","text":"（自分の知る限り）そうです。","ts":"1590562968.355400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cH=0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9877ce03-20f3-4ee3-9c50-9067d9bafc86","type":"message","user":"UAZ33BKV2","text":"関数に引数配列を適用する、ですね、JavaScriptのapplyとかと同じ?","ts":"1590562981.356000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"itME"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"298e5862-0294-4cff-8583-036ddb605805","type":"message","user":"U8996GYBF","text":"リモートプラグイン、厳しすぎる","ts":"1590562981.356100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"48e"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fc609072-04f2-4b0c-930c-3809a0976d7a","type":"message","user":"U8R597E9H","text":"この辺奥が深くてたまにわからなくなる。特に function/funcref の違いは全くわかっていない。。。","ts":"1590562989.356300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vKrZR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bf89594d-67ea-45c6-bd24-611f9d8fa820","type":"message","user":"UAZ33BKV2","text":"funcrefは個別じゃなく、名前であらわされるものらしいので","ts":"1590563015.357000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NeGU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1f7e5cfa-a38d-49e0-b7bb-078628c5804f","type":"message","user":"U9S4G0LJW","text":"funcrefは実体ないと定義した時にこける","ts":"1590563026.358000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jfyZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50eba13a-0efc-47df-85e5-4cc05f00e84e","type":"message","user":"UAZ33BKV2","text":"再定義したときに入れ替わる可能性がある?","ts":"1590563029.358200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6PB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9a10a0c-cacf-4e23-be4a-96f54b993497","type":"message","user":"U8996GYBF","text":"根本的な話としてはどうしてリモートプラグインでcallはできるのにfunctionが取れないのって部分が・・・","ts":"1590563042.358500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/YfX7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c12522c-58c0-48f8-9008-7f949129b575","type":"message","user":"U8996GYBF","text":"それで一瞬で解決するのに","ts":"1590563050.358900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fgV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"80c2c395-2cf8-4260-8679-34648f8e582a","type":"message","user":"U9S4G0LJW","text":"もしかしてコントリビュートチャンス？","ts":"1590563083.359800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=rx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"66c5668f-78fa-47a6-bb07-2c2674d28c2e","type":"message","user":"UAZ33BKV2","text":"rubyの\n```method_missing```\nみたいななにかを使ってるのかな?","ts":"1590563096.360300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G9LKu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3152b989-ded7-4bb7-ba9b-46f3de9773c8","type":"message","user":"U8996GYBF","text":"これ以上リモートプラグインの深淵に突っ込みたくない気持ちがすごい","ts":"1590563100.360500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EoEgG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"14bafd78-946e-4370-8c34-627933b212e3","type":"message","user":"U8996GYBF","text":"ずっと配信してるんですけど、ここだけで1時間以上使った気がする","ts":"1590563134.361500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iiiV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"08cc60fb-d830-4d1b-8cbf-9180f55e47f0","type":"message","user":"U8R597E9H","text":"まあ言語をまたいで関数自体をやり取りするのは普通に難しそうなイメージなので納得感はありますけどね。","ts":"1590563139.361700","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G9GR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1d187b11-6c77-4cc6-8d23-50bdc9cbcd18","type":"message","user":"U8996GYBF","text":"まだ全然実装の方に入れてないのに既にめっちゃ辛い","ts":"1590563211.362200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hnbrY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d1767664-9c63-4b5b-91c9-d6ee22c6b23d","type":"message","user":"UAZ33BKV2","text":"vim-slでも使ってる autocmd CmdUndefined かな?でもこれコマンドだけだよね...","ts":"1590563227.362600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9VK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b46c2391-822f-4144-9b82-423f27c5737a","type":"message","user":"UAZ33BKV2","text":"FuncUndefinedあるか、これだな","ts":"1590563245.362800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"igc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5cfda1c1-4b95-471d-9f55-601526f3e65b","type":"message","user":"UAZ33BKV2","text":"未定義だったらリモートかもしれないので、呼び出し名の実体化をやるみたいなことかな","ts":"1590563275.363300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dWqT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"39ed42af-b398-4183-b470-3eee83f28525","type":"message","user":"UAZ33BKV2","text":"このへんは deinのon_cmdとかon_funcとかもそれっぽい処理してるかもしれないので、参考になるかも(実装を知るための)","ts":"1590563299.363900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"o0V"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"72c4a708-5533-4b9d-8db8-bc5923409df3","type":"message","user":"UAZ33BKV2","text":"dein、補完に名前でるから","ts":"1590563317.364200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jECUP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c0443781-1d47-4284-a8cb-e73e6245ab5c","type":"message","user":"UAZ33BKV2","text":"たぶん定義自体はするんだろうけど...","ts":"1590563326.364500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PR7ND"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"912c6b32-47fa-47c0-9c4b-1cf1236f3e61","type":"message","user":"U03C6TEAZ","text":"CmdUndefined、FuncUndefined、それらを包括するための autocmd Error E429 みたいなのが欲しいと思い始めてから300年が過ぎました。","ts":"1590563539.365300","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4yV1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4A74E5FC-B1E6-4AD7-A260-E16ECF7C5FB4","type":"message","user":"U014MH32FA5","text":"ノーマルモードに入った時に日本語入力を解除したいのですが、何か方法はあるでしょうか？　使っているのはMacVimのCLIで、MacVim Kaoriya（というかGUI）やGoogle日本語入力はできれば使用したくないです。\nキーマップでキーコードを指定できるなら英数キー（キーコード102）を`^[`にマッピングすればいいと考えたのですが、その方法も見当たらず……。調べてもカーソルの色を変えるなどの記事が出てくるので不可能なのかもしれませんが。","ts":"1590566044.366300","thread_ts":"1590566044.366300","reply_count":2,"replies":[{"user":"UBNPMJJGM","ts":"1590576798.369300"},{"user":"U014MH32FA5","ts":"1590578700.369600"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YOqg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fafe3db3-e066-405a-9c5a-6bcc736e732b","type":"message","user":"U9S4G0LJW","text":"CLI版のVimにIMEの制御をする機能は全くなかったような","ts":"1590566101.366900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qxu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"71fcd0e9-f5a9-4ec0-8e33-a38b1280d246","type":"message","user":"UFYACJ537","text":"<https://github.com/vovkasm/input-source-switcher> これとか?","ts":"1590566129.367300","attachments":[{"fallback":"GitHub: vovkasm/input-source-switcher","id":1,"title":"vovkasm/input-source-switcher","title_link":"https://github.com/vovkasm/input-source-switcher","text":"Command line input source switcher for Mac. Contribute to vovkasm/input-source-switcher development by creating an account on GitHub.","thumb_url":"https://avatars0.githubusercontent.com/u/95272?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/vovkasm/input-source-switcher","original_url":"https://github.com/vovkasm/input-source-switcher"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6eq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"86d80319-bd19-4771-95b1-949bfcecd219","type":"message","user":"U8996GYBF","text":"配信終わったんですがめちゃくちゃ助かりました、手伝ってくれた人ほんとありがとうございました","ts":"1590566956.367900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dIk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d5563a35-36b4-40a9-8014-815e7b2e3ecb","type":"message","user":"U9S4G0LJW","text":"`質問`\nVim8のpopup terminalでは別のウィンドウには移動できないですが、タブ移動ができるのは仕様と考えても大丈夫なんでしょうか？","ts":"1590574052.369200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D+M"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0a45e504-f4aa-474d-8deb-d8cedefad08e","type":"message","user":"UBNPMJJGM","text":"解決済みかもですが、自分はKarabiner-ElementsでEscを押したら英数キーを押す設定してます","ts":"1590576798.369300","thread_ts":"1590566044.366300","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VF13"}],"root":{"client_msg_id":"4A74E5FC-B1E6-4AD7-A260-E16ECF7C5FB4","type":"message","user":"U014MH32FA5","text":"ノーマルモードに入った時に日本語入力を解除したいのですが、何か方法はあるでしょうか？　使っているのはMacVimのCLIで、MacVim Kaoriya（というかGUI）やGoogle日本語入力はできれば使用したくないです。\nキーマップでキーコードを指定できるなら英数キー（キーコード102）を`^[`にマッピングすればいいと考えたのですが、その方法も見当たらず……。調べてもカーソルの色を変えるなどの記事が出てくるので不可能なのかもしれませんが。","ts":"1590566044.366300","thread_ts":"1590566044.366300","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YOqg"}]}},{"client_msg_id":"f57f1f05-1779-4333-84a8-5f919202533a","type":"message","user":"U014MH32FA5","text":"ちょうど今色々試していました。\n<https://vim-jp.slack.com/archives/CJMV3MSLR/p1590566129367300> から色々調べて <https://github.com/ybian/smartim> と言うのを試してみたところうまく行きました！　ありがとうございます。\n（Karabiner-Eはあんま使いたくないんですよね……。前試したんですが色々不具合が起きたので。）","ts":"1590578700.369600","thread_ts":"1590566044.366300","attachments":[{"fallback":"[May 27th, 2020 12:55 AM] gootonori_slack: <https://github.com/vovkasm/input-source-switcher> これとか?","id":1,"author_id":"UFYACJ537","author_name":"iwata","author_subname":"iwata","author_link":"https://vim-jp.slack.com/team/UFYACJ537","author_icon":"https://secure.gravatar.com/avatar/488605d0090951445806a09e3f2c4541.jpg?s=48&d=https%3A%2F%2Fa.slack-edge.com%2Fdf10d%2Fimg%2Favatars%2Fava_0024-48.png","text":"<https://github.com/vovkasm/input-source-switcher> これとか?","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #question","ts":1590566129.367300,"from_url":"https://vim-jp.slack.com/archives/CJMV3MSLR/p1590566129367300","original_url":"https://vim-jp.slack.com/archives/CJMV3MSLR/p1590566129367300"},{"fallback":"GitHub: ybian/smartim","id":2,"title":"ybian/smartim","title_link":"https://github.com/ybian/smartim","text":"A Vim plugin to make it stand well with input methods (Mac only) - ybian/smartim","thumb_url":"https://avatars2.githubusercontent.com/u/10651?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/ybian/smartim","original_url":"https://github.com/ybian/smartim"}],"subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"W5DSR"}],"root":{"client_msg_id":"4A74E5FC-B1E6-4AD7-A260-E16ECF7C5FB4","type":"message","user":"U014MH32FA5","text":"ノーマルモードに入った時に日本語入力を解除したいのですが、何か方法はあるでしょうか？　使っているのはMacVimのCLIで、MacVim Kaoriya（というかGUI）やGoogle日本語入力はできれば使用したくないです。\nキーマップでキーコードを指定できるなら英数キー（キーコード102）を`^[`にマッピングすればいいと考えたのですが、その方法も見当たらず……。調べてもカーソルの色を変えるなどの記事が出てくるので不可能なのかもしれませんが。","ts":"1590566044.366300","thread_ts":"1590566044.366300","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YOqg"}]}},{"client_msg_id":"ed5798e3-c7de-4110-a5d2-37d868ebe29d","type":"message","user":"UAZ33BKV2","text":"imactivatefuncで呼べる外部コマンドとiminsertの組み合せができればいいんですけどねえ...","ts":"1590578895.370400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+lT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1d692fa1-1867-49bd-9d64-4556dc121ae5","type":"message","user":"UAZ33BKV2","text":"<http://hnakamur.blogspot.com/2011/12/mac-os-x-105ime.html>\nの\n<https://github.com/hnakamur/inputsource>\nは効くのかな...","ts":"1590579002.370700","attachments":[{"fallback":"Mac OS X 10.5以降でIMEを切り替えるコマンドラインツールを作りました","id":1,"title":"Mac OS X 10.5以降でIMEを切り替えるコマンドラインツールを作りました","title_link":"http://hnakamur.blogspot.com/2011/12/mac-os-x-105ime.html","text":"hnakamur/inputsource - GitHub に置いてあります。ライセンスはMITです。 バイナリだけ欲しい方は Lionでビルドした64bit実行形式のバイナリ をどうぞ。保存ダイアログが開いたときに拡張子に.txtが追加されて\"inputsource.txt...","blocks":null,"service_name":"hnakamur.blogspot.com","service_icon":"http://hnakamur.blogspot.com/favicon.ico","from_url":"http://hnakamur.blogspot.com/2011/12/mac-os-x-105ime.html","original_url":"http://hnakamur.blogspot.com/2011/12/mac-os-x-105ime.html"},{"fallback":"GitHub: hnakamur/inputsource","id":2,"title":"hnakamur/inputsource","title_link":"https://github.com/hnakamur/inputsource","text":"Command line tool to select text input source on Mac OS X 10.5 (Leopard) or later. - hnakamur/inputsource","thumb_url":"https://avatars0.githubusercontent.com/u/19299?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":180,"thumb_height":180,"from_url":"https://github.com/hnakamur/inputsource","original_url":"https://github.com/hnakamur/inputsource"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bS6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0e89dae4-b773-49ed-ad8c-cbf46a13a216","type":"message","user":"U014MH32FA5","text":"iminsertなんてあるんですね。imnormalがあればいいのに。","ts":"1590579051.371300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gztn5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51e9bd96-dfb5-44ec-9a5c-a903eb6922f2","type":"message","user":"UAZ33BKV2","text":":h iminsert","ts":"1590579089.371700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"H3hD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UPZHKAM7W","text":"```\n                                                *'iminsert'* *'imi'*\n'iminsert' 'imi'        数値 (既定では 0)\n                        バッファについてローカル\n{訳注: iminsert=2 の場合、挿入モードを抜けると IM がオフにされます。\n       再度挿入モードに入ると、前回抜けたときの IM 状態が復元されます。\n       この機能をオフにするには iminsert=0 にしてください。}\n \n        :lmap かインプットメソッド (IM) が挿入モードで使われるかどうかを指定す\n        る。指定できる値は以下の通り。\n                0       :lmap はオフ、IM もオフ\n                1       :lmap はオン、IM はオフ\n                2       :lmap はオフ、IM はオン\n        コマンド &lt;Esc&gt; で挿入モードを終える度に値を 0 に戻すには、次のように\n        すればよい。  \n                :inoremap &lt;ESC&gt; &lt;ESC&gt;:set iminsert=0&lt;CR&gt;\n        これは挿入モードを終えるとき :lmap と IM を自動的にオフに切り替える。\n        Note 挿入モードでコマンド CTRL-^ を使うと、このオプションの値が変わる\n        ので注意 |i_CTRL-^|。\n        オプション 'keymap' に正しいキーマップ名が設定されると、このオプション\n        は 1 になる。\n        これはコマンド \"r\", \"f\" 等の引数にも適用される。\n        AthenaとMotifでは、値を 0 に設定すると正しく働かないようなXIMがある。\n        そのときは XIM を無効にするために 'imdisable' を使うこと。\n \n        Vim が |+xim|、|+multi_byte_ime| もしくは |global-ime| 付きでコンパイ\n        ルされていない場合、外部コマンドによって IME/XIM を制御するために\n        'imactivatefunc' および 'imstatusfunc' を設定することができる。\n```","ts":"1590579091.371800","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"66feb71e-a2e6-4e01-a8d1-96859f49229a","type":"message","user":"UAZ33BKV2","text":"iminsert=2でinsertを抜けるとoffとかあるので、たぶん効くとは思うんですよね","ts":"1590579123.372300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Mcx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f31b4ad8-03b5-4fd6-a031-f1eddc929980","type":"message","user":"U014MH32FA5","text":"うーん上手くいかないですね……。","ts":"1590579267.373000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r2C"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9d8d419a-6066-4f81-bdf2-4a2e2e69c7e0","type":"message","user":"UAZ33BKV2","text":"ただ、これ自体では効かない(GUIじゃないから)これと最後書いてある\n```Vim が |+xim|、|+multi_byte_ime| もしくは |global-ime| 付きでコンパイ\n        ルされていない場合、外部コマンドによって IME/XIM を制御するために\n        'imactivatefunc' および 'imstatusfunc' を設定することができる。```\nが組み合えば、うまくいくんじゃないかなーと。","ts":"1590579383.373800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SPx+z"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cd7caf01-8c34-4323-a0f2-09f6837255b4","type":"message","user":"U014MH32FA5","text":"<https://qiita.com/warashi/items/40f7eecb0e5593efa081>","ts":"1590580140.374000","attachments":[{"fallback":"Qiita: Vimで挿入モードに入ったり出たりした時にIMEをコントロールする - Qiita","id":1,"title":"Vimで挿入モードに入ったり出たりした時にIMEをコントロールする - Qiita","title_link":"https://qiita.com/warashi/items/40f7eecb0e5593efa081","text":"この記事はVim2 Advent Calendar 2017の19日の記事（代打）です。 この記事ではmacOS High Sierraでvimの挿入モードに入ったり、挿入モードから出た時にIMEの状態を自動で切り替える方法を説明し...","image_url":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2&w=1200&mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DVim%25E3%2581%25A7%25E6%258C%25BF%25E5%2585%25A5%25E3%2583%25A2%25E3%2583%25BC%25E3%2583%2589%25E3%2581%25AB%25E5%2585%25A5%25E3%2581%25A3%25E3%2581%259F%25E3%2582%258A%25E5%2587%25BA%25E3%2581%259F%25E3%2582%258A%25E3%2581%2597%25E3%2581%259F%25E6%2599%2582%25E3%2581%25ABIME%25E3%2582%2592%25E3%2582%25B3%25E3%2583%25B3%25E3%2583%2588%25E3%2583%25AD%25E3%2583%25BC%25E3%2583%25AB%25E3%2581%2599%25E3%2582%258B%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3D092c310c58194634efb3a5146a174796&mark-align=center%2Cmiddle&blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540warashi%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3D1d848b431bac1972820a4fca9610b44d&blend-align=center%2Cmiddle&blend-mode=normal&s=d1ea2ca7e48f036e0e23aee138a10759","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png","from_url":"https://qiita.com/warashi/items/40f7eecb0e5593efa081","original_url":"https://qiita.com/warashi/items/40f7eecb0e5593efa081"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NSH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d38d0a3e-e970-4d46-8bd5-8ff46c075ad2","type":"message","user":"U014MH32FA5","text":"これ使ったら大体動作しました！","ts":"1590580192.375100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"62WJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"58c190bc-c2f9-4526-b5db-75753b9e58b6","type":"message","user":"UAZ33BKV2","text":"おお、よかった","ts":"1590580319.375300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bUd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"035fb310-5133-414e-97a0-049409c1d67e","type":"message","user":"U014MH32FA5","text":"```function! s:ImStatusFunc()\n  return system('swim list --current') is# s:JapaneseIM . \"\\n\"\nendfunction```\nvim script全然わからないのですが、ここは何をしているのでしょうか？","ts":"1590580530.376100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BtDp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"37201b3f-5a7c-464b-885c-baef6ccb8c7b","type":"message","user":"U9S4G0LJW","text":"`swim list --current`を実行した結果を`s:japaneseIM . \"\\n\"` と比較してる感じですね、コードだけ読むなら","ts":"1590580587.377700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6TdM5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7d3aec6a-2f7b-4b03-804f-9f11e8e28a8b","type":"message","user":"UAZ33BKV2","text":"えっとですね、ステータスの更新時にswimコマンドを実行して、それがs:JapaneseIMと同じか比較して、文字列を返しています","ts":"1590580588.377800","edited":{"user":"UAZ33BKV2","ts":"1590580652.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0Hvx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9cade3ed-f644-4ca2-8cbc-a2d6fe1fc1cb","type":"message","user":"UAZ33BKV2","text":"解説記事にもありますが、workaround(うまくいかない場合の回避策)っぽいですね","ts":"1590580633.378700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EqYwH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"39135493-36e2-4957-b2de-94a3b60abadf","type":"message","user":"U014MH32FA5","text":"比較してることはわかるのですが、何が返り値なのかよくわからなくて。","ts":"1590580643.379000","edited":{"user":"U014MH32FA5","ts":"1590580654.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y3F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"79FEF8C5-43E9-45C0-B1E5-237997290C2F","type":"message","user":"UBQ2H65JQ","text":"bool値ですね","ts":"1590580661.379900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=R5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f6cc58ba-921d-48d5-b90f-bb4b0468a4b0","type":"message","user":"UAZ33BKV2","text":"ためしにiTermとかで swim list --currentしてみるといいかも","ts":"1590580667.380200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xCi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d0b156f8-bb41-4952-ad0e-64a29d3179ba","type":"message","user":"U9S4G0LJW","text":":h expr-is#","ts":"1590580677.380500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RW7g"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UPZHKAM7W","text":"```\n                        *expr-==*  *expr-!=*  *expr-&gt;*   *expr-&gt;=*\n                        *expr-&lt;*   *expr-&lt;=*  *expr-=~*  *expr-!~*\n                        *expr-==#* *expr-!=#* *expr-&gt;#*  *expr-&gt;=#*\n                        *expr-&lt;#*  *expr-&lt;=#* *expr-=~#* *expr-!~#*\n                        *expr-==?* *expr-!=?* *expr-&gt;?*  *expr-&gt;=?*\n                        *expr-&lt;?*  *expr-&lt;=?* *expr-=~?* *expr-!~?*\n                        *expr-is* *expr-isnot* *expr-is#* *expr-isnot#*\n                        *expr-is?* *expr-isnot?*\n                'ignorecase'次第   大小文字考慮    大小文字無視  \n等しい                  ==              ==#             ==?\n等しくない              !=              !=#             !=?\nより大きい              &gt;               &gt;#              &gt;?\nより大きいか等しい      &gt;=              &gt;=#             &gt;=?\nより小さい              &lt;               &lt;#              &lt;?\nより小さいか等しい      &lt;=              &lt;=#             &lt;=?\n正規表現マッチ          =~              =~#             =~?\n正規表現非マッチ        !~              !~#             !~?\n同一のインスタンス      is              is#             is?\n異なるインスタンス      isnot           isnot#          isnot?\n \n例:\n\"abc\" ==# \"Abc\"   0と評価される\n\"abc\" ==? \"Abc\"   1と評価される\n\"abc\" == \"Abc\"    'ignorecase' が設定されていれば1と、でなければ0と評価\n```","ts":"1590580678.380700","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"d9075277-a306-4858-b1ba-0c94bf1ff42d","type":"message","user":"U014MH32FA5","text":"```. \"\\n\"```\nはなんですか？","ts":"1590580700.381700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vozE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"F459C5AC-B116-4F09-B5D6-DFF5662F8870","type":"message","user":"UBQ2H65JQ","text":"system() is# (s:JapaneseIM . \"¥n\")","ts":"1590580702.381800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vh=lZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a4228338-221c-4723-904b-35fda8b51acd","type":"message","user":"U014MH32FA5","text":"あー()はそこなんですね。","ts":"1590580722.382600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"V7a"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"630423C7-07A4-4798-A388-BC21E59476FE","type":"message","user":"UBQ2H65JQ","text":".は文字列結合です","ts":"1590580782.383400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"P47Xy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d31840b4-f19d-40a9-b4aa-ba3cd11b6cbb","type":"message","user":"UAZ33BKV2","text":"文字列結合演算子は優先度わりと高め?(優先度は把握できてない...)","ts":"1590580794.383800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6pV+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a04f6dd-77d6-4416-9002-65cf57e0de76","type":"message","user":"U9S4G0LJW","text":"swimの結果に改行が含まれているので、比較対象の`s:JapaneseIM`にも改行が含まれている必要があって、それでくっつけてる","ts":"1590580820.385100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+znAQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7957604c-c3ad-4ee5-be0e-fc2067114dab","type":"message","user":"U014MH32FA5","text":"なるほど！　.で文字列結合なのですね。ありがとうございます。","ts":"1590580830.385600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DlLIR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"95831F91-CBBB-4707-95D2-F412FC9FB51C","type":"message","user":"UBQ2H65JQ","text":":echo \"abc\" . \"def\"","ts":"1590580832.385700","thread_ts":"1590580832.385700","reply_count":1,"replies":[{"user":"U014MH32FA5","ts":"1590580922.388000"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6c9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"55a6cef5-2862-4e13-91da-5fc7b38970e4","type":"message","user":"UAZ33BKV2","text":"いまだとsystemlist()[0]がよいだろうなあ","ts":"1590580835.385900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uNr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1c46d4c4-f71a-4fa9-b33b-20eabe8da952","type":"message","user":"U9S4G0LJW","text":"もしくはstridx使って判断するのがよさそう","ts":"1590580855.386300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8g7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"838272B9-D78E-4B92-8752-E5762A7139ED","type":"message","user":"UBQ2H65JQ","text":"(botいないのか","ts":"1590580869.386700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"stEt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c0f60af-7cd9-4122-a433-34f06fcd01ed","type":"message","user":"U9S4G0LJW","text":"<#CUPKWMQFK|lang-vim-script> にしかいなかったような、あっちは","ts":"1590580890.387500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RPD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4b024b2d-9a57-4a58-8828-8c84bb1056dd","type":"message","user":"UAZ33BKV2","text":"テスト実行は <#CUPKWMQFK|lang-vim-script> だけのはず?","ts":"1590580892.387600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"LTM4X"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f42554ee-7ef6-4e7c-888c-bda784bc9e26","type":"message","user":"U9S4G0LJW","text":"いないというか制限か","ts":"1590580906.387900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OQqC8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9db742d3-536f-4fa0-a335-fc545f7f2faa","type":"message","user":"U014MH32FA5","text":"試せました。","ts":"1590580922.388000","thread_ts":"1590580832.385700","parent_user_id":"UBQ2H65JQ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2MDOD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U014ACJV129","text":"<@U014ACJV129> has joined the channel","ts":"1590583125.388300","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"43707eac-6ef6-4a4f-89f0-783b2d6e726a","type":"message","user":"U8996GYBF","text":"fzfのcallbackにfuncrefを渡す必要があるんですが、Remote Pluginで登録したFunctionのFuncRefが取れないみたいで困ってます・・・\n```  call fzf#run({\n  \\ 'source':  source,\n  \\ 'sink*':   function(handler),\n  \\ 'options': options,\n  \\ 'window':  fzf_preview#window#float_or_normal_layout(),\n  \\ })```\nこんなインターフェイスなんですが、どうにかする方法思いつく方いらっしゃらないでしょうか","ts":"1590557477.292700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"M3WVr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9f34e3ac-f80f-4b08-9b40-cb41e4f79f55","type":"message","user":"U8996GYBF","text":"いや、取れるときと取れないときがある気がする\nもうちょっとみてみます","ts":"1590557540.293000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"e5r/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3af0ff75-9577-4779-9eb0-59799430afa8","type":"message","user":"U8996GYBF","text":"1回callしたら関数として呼べるようになる・・・？\nなんだろうこれ","ts":"1590557586.293400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=YLw7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a29380c2-258a-44d0-8145-d89f41bd0de7","type":"message","user":"U9S4G0LJW","text":"遅延評価？","ts":"1590557945.293600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d1x5d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"32c14b4d-8375-47cc-9757-a1ebbb5bf736","type":"message","user":"U9S4G0LJW","text":"autoloadとかもそんな感じだけど(あれってfuncrefにできたっけ)","ts":"1590557996.295000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uT0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1030c22f-c405-448e-91ba-7673d3873866","type":"message","user":"U8996GYBF","text":"RemotePluginの関数はcallするまでは存在しない扱いになってしまってるような予感がする","ts":"1590558025.295500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2epad"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b28fd5fd-9902-4c7c-9cd6-d4f05bb774fa","type":"message","user":"U8996GYBF","text":"いきなりfuncrefを取れない・・・","ts":"1590558054.295800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"61+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7724efa0-35b4-4457-8e95-c4648451928e","type":"message","user":"U8996GYBF","text":"```export interface NvimFunctionOptions {\n    sync?: boolean;\n    range?: string;\n    eval?: string;\n}```\nregisterのときにオプションで渡せるのはこの3つ","ts":"1590558110.296200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NHVY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"46d42846-2db3-408c-af8c-e97247468b4b","type":"message","user":"U8996GYBF","text":"`sync: true` でダメだった気がするんだけど・・・、もう1回やってみよう","ts":"1590558136.296600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Yt9hF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7276ee5e-1634-4b9d-9785-63bfd128221f","type":"message","user":"UAZ33BKV2","text":"いきなりTypeScript","ts":"1590558147.297000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"K3YF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a92b2afa-4a95-473b-8d1c-820cddf51579","type":"message","user":"U8996GYBF","text":"あ、今sync: trueだった","ts":"1590558150.297200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"f=yE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2a456035-a174-41f7-a6e2-8a195b75b561","type":"message","user":"U8996GYBF","text":"未知の関数って言われる・・・","ts":"1590558181.297500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sXp6u"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"45b8d636-902b-48dc-8dbc-e3ae5cb3ca04","type":"message","user":"U8996GYBF","text":"```{\"level\":\"error\",\"message\":\"Error making request to nvim_call_functionnvim_call_function: Vim(call):E700: 未知の関数です: FzfPreviewHandleResource\",\"stack\":\"Error: Error making request to nvim_call_function\\n    at NeovimClient.request (/Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/api/Base.js:75:23)\\n    at NeovimClient.call (/Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/api/Neovim.js:321:21)\\n    at Object.module.exports.119.exports.fzfRunner (/Users/yuki_yano/repos/github.com/yuki-ycino/fzf-preview.vim/build/index.js:84:20)\\n    at Object.plugin_1.plugin.registerCommand.sync [as fn] (/Users/yuki_yano/repos/github.com/yuki-ycino/fzf-preview.vim/build/index.js:2510:22)\\n    at NvimPlugin.&lt;anonymous&gt; (/Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/host/NvimPlugin.js:154:35)\\n    at Generator.next (&lt;anonymous&gt;)\\n    at /Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/host/NvimPlugin.js:8:71\\n    at new Promise (&lt;anonymous&gt;)\\n    at __awaiter (/Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/host/NvimPlugin.js:4:12)\\n    at NvimPlugin.handleRequest (/Users/yuki_yano/dotfiles/.config/yarn/global/node_modules/neovim/lib/host/NvimPlugin.js:133:16)\"}```","ts":"1590558208.298100","edited":{"user":"U8996GYBF","ts":"1590558210.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SqD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"595ba3a8-cac7-4088-82ca-5830982f667c","type":"message","user":"U9S4G0LJW","text":"funcrefじゃなくてfunctionで取れない？","ts":"1590558218.298600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3JK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5093f50f-ae1c-4367-a1ac-fb7259f26669","type":"message","user":"U8996GYBF","text":"callしたあとじゃないとfunctionで存在しないって言われるんですよね","ts":"1590558243.299000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"T51="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"038a1f73-440f-470e-b23e-01426f9ac021","type":"message","user":"U9S4G0LJW","text":"あ、よく見たらfunctionだった…","ts":"1590558281.299500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3U0nE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2bcefee9-57a1-432b-a08c-9f2ceb1b56f0","type":"message","user":"U9S4G0LJW","text":"リモートプラギンなんもわからん","ts":"1590558320.299900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hps"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7938a105-b198-4412-969b-a3ec63110563","type":"message","user":"U8996GYBF","text":"```call remote#host#RegisterPlugin('node', '/Users/yuki_yano/repos/github.com/yuki-ycino/fzf-preview.vim', [\n      \\ {'sync': v:true, 'name': 'TSFzfPreviewProjectFiles', 'type': 'command', 'opts': {}},\n      \\ {'sync': v:null, 'name': 'HelloFzfPreview', 'type': 'command', 'opts': {}},\n      \\ {'sync': v:null, 'name': 'FzfPreviewHandleResource', 'type': 'function', 'opts': {}},\n     \\ ])```","ts":"1590558339.300100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zDXp+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ce896993-b071-4dfa-879c-8db43ef042e0","type":"message","user":"U8996GYBF","text":"UpdateRemotePluginでfunctionとして登録されてはいる","ts":"1590558353.300600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xuY/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b3a2713c-c490-411d-91a4-3384d0b06a3f","type":"message","user":"U8996GYBF","text":"&gt; Registers a function with name name, calling function fn with options. This will be invoked from nvim by entering eg :call name() in normal mode.","ts":"1590558573.301100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vLrP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"812be10b-4da4-4f55-86df-0cba0de6bad6","type":"message","user":"U8996GYBF","text":"normal modeから呼び出すことを想定していて、いきなりfunctionでfuncrefを取るのはルール違反とかそういうやつ・・・？","ts":"1590558601.301700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lUAbW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4576b2fc-8780-4d7a-9e76-4b71b311c90f","type":"message","user":"U8996GYBF","text":"そんなバカな","ts":"1590558612.302000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ksJrN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eb02fe6d-f264-49be-8b6a-47e95601df12","type":"message","user":"UAZ33BKV2","text":"リモートなので呼び出しする時には実際の呼び出し関数になるけど、それが作られるのはnormalでの呼び出しをしたときに置換されるとか?","ts":"1590558657.302700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UP+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61ec9e3c-6d19-4d19-a8ad-0825e434799f","type":"message","user":"U8996GYBF","text":"本格的にそれを感じてきている","ts":"1590558702.302900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SfUk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cc1eb540-7cd5-444f-9aa6-fcc6f4373e03","type":"message","user":"U8996GYBF","text":"とても辛い・・・、ただcallbackを使いたいだけなのに・・・","ts":"1590558714.303200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"b2r4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7efc1f68-3d94-4c9b-a20b-4f4fc4f2161f","type":"message","user":"UAZ33BKV2","text":"手元でwrapper function定義して、それ経由にする、とか?*","ts":"1590558741.303700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5A+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56eb6e3a-a27e-44a3-abe1-6b92007fe36e","type":"message","user":"U8996GYBF","text":"wrapperは考えたんですけど、1回callしないといけない以上どうにもならなくないです・・・？","ts":"1590558836.304100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kejY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03c2663c-e077-430f-9e36-bf29a25f208a","type":"message","user":"U8996GYBF","text":"```if funcName == fooFuncName\n  call fooFunc()\nelseif funcName == barFuncName\n  call barFunc()\nendif```\n的な・・・？","ts":"1590558989.305200","edited":{"user":"U8996GYBF","ts":"1590559033.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"C43"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aa2efd50-5671-4156-a1ac-82c98cd30e75","type":"message","user":"U03C6TEAZ","text":"neovim で partial 使えるならいけそう。","ts":"1590559340.305800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2aP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"07e6097a-3d28-435a-b0cc-27ddf288273e","type":"message","user":"U03C6TEAZ","text":"`function('s:my_wrapper', ['barFunc'])` みたいにして関数定義を\n\n```function! s:my_wrapper(funcName, ...)\n   if a:funcName == 'barFunc'\n   else\n   endif\nendfunction```\nみたいにすれば行ける。","ts":"1590559430.307400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xu4E"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fa7d7f12-93fe-4f24-8c5b-ae68cc0b6c55","type":"message","user":"U8996GYBF","text":"やってみます！","ts":"1590559548.307600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nBFgf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c128d578-e146-430b-a2c0-0c9ceb3f8b60","type":"message","user":"U8996GYBF","text":"ん、burFuncはスクリプト変数？にしないと別関数だから共有できない？","ts":"1590559707.308200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dCZD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02e00835-4d20-4ad2-bae1-c1c1c1a60e27","type":"message","user":"U8996GYBF","text":"```let s:handler = ''\n\nfunction! fzf_preview#ts_runner#fzf_run(params) abort\n  let source = a:params['source']\n  let options = a:params['options']\n  let s:handler = a:params['handler']\n\n  call fzf#run({\n  \\ 'source':  source,\n  \\ 'sink*':   function(['s:handler_wrapper', s:handler]),\n  \\ 'options': options,\n  \\ 'window':  fzf_preview#window#float_or_normal_layout(),\n  \\ })\nendfunction\n\nfunction! s:handler_wrapper(funcName, ...) abort\n  if a:funcName ==# s:handler\n    call function(s:handler)\n  endif\nendfunction```","ts":"1590559805.309900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NYM6/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3f0ba353-2bb1-4fee-93d6-1a289265a353","type":"message","user":"U8996GYBF","text":"ひとまずこんな感じで書いてみました","ts":"1590559812.310300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2sN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6efaa053-d6ec-49c9-a61c-32e9ac684876","type":"message","user":"UAZ33BKV2","text":"そこのcall function(s:handler)もfuncrefが取れないからだめじゃないかな?\n`exec \"call \" . a:funcname` とかにしては?","ts":"1590559908.311500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jn1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b5dc701b-b5e7-4ea1-9b99-a05cf81741e7","type":"message","user":"UAZ33BKV2","text":"というかs:handlerはあまり有用じゃないようにも思ったりするが、なにか意図が?","ts":"1590559933.312000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ax7Nm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"74c27f4e-ee15-4572-b169-b92e0da30643","type":"message","user":"U8996GYBF","text":"Vim script分からなすぎてあたまごちゃごちゃになってるんでちょっと落ち着いて考えてみます、ありがとうございます","ts":"1590560102.312400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3DSv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5612a6c2-54eb-4699-8adf-f42f54e0fa4c","type":"message","user":"U8996GYBF","text":"handlerはcallしたくないんですよね、あくまでfzf実行後にcallbackとして実行結果が入る関数なので","ts":"1590560198.313400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ekzu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fa2c30a6-3706-4531-aee2-a1ac5e0e3b37","type":"message","user":"U8996GYBF","text":"1つの手段としては、プラグイン初期家事にVim scriptから何も実行しないようにハンドラを実行するようにして関数を実体化させる・・・","ts":"1590560333.314400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tHRN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2a5eaf8-9bc2-453c-b32f-1757eae40420","type":"message","user":"U8996GYBF","text":"やりたくない・・・","ts":"1590560336.314600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QSacs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51a5bfb1-a213-42e5-9f3c-c24b8cc1c8bb","type":"message","user":"UAZ33BKV2","text":"でもリモートの処理もたぶんそれwrapperになってる関数だからなあ...\n中身素通しするなら害はないし(ちょっとだけスタックと処理時間食う)","ts":"1590560396.315300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YfJx="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"22f82b30-0b3e-4291-9d4a-d7be9d030ec7","type":"message","user":"U8996GYBF","text":"<@U7JL1UKKL> リモートプラグインのこの辺の挙動について何か分かったりしますか・・・？","ts":"1590560469.315700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"t/yow"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cafff6e0-5a99-484e-90ed-fe275fc61fd7","type":"message","user":"UAZ33BKV2","text":"なんか自分が勘違いをさせてなきゃいいけど...","ts":"1590560507.316100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yk9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5e02bf1c-da68-4b3a-805b-33086defb2f1","type":"message","user":"U8996GYBF","text":"partialならどうにかなるっていうのがよく分かっていないんですが、functionの第二引数で `['funcName']` したら関数が評価されるみたいな感じですか？","ts":"1590560657.318100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Nog"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"CAEC47FB-BD61-4F41-8ACA-834272FA09E1","type":"message","user":"UBQ2H65JQ","text":"s:handlerって具体的にどういう値が入っているんですか？","ts":"1590560668.318300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WpV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b737f19d-0c24-48af-9ef1-cbbc7435d4b7","type":"message","user":"U8996GYBF","text":"stringですね","ts":"1590560716.318800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jwl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ad9bfbb0-a308-47b7-8e51-afd0ce75255c","type":"message","user":"U8996GYBF","text":"registerFunctionしたときに使った関数名","ts":"1590560728.319500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=SDCH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"DC7CE8D8-9014-4F3D-BE81-732A5C2AD38B","type":"message","user":"UBQ2H65JQ","text":"その関数はどこに定義されているんです？","ts":"1590560750.320400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QJu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"feb6ef5a-089f-405d-92b8-fe928669a0af","type":"message","user":"U8996GYBF","text":"TSです","ts":"1590560758.320800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ol7v"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cf69f8b4-2489-42b4-a3f9-8ede2e772641","type":"message","user":"U8996GYBF","text":"```export const registerHandler = () =&gt; {\n  plugin.registerFunction(\n    \"FzfPreviewHandleResource\",\n    (args: Array&lt;VimValue&gt;) =&gt; {\n      console.log(args)\n    },\n    { sync: true }\n  )\n}```","ts":"1590560770.321200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=9=9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6fba6534-901c-4598-8d9e-fb1847b0f6d5","type":"message","user":"U8996GYBF","text":"具体的にはこういうコードがあって、Neovimからcallすることはできます","ts":"1590560785.321800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XXu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c5107dbf-371d-4bec-8650-1d895ca0b000","type":"message","user":"UAZ33BKV2","text":"partialは部分関数で、引数をあとから追加できる、みたいなもんです\nで、もらった文字列を関数呼び出しにおきかえる(if/elseするか、exec \"call \". hogeするか)すれば、funcrefがとれない関数をcallbackで呼べるんじゃない、がmattnさん+自分がすすめてる理由","ts":"1590560787.322000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PYu0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d795f367-7a7c-48e3-a86d-2069ca1f05cb","type":"message","user":"U8996GYBF","text":"高階関数的な？\nちょっと違うかな","ts":"1590560819.322500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"usD7a"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6076647c-ad72-4558-b421-9d93c8185131","type":"message","user":"UAZ33BKV2","text":"あ、callbackに登録するwrapperがpartialだと、追加引数を登録箇所に入れれる、というのが抜けてた","ts":"1590560834.322900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"m4AX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"443ba0fd-eea8-4445-961e-1e1383495a8f","type":"message","user":"UAZ33BKV2","text":"疑似高階というか、間接呼び出しというか","ts":"1590560849.323300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IBZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a586a6c4-c54c-4a9c-bca1-e879746bac4c","type":"message","user":"U8996GYBF","text":"mattnさんが書いてるここがよく分かっていなくて、funcNameにはFuncRefが入っている・・・？\n```function! s:my_wrapper(funcName, ...)\n   if a:funcName == 'barFunc'\n   else\n   endif\nendfunction```","ts":"1590560994.324100","edited":{"user":"U8996GYBF","ts":"1590561074.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ndJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0fe14e93-108e-4e9e-ac44-cbc1f6794a4b","type":"message","user":"U7JL1UKKL","text":"リモートプラグインとFuncrefはそもそも相性が悪い","ts":"1590561007.324600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q=+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d4ada8aa-7df6-4f68-b9bf-f90dfaef26c3","type":"message","user":"U7JL1UKKL","text":"例えばFuncrefはリモートプラグインから直接呼べない","ts":"1590561027.325200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DMMPW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"22c05d37-4cf7-4269-8bc0-15f138b7c213","type":"message","user":"U8996GYBF","text":"ですよね、それはTSの型見て察してはいたんですけど","ts":"1590561043.326100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vFOAT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0584cd19-7039-4ab8-9438-929e7a3c6656","type":"message","user":"U7JL1UKKL","text":"リモートプラグインの中でFuncrefを扱うのは推奨しないのでラッパー関数作るべきですよ","ts":"1590561060.327000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RRZcM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f0b82992-fe3c-48cc-a441-fadd82c34949","type":"message","user":"U8R597E9H","text":"特殊な値に変換して引数チェックして id 再現するとかしか思いつかないですね。\n`{ ______type: 'funcref', id: 0 }` みたいな。。。（僕もそもそも funcref 経由するのをやめたほうがいい気がします。）","ts":"1590561082.327700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mQm1x"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25e74a4d-243d-488f-ba88-29cf32c03c2a","type":"message","user":"U8996GYBF","text":"fzf#runがfuncrefをcallbackに受け取るんですよね・・・","ts":"1590561110.328900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jcC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6FCEE36C-C8C7-48B0-9BF4-696AD864229A","type":"message","user":"UBQ2H65JQ","text":"あっ、call call(function(s:handler), [])じゃないといけない気がする","ts":"1590561128.329500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TtmM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9874f47f-00f9-40b7-969c-150c40c31fd6","type":"message","user":"U7JL1UKKL","text":"だからその場合は","ts":"1590561138.329800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vuFt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e721248e-e974-4b15-b563-a2f9532cc060","type":"message","user":"U7JL1UKKL","text":"ラッパー関数を登録して、ラッパー関数のなかでリモートプラグインの関数を呼ぶようにします","ts":"1590561157.330500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FWifP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8607155d-5d81-49e9-8147-acb856502abc","type":"message","user":"U8996GYBF","text":"なんか凄まじい人たちに教えて貰ってる気がする、めっちゃありがたい\nありがとうございます・・・","ts":"1590561175.331300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZOZb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03b02a61-7b08-4cef-8dc2-6b043dd2c0c0","type":"message","user":"U7JL1UKKL","text":"リモートプラグインは特種なので直接扱わないのがポイント","ts":"1590561175.331400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UerB1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2ef12a1-a983-4b87-b619-e90946afb5ff","type":"message","user":"U7JL1UKKL","text":"リモートプラグインの初期化周りのタイミング制御もなかなか難しい","ts":"1590561217.332600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"60A5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a7af1a99-026b-4448-8931-e2c16e785c3a","type":"message","user":"U8996GYBF","text":"callbackにwrapper関数を登録して、そこ経由でリモートプラグインの関数呼ぶってことですよね","ts":"1590561226.333100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DyZz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0ad06424-3303-4acc-81c4-f8d1e458e962","type":"message","user":"U7JL1UKKL","text":"別のプロセスで動くので思わぬ挙動になることがある","ts":"1590561232.333400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zAah"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b38282ab-a455-489e-b3fc-66af1610e8db","type":"message","user":"U7JL1UKKL","text":"そうです","ts":"1590561251.334200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"91mZI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d0f438ca-7eb8-4145-b911-2d011e230d5b","type":"message","user":"U8996GYBF","text":"面倒くさいのがfzf#runの挙動で、どのリモートプラグインの関数に紐付けるべきか多分callback側に返ってこないんですよね","ts":"1590561276.334800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/CS/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5564e70e-cb05-4642-bab7-b8a09db137b1","type":"message","user":"U8996GYBF","text":"それはスクリプト変数に持たせておいて、callback変数でその関数名を参照するとかで回避になるのかな","ts":"1590561297.335300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"o8Y2q"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec229761-37f1-4730-b750-3025e5a045f0","type":"message","user":"U8996GYBF","text":"いや、でもcallするタイミングで文字列をfunctionに変換するのは絶対必須だからfunction関数を使わないと不可能・・・？","ts":"1590561492.336000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Oy37"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0b254fde-175c-4c8e-835b-0d32d8c31ef3","type":"message","user":"U8996GYBF","text":"`call function(s:handler)` の `function()` で落ちる気がする、ちょっとやってみます","ts":"1590561526.336700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iSrj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02B6C2FA-AE6E-4465-AE57-475E38E5B126","type":"message","user":"UBQ2H65JQ","text":"call call(function(s:handler), [])にしないと関数呼ばれないですよ。もしくはcall function(s:handler)()","ts":"1590561596.337400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"COMsM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5bfdb66d-4cec-4537-8889-c0774ca8dc24","type":"message","user":"U8996GYBF","text":"あ、動いた・・・","ts":"1590561655.337600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"P4K"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"274e2b5d-8d14-4577-bc1b-ca08c7ee50fa","type":"message","user":"U8996GYBF","text":"理由が分からない、なんでだ・・・？","ts":"1590561663.337900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r9M"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6bbe2e5d-099d-487a-807f-d052b5d7e229","type":"message","user":"U8996GYBF","text":"```function! fzf_preview#ts_runner#fzf_run(params) abort\n  let source = a:params['source']\n  let options = a:params['options']\n  let s:handler = a:params['handler']\n\n  call fzf#run({\n  \\ 'source':  source,\n  \\ 'sink*':   function('s:handler_wrapper'),\n  \\ 'options': options,\n  \\ 'window':  fzf_preview#window#float_or_normal_layout(),\n  \\ })\nendfunction\n\nfunction! s:handler_wrapper(lines) abort\n  let Handler = function(s:handler)\n  call Handler(a:lines)\nendfunction```\nは通って、\n```function! fzf_preview#ts_runner#fzf_run(params) abort\n  let source = a:params['source']\n  let options = a:params['options']\n  let s:handler = a:params['handler']\n\n  call fzf#run({\n  \\ 'source':  source,\n  \\ 'sink*':   function('s:handler'),\n  \\ 'options': options,\n  \\ 'window':  fzf_preview#window#float_or_normal_layout(),\n  \\ })\nendfunction```\nは落ちる明確な差ってどこですか・・・？","ts":"1590561778.338500","edited":{"user":"U8996GYBF","ts":"1590561814.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9b+D"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ccecaa49-d4c1-4376-bc29-c571f13a4201","type":"message","user":"UAZ33BKV2","text":"`s:handler_wrapper` は funcrefが取れる、`s:handler` はそもそもfunctionじゃないと思うのでfuncref取れないような","ts":"1590561835.339400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NPP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d4818b97-7ab0-476d-b789-26bf8e2b6214","type":"message","user":"U8996GYBF","text":"あ、いやダメだ\nhandler_wrapperの中のfunctionでエラーを吐いちゃった","ts":"1590561952.340200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"33NZE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f1371d4d-974e-43d9-97eb-8e6f5b4ef0d0","type":"message","user":"U8996GYBF","text":"エラーが発生するタイミングが違うだけでした、すみません","ts":"1590561963.340600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VmS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"302669c5-c640-4580-a3f5-f371988ff716","type":"message","user":"U8R597E9H","text":"後者は `function('s:handler')` という感じで文字列として `s:handler` をつかってますが、前者は `function(s:handler)` として `s:handler` を変数として使ってそうです。","ts":"1590562021.341800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aPfHR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"15cf8605-4039-4256-b761-52a7ac3e7240","type":"message","user":"U8996GYBF","text":"あー、だから通ってるのか\nなるほど","ts":"1590562080.342300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DDdPL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dff2052a-065c-4ddb-96c0-65ba2aab12aa","type":"message","user":"U8996GYBF","text":"うーん・・・困った・・・","ts":"1590562090.342600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y=qoc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"63cb0f48-283f-4417-b6aa-f55728bf1959","type":"message","user":"U8996GYBF","text":"あとはpartialっての試したいですね、多分まだちゃんと試せてない","ts":"1590562131.343300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AjIM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"17b5c6cf-571d-4332-9fb9-92149a463c29","type":"message","user":"U8R597E9H","text":"前者が期待どおりに動くのであれば、後者のやりかたで `'s:handler' -&gt; s:handler` にしたら動くという話かと思っていました。","ts":"1590562151.343700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jHtP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"80ee0de0-e0c3-460e-9e95-e50ceba68b6d","type":"message","user":"U8996GYBF","text":"ログ見てたんですが、 <@UAZ33BKV2> さんが書いてる  `exec 'call ' . s:handler . '(a:lines)'` で強引に通せるかも","ts":"1590562314.344300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sn0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f88ab8a1-5462-4ff2-99d6-7568232aec08","type":"message","user":"UAZ33BKV2","text":"こんな風になると予想してる\n```function! fzf_preview#ts_runner#fzf_run(params) abort\n  let source = a:params['source']\n  let options = a:params['options']\n\n  call fzf#run({\n  \\ 'source':  source,\n  \\ 'sink*':   function('s:handler_wrapper',[a:params['handler']]),\n  \\ 'options': options,\n  \\ 'window':  fzf_preview#window#float_or_normal_layout(),\n  \\ })\nendfunction\n\nfunction! s:handler_wrapper(handler, lines) abort\n  call call(a:handler, [a:lines])  \nendfunction```","ts":"1590562349.345000","edited":{"user":"UAZ33BKV2","ts":"1590562867.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"888"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7ab2b08c-c50c-4462-825f-d4d38a155ef8","type":"message","user":"UAZ33BKV2","text":"partialと引数適用がいまいち理解不足で変なこと言ったので修正されてます","ts":"1590562399.346200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2UlCS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1ADFBB56-B2F9-4C36-8EE7-4B899E6805A2","type":"message","user":"UBQ2H65JQ","text":"call call(a:funcname, [lines])","ts":"1590562429.347400","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D53"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"df0daa9a-c416-4bf7-a1e4-a5be70296eb6","type":"message","user":"U8996GYBF","text":"前者も後者も勘違いでダメ感ありました、残念・・・","ts":"1590562434.347600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"A5du"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"972a85a1-b6a1-4614-880f-aeb66a7e6170","type":"message","user":"UAZ33BKV2","text":"まだちょっと変でした","ts":"1590562450.347900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bu0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"452b6307-c855-4307-bad8-2fdbfcf78f35","type":"message","user":"UAZ33BKV2","text":"あれ、call()の関数は文字列でいいんでしたっけ?","ts":"1590562471.348300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yjZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0bc00dcd-858d-467b-ae9b-6c568a34ac86","type":"message","user":"UAZ33BKV2","text":"あ、行けるな","ts":"1590562480.348600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EJV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"23dc339f-4b32-4fae-baee-ca260294961c","type":"message","user":"UAZ33BKV2","text":"なおしてみた","ts":"1590562509.348900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+Bu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ca6cb49e-cb82-4dfb-9daf-43ac3c8892ea","type":"message","user":"U8996GYBF","text":"funcnameってどこから渡ってくるんですかね？partialした場合の第一引数に勝手になる感じです？","ts":"1590562559.349400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oOI=C"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"10da594d-db3b-4a27-8f04-c84edeedd154","type":"message","user":"U8R597E9H","text":"```function s:sum(a, b)\n  return a:a + a:b\nendfunction\n\nlet l:plus_one = function('s:sum', [1])\nechomsg l:plus_one(2) \" -&gt; 3```\nこういうことです。","ts":"1590562643.350600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"U83"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1139da68-2f28-4bc3-a55f-94f6317960f9","type":"message","user":"U8996GYBF","text":"完全に理解した、なるほど","ts":"1590562723.350900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/jh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2278ece1-9e78-4b80-8c13-2f9c7c5dccc1","type":"message","user":"U8996GYBF","text":"`s:handler_wrapper` に先にfuncnameを渡したwrapperを経由してcallするんですね、結果第二引数でlinesを受け取れると","ts":"1590562774.351700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cW0k"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5cd3915a-561d-4475-b534-1cbe8192b696","type":"message","user":"U8996GYBF","text":"高階関数っぽい、便利","ts":"1590562786.351900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ill"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
