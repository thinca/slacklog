[{"client_msg_id":"4bc46996-7580-49c5-a7a0-20e212a08782","type":"message","user":"U78UYGX8W","text":"すみません質問なのですが、以下のようなGoのコードを書いて保存すると、`package` の行が削除されてしまうようでして、何か回避策があるのかお伺いしたいのです。\n```package main\n\nfunc main() {\n\tfmt.Println(\"test\")\n}```\n↑このようなコードを作成して保存すると、↓のようなコードに整形されます。\n```\nimport \"fmt\"\n\nfunc main() {\n\tfmt.Println(\"test\")\n}```\n私のほうでも少しだけ調べてみたのですが、<https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L140> をコメントアウトすると `package` も削除されず `import` も挿入されました。","ts":"1593711231.177500","attachments":[{"fallback":"GitHub: mattn/vim-goimports","id":1,"title":"mattn/vim-goimports","title_link":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L140","text":"Vim plugin for Minimalist Gopher. Contribute to mattn/vim-goimports development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L140","original_url":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L140"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Bg="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0636b62b-8d97-4eb6-9ccf-d1b76473f514","type":"message","user":"U03C71D7H","text":"ここ私が書いたところだな…明日見てみます","ts":"1593712625.177900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SnS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1143b8e1-b95d-4419-a523-b6c2fde75e89","type":"message","user":"U78UYGX8W","text":"すみません、お手数をおかけします。fileformat は dos で fileencode は utf-8 で編集しています。\nL140 ではなく L143 をコメントアウトしても問題なく動作するようでした。\n<https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L143>","ts":"1593715197.179700","attachments":[{"fallback":"GitHub: mattn/vim-goimports","id":1,"title":"mattn/vim-goimports","title_link":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L143","text":"Vim plugin for Minimalist Gopher. Contribute to mattn/vim-goimports development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L143","original_url":"https://github.com/mattn/vim-goimports/blob/master/autoload/goimports.vim#L143"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ii5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e77d5df1-c3cb-49be-9d5e-3ce5f3eb4d65","type":"message","user":"U06BRP8VD","text":"ん go のコードって ff=unix にするもんちゃうの?","ts":"1593739890.180100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mHLB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e82a8d54-68ed-4f83-bba8-1f56ef5213d3","type":"message","user":"U06BRP8VD","text":"これでpackageが消えるって話はそれはそれで気持ち悪いな。","ts":"1593739999.180600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AiQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4812e0eb-86b2-4960-b980-2b4ddb2d4e6e","type":"message","user":"U06BRP8VD","text":"ff=dos にすると確かに消えますな。普段 go は ff=unix だからまったく気が付かんかった。","ts":"1593740061.181100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QBUT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b3e93aee-0c83-4c98-a330-c5c3fe620f15","type":"message","user":"U06BRP8VD","text":"goimprots に \\r 付きで入力がわたって、そのせいで diff がファイル全体を入れ替えるものになって、そのdiffをただしく解釈できないみたい。","ts":"1593741096.184000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TicJE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cf8337f8-63ea-4dda-816f-9a6e7fd30dba","type":"message","user":"U06BRP8VD","text":"一番良いのは ff=unix にしてもらうことだなぁ。","ts":"1593741109.184400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sQb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6ebd1b37-edb0-4f25-91eb-bffc8ccdc385","type":"message","user":"U03C71D7H","text":"あーそうか。goimports は改行コードを unix に変換するのか。だからファイル全体が差分になる","ts":"1593741261.185200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D9s"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8b9dbcc0-9c20-40fc-8f38-a00ac58fa15b","type":"message","user":"U06BRP8VD","text":"そそ","ts":"1593741267.185500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/vz/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50e58036-a901-4319-93ae-9fb27d88923f","type":"message","user":"U06BRP8VD","text":"で、それを正しく扱えてない。まぁそれはそれで問題なんだけど…","ts":"1593741279.185900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Upa1V"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"326c9782-7f94-431a-b7b0-79ea13804b0e","type":"message","user":"U06BRP8VD","text":"ただそこ頑張っても仕方ないかなって。","ts":"1593741291.186300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3PliA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f092ac48-cf47-4a29-9f2b-8d773b2af80b","type":"message","user":"U03C71D7H","text":"どうせ unix に変換されるし unix で書いてもらう方がいい気はします","ts":"1593741313.187100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aexix"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aafd7ce7-b0d8-4d08-839e-060409ccbfdd","type":"message","user":"U06BRP8VD","text":"Goはソースコードの改行コードをLF指定してなかったかな…","ts":"1593741321.187400","edited":{"user":"U06BRP8VD","ts":"1593741336.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AcfY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f79d5a01-8f46-403e-bcdf-8eea3feab72c","type":"message","user":"U03C71D7H","text":"dos だったら `\"¥r\"` 足すってプラグイン側のコードも削っちゃっていい気はする","ts":"1593741341.187900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6BsXL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aa67f494-bbb1-4024-a8b6-f447feb1e975","type":"message","user":"U06BRP8VD","text":"プラグインとしてはそれはそうなんですが、そもそも ff=dos で運用しているのを矯正することも考えたほうが良いかなって。","ts":"1593741430.188600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gDHHp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3a21d19e-16ac-4e0d-9bba-cf3a5b41c3ee","type":"message","user":"U06BRP8VD","text":"とりあえずプラグインにはPR作っときますよ。","ts":"1593741435.188800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4Xfz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d0f96b4-0f89-4c01-b9fa-8d8ff6a2c827","type":"message","user":"U06BRP8VD","text":"done (cc <@U03C6TEAZ>\n\n<https://github.com/mattn/vim-goimports/pull/10>","ts":"1593741779.189100","attachments":[{"fallback":"GitHub: don't append CRs for goimports by koron · Pull Request #10 · mattn/vim-goimports","id":1,"title":"don't append CRs for goimports by koron · Pull Request #10 · mattn/vim-goimports","title_link":"https://github.com/mattn/vim-goimports/pull/10","text":"goimports に渡すソースが CRLF を行末記号にしていると goimports はファイル全体の行末を LF に置き換える diff を吐く。 vim-goimports はそのdiff を正しく解釈できずに 行頭の package main などを消してしまう。 本来goのファイルは ff=unix でソースを書くべきだが プラグインとしてはとりあえず CR を付けないようにする...","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-goimports/pull/10","original_url":"https://github.com/mattn/vim-goimports/pull/10"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gu1sN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8e67bd0c-4f7a-4965-a329-7a333c35684e","type":"message","user":"U06BRP8VD","text":"ああ… <#CGABGC8LA|lang-go> でやる話題だった。申し訳ありません。\nこの話題に続きが必要ならば以後は向こうに行きましょう :cat-dogeza-mike:\n(cc <@U78UYGX8W>, <@U03C71D7H> <@U03C6TEAZ>)","ts":"1593742138.190500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BZ6w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8977aa10-d016-4101-8471-717fd969d80c","type":"message","user":"U03C6TEAZ","text":"マージボタンを押す人としてやってきました。","ts":"1593742393.190900","team":"T03C4RC8V","reactions":[{"name":"grin","count":1,"users":["U06BRP8VD"]},{"name":"goodpoem","count":4,"users":["U06BRP8VD","U7JL1UKKL","UEACRCY0Z","U013APKV51B"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y8YE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c97d0495-f18f-4e80-b53d-143e9e3fd36c","type":"message","user":"U78UYGX8W","text":"対応ありがとうございました。最新のvim-goimports を使うと問題が解決していることを確認しました。また、ff=unixでこれからは書いていこうと思います。","ts":"1593743673.192200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ssNJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d6cd0e97-2d32-42a2-952f-4d1555f58922","type":"message","user":"U06BRP8VD","text":"~/.vim/ftplugin/go.vim に setlocal ff=unix 書いとくと良いですよ。","ts":"1593743765.192900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dQU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8d0b67a1-3ffe-494b-928c-783215cb4963","type":"message","user":"U78UYGX8W","text":"ありがとうございます！今質問しようとしていたところに先回りで回答が返ってきて心を読まれた感じがしました(笑)","ts":"1593743815.193600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DBN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","text":"<https://teratail.com/questions/274777?rss=all|vim 指定ファイル内容の単語を補完で表示する>\nやりたいこと\n大量の項目があるプロパティファイルが任意のパスに(複数)あるとします。\n/ 任意のディレクトリ\nSample1.Properrty\nSample2.Properrty\nSample3.Properrty\n・\n・\n・  \nSample1.Properrty\n\nABCD=00001\nEFGH=12345\nIJKL=12345\n・\n・　\n・\nVimで補完によってこのプロパティファイルのキー(ABCD、EFGH...)を補完機能によって表示したいと思っています。  \nディレクトリ指定だと、保管表示させる項目が多くなってしまいますので、できれば個別にファイルを指定することができればよいと思っています。\n(Sample1.Propertyの...\n\n<https://teratail.com/questions/274777?rss=all|続きを見る>","ts":"1593750076.193800","attachments":[{"fallback":"teratail[テラテイル]: vim 指定ファイル内容の単語を補完で表示する｜teratail","id":1,"title":"vim 指定ファイル内容の単語を補完で表示する｜teratail","title_link":"https://teratail.com/questions/274777?rss=all","text":"やりたいこと大量の項目があるプロパティファイルが任意のパスに(複数)あるとします。/ 任意のディレクトリSample1.ProperrtySample2.ProperrtySample3.Properrty・・・ Sample1.ProperrtyABCD=00001EFGH=12345","thumb_url":"https://teratail.com/img/imgFacebookShare.png","blocks":null,"service_name":"teratail[テラテイル]","service_icon":"https://teratail.com/favicon.ico","thumb_width":1200,"thumb_height":630,"from_url":"https://teratail.com/questions/274777?rss=all","original_url":"https://teratail.com/questions/274777?rss=all"}],"edited":{"user":"BPV6T0C1J","ts":"1593750078.000000"},"subtype":"bot_message","bot_id":"BPV6T0C1J","username":"[Vim]の新着質問一覧｜teratail（テラテイル）","icons":{"image_48":"https://s3-us-west-2.amazonaws.com/slack-files2/bot_icons/2019-10-29/814941997319_48.png"},"replace_original":false,"delete_original":false,"blocks":null},{"type":"message","user":"U016GRZN0GJ","text":"<@U016GRZN0GJ> has joined the channel","ts":"1593755221.194300","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null}]
