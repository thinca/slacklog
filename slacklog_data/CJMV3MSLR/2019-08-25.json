[{"client_msg_id":"c3e44b1e-7b52-487e-998a-db8a5122fcec","type":"message","user":"UKKJR571V","text":"遅レスですがjvimではバイナリが共通で-nwオプションでコンソールモードで起動するようになっていました。入口がcui/gui共にmain()なのでguiモードでも一旦コンソールが開いてその後FreeConsole()していたはずです。","ts":"1566699671.477600","thread_ts":"1566279254.199400","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":null,"root":{"client_msg_id":"a7d80e93-52e7-4a39-beaa-e316bfe7bd0a","type":"message","user":"U06BRP8VD","text":"あれ? コマンドライン版ってあったっけ? 全部 gvim 相当だとおもってた…","ts":"1566279254.199400","thread_ts":"1566279254.199400","reply_count":5,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null}},{"client_msg_id":"49114e2d-a2b2-453c-84bc-e03191f7dcf2","type":"message","user":"U06BRP8VD","text":"なるほどー","ts":"1566699768.478000","thread_ts":"1566279254.199400","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"16324a9c-1416-472b-bd68-a09f1b20f36e","type":"message","user":"UKKJR571V","text":"ちなみにネタくらいにしかなりませんがjvimの成れの果てのひとつです^^;\n<http://wwwd.pikara.ne.jp/nb1839/uvw/>\nWinGUI版のみで、さすがにコンソール/BDF は切っちゃってるんですけど、罫線モードは個人的趣味でガチで残していますｗ","ts":"1566706604.478400","thread_ts":"1566279254.199400","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","reactions":[{"name":"+1","count":2,"users":["U06BRP8VD","U03C6TEAZ"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d80eebe3-dc35-4e79-b539-bdf9d414b0fb","type":"message","user":"U06BRP8VD","text":"すごいw","ts":"1566707706.478700","thread_ts":"1566279254.199400","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"342ef446-cd1f-4ac7-abeb-5110e296d274","type":"message","user":"U03C6TEAZ","text":"お、かすかな記憶当たってたw","ts":"1566709462.479000","thread_ts":"1566279254.199400","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U7HFY4HFY","text":"<@U7HFY4HFY> has joined the channel","ts":"1566739618.479300","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"7afda14a-7b3c-46ad-a8d9-55d7feb7b821","type":"message","user":"U7HFY4HFY","text":"えくすきゅずます\n関数が文字列として受け取ったコマンドをグローバルスコープで実行することってできませんか？","ts":"1566739959.481100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dc720d9d-e4d3-4bac-a388-06ea29490660","type":"message","user":"U0M7GCBPD","text":"グローバルスコープ → `str` って変数が含まれてたら g:str として実行するみたいな感じですかね？","ts":"1566740113.483600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3e3e0b8f-ecf0-4646-ab57-0eb9eb1f32cd","type":"message","user":"U7HFY4HFY","text":"そうです","ts":"1566740143.484500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8724bc30-cb9f-4745-8cbb-743b205de3db","type":"message","user":"U7HFY4HFY","text":"a: や l: にアクセスできないのが理想ですが、それが一番困る感じです","ts":"1566740199.486600","edited":{"user":"U7HFY4HFY","ts":"1566740224.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1dcf0846-0406-46b1-9193-9d30818d6815","type":"message","user":"U0M7GCBPD","text":"あー Ex コマンドのために関数作って呼び出す形にしたけど :execute すると↑になっちゃうみたいな感じなのかな\nだとしたら `:command -nargs=+ MyExecute execute &lt;args&gt;` みたいな感じでどうでしょう","ts":"1566740227.487200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9077cad-d9e2-4799-8193-1568fac7c96b","type":"message","user":"U0M7GCBPD","text":"具体的にどんな Ex コマンドを定義したくて、どんな場合に困るか教えてもらえると具体的なアドバイスできるかもしれません","ts":"1566740331.488800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4e3dfb8d-430e-4cff-a439-9aa05fe705fd","type":"message","user":"U7HFY4HFY","text":"わりとシンプルに、ユーザーが入力した文字列を関数内のあるタイミングで実行しようとしてるところです","ts":"1566740409.489600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1f00d098-8f5b-40dc-9106-2700984034e3","type":"message","user":"U0M7GCBPD","text":"ユーザーが入力っていうのは Ex コマンドの引数に渡すって事で合ってます？","ts":"1566740460.490400","edited":{"user":"U0M7GCBPD","ts":"1566740470.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec99deb0-84e6-494d-a782-f74a0a5f119a","type":"message","user":"U7HFY4HFY","text":"prompt-bufferで入力した物です","ts":"1566740523.492400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6d543209-bcd8-4679-880a-0a3344bcd08b","type":"message","user":"U0M7GCBPD","text":"おぉ… prompt-buffer 使ってる人いたのか…\n割と便利そうなのに使ってないの疑問に思ってたやつだ","ts":"1566740587.493800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9d094ea-0981-454e-9659-86d993d291b4","type":"message","user":"U0M7GCBPD","text":"prompt-buffer どんなだったか詳しく思い出せないので一般的な Ex コマンドから関数を呼び出す例で言うと\n↑みたいに `&lt;args&gt;` を使うと引数の時点で式が評価されるので、関数に渡る前に評価されます `call s:func(&lt;args&gt;)`","ts":"1566740683.495500","edited":{"user":"U0M7GCBPD","ts":"1566740702.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"41dbadb8-9a44-44a9-aa9c-8b48eee69821","type":"message","user":"U7HFY4HFY","text":"prompt-bufferはバッファ内でEnter押すと入力行の文字列を引数にしてコールバック関数が呼ばれるやつなので、 `&lt;args&gt;` 使えないかもです","ts":"1566740842.497300","edited":{"user":"U7HFY4HFY","ts":"1566740855.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"71b9d8ac-2e48-4b06-ba77-b3ab298e132b","type":"message","user":"U0M7GCBPD","text":"なるほど\nvimshell の代替作れそうとか思ってたやつか… かなり忘れてる…","ts":"1566741499.498000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"31a670f5-ada0-41e0-89fe-4a23e25c7572","type":"message","user":"U0M7GCBPD","text":":h prompt_setcallback()","ts":"1566741616.499100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U894RTUJY","text":"```\nprompt_setcallback({buf}, {expr})                       *prompt_setcallback()*\n                バッファ {buf} のプロンプトコールバックを {expr} に設定する。\n                {expr} が空文字列の場合、コールバックは取り除かれる。これは\n                {buf} の 'buftype' が \"prompt\" に設定されている場合のみ有効で\n                ある。\n \n                このコールバックは Enter を押したときに呼び出される。カレント\n                バッファは必ずプロンプトバッファである。コールバックの呼び出し\n                の前に次のプロンプト用の新しい行が追加されるので、コールバック\n                が呼び出されたプロンプトは最後から 2 番目の行になる。\n                コールバックがバッファにテキストを追加する場合、最後の行は現在\n                のプロンプトであるため、その上に追加しなければならない。これは\n                非同期に行われる可能性がある。\n                コールバックは、プロンプトに入力されたテキストを唯一の引数とし\n                て呼び出される。ユーザーが Enter のみをタイプした場合は空文字\n                となる。\n                例:  \n                   call prompt_setcallback(bufnr(''), function('s:TextEntered'))\n                   func s:TextEntered(text)\n                     if a:text == 'exit' || a:text == 'quit'\n                       stopinsert\n                       close\n                     else\n                       call append(line('$') - 1, 'Entered: \"' . a:text . '\"')\n                       \" Reset 'modified' to allow the buffer to be closed.\n                       set nomodified\n                     endif\n                   endfunc\n```","ts":"1566741616.499200","bot_id":"B894RTUCU","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"11427c77-9edc-49f6-be38-1946af51d350","type":"message","user":"U0M7GCBPD","text":"これかー","ts":"1566741634.499500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fc4d8944-c133-483e-b6d2-5ae5c1b5fba9","type":"message","user":"U0M7GCBPD","text":"聞く限りだとなかなか厳しそうですが、できる範囲で困ったケースをもうちょっと具体的に教えてもらえると解決策が何かあるかもです。\nVim script で実行スコープを変える機能とかはないので。\nhack 的なやり方だと `writefile()` で .vim ファイルに書き出して `:source` する、とかはありそう","ts":"1566741764.001800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"80773d06-d35c-4fa1-9a65-ce499764f9a8","type":"message","user":"U7HFY4HFY","text":"自分も最近prompt-buffer知ったので試しに使ってみてるぐらいなんですが、","ts":"1566741853.002500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8af4b82f-172e-4ac9-885d-ee5f923632cb","type":"message","user":"U7HFY4HFY","ts":"1566741914.002800","files":[{"id":"FMPH68XHT","created":1566741896,"timestamp":1566741896,"name":"ivi.gif","title":"ivi.gif","mimetype":"image/gif","image_exif_rotation":1,"filetype":"gif","pretty_type":"GIF","user":"U7HFY4HFY","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":86573,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FMPH68XHT/ivi.gif","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FMPH68XHT/download/ivi.gif","original_h":459,"original_w":658,"thumb_64":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_64.png","thumb_80":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_80.png","thumb_160":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_160.png","thumb_360":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_360.png","thumb_360_gif":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_360.gif","thumb_360_w":360,"thumb_360_h":251,"thumb_480":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_480.png","thumb_480_w":480,"thumb_480_h":335,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U7HFY4HFY/FMPH68XHT/ivi.gif","permalink_public":"https://slack-files.com/T03C4RC8V-FMPH68XHT-8c6e0277b0","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"deanimate_gif":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_deanimate_gif.png","display_as_bot":false,"has_rich_preview":false,"thumb_480_gif":"https://files.slack.com/files-tmb/T03C4RC8V-FMPH68XHT-3daf0447d8/ivi_480.gif","username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"47e8f198-43a1-4144-90eb-cddea42fb1e4","type":"message","user":"U7HFY4HFY","text":"今こういうものを作ってみてるところです","ts":"1566741918.003100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"952711a7-d591-4427-991d-ab54a1564c4e","type":"message","user":"U0M7GCBPD","text":"なるほど\ncmdwin 強化版かな","ts":"1566741990.003700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9f9363c-919f-40cc-a1d7-4b287ab48630","type":"message","user":"U7HFY4HFY","text":"そです\nここで変数名が `g:`つけないとグローバルにならないのなんとかならないのかなあと","ts":"1566742028.004400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"293959b1-11d5-4cd1-b878-03ec605de036","type":"message","user":"U0M7GCBPD","text":"うーん難しそう","ts":"1566742132.004600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dbed4127-244a-4f7c-91f3-34c7081a91e6","type":"message","user":"U0M7GCBPD","text":"自分が思いつくのは↑の `writefile()` のやつぐらいですかね… 他の人の回答を待とう…","ts":"1566742167.005300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"422dbc3b-01c7-4355-8539-267df1a4398e","type":"message","user":"U7HFY4HFY","text":"いえありがとうございます\nやっぱり難しいんですね……","ts":"1566742328.006000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d37bbd2c-d244-4497-9bde-da573814c38e","type":"message","user":"U0M7GCBPD","text":"まぁ一般的に言語で実行スコープを変える機能とかそうそう無いと思いますけどね…\nやるなら自分のみたいな hack 的な何かになるかなぁと","ts":"1566742412.007100","team":"T03C4RC8V","reactions":[{"name":"tashikani","count":1,"users":["U7HFY4HFY"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"45dcb78e-07e0-4016-9dfb-4d5c25587cf8","type":"message","user":"UDDCM376D","text":"`prompt-buffer` 便利そう","ts":"1566743068.007500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"48bac92b-be88-4384-93c6-59f23ad9b5da","type":"message","user":"UDDCM376D","text":"今度触ってみよ","ts":"1566743077.007700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
