[{"type":"message","user":"USWTUDPG8","text":"<@USWTUDPG8> has joined the channel","ts":"1579603006.122600","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"0b0007a9-b0c3-4018-8790-669cbf036733","type":"message","user":"U03C71D7H","text":"Docker 詳しい人っていたりしませんか?\nずっと前から困りつつ放置している問題があって、 `docker run -it thinca/vim:latest` で起動する Docker 内の Vim なんですが、どうも Vim 起動後に Docker 側が端末の何かを変えてしまうらしく、intro が表示されなかったり `:version` がうまく表示されなかったり(1行に重なって表示されてしまう)します。 `:set term&amp;` で term を再設定(再検出?)すると直るんですが、この現象を回避する方法について何か知ってる人がいたら教えてください。","ts":"1579572502.065000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IsDhI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"34905567-24d6-4fb6-b888-a0950fbb1214","type":"message","user":"UAZ33BKV2","text":"<https://inokara.hateblo.jp/entry/2018/12/19/235758>\nこーいうの関係するのかなあ...、Docker :wakaranai:","ts":"1579572763.065500","attachments":[{"fallback":"ようへいの日々精進XP: Docker や docker-compose で TTY を有効にした場合, 標準出力の改行コードが CR+LF になる件 - ようへいの日々精進XP","id":1,"title":"Docker や docker-compose で TTY を有効にした場合, 標準出力の改行コードが CR+LF になる件 - ようへいの日々精進XP","title_link":"https://inokara.hateblo.jp/entry/2018/12/19/235758","text":"tl;dr なぜ, こんなことになるのか なぜ, TTY の行末には CRLF が付与されているのか 参考文献 tl;dr ギョームで Docker (docker-compose) を使ったちょっとしたコマンドラインツールを作った時に, 以下のように実行して標準出力をファイルに出力すると, 何故か ^M という改行コード (Carriage Return) が残ってしまってなんでやろうと思って調べたら Docker なんかよりももっといにしへの TTY の話まで掘り下がってしまって, すごく勉強になったのでメモっておきます. docker-compose run foo &gt; foo.txt …","image_url":"https://ogimage.blog.st-hatena.com/6435922169448546579/10257846132687306933/1545232148","blocks":null,"ts":1545231478,"service_name":"ようへいの日々精進XP","service_icon":"https://cdn.image.st-hatena.com/image/apple_touch_icon/dd9c40514aec1ce6ef8cdf1c1adafd88f3ce0e3b/version=1/https%3A%2F%2Fcdn.user.blog.st-hatena.com%2Fcustom_blog_icon%2F86836777%2F1514249113410411","from_url":"https://inokara.hateblo.jp/entry/2018/12/19/235758","original_url":"https://inokara.hateblo.jp/entry/2018/12/19/235758"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r5I"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"545b2e63-df6b-4cfd-8494-30c4f70fe9d3","type":"message","user":"U03C71D7H","text":"Docker の端末なんか怪しい","ts":"1579572810.065900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NIC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2ae00bc-825b-4837-8b68-61fbd3f1f626","type":"message","user":"UK7DT8URY","text":"Docker詳しめだと思ってたけど、一切わからなくてDockerﾅﾆﾓﾜｶﾗﾅｲ状態になっている","ts":"1579572937.066800","team":"T03C4RC8V","reactions":[{"name":"sorena","count":3,"users":["UKHUVMBJR","U8CC7MDCL","UKUSVS5EE"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"At2EN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"34000a91-ffff-4dde-b142-cadb0ea7b267","type":"message","user":"U06BRP8VD","text":"`:set term&amp;` する前のtermの値って何になってます?","ts":"1579573013.067800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cBFVg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5e3ac4aa-944c-4431-8577-1f0148a51956","type":"message","user":"U06BRP8VD","text":"する前後それぞれの値かな、知りたいのは。","ts":"1579573025.068100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Hb=l"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"966d1b04-8e67-4201-a58b-31e9b5e61fcd","type":"message","user":"U03C71D7H","text":"前も後も xterm ですね","ts":"1579573045.068600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tsL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"afcb7fe4-1192-4396-87be-5ab2a86c8d39","type":"message","user":"U06BRP8VD","text":"へぇ同じなんだ。そうなるとまったくあれだな。","ts":"1579573060.068900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"puVl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68437455-d6d6-40ea-af42-9edab63ad4a6","type":"message","user":"U06BRP8VD","text":"まぁterm設定したときにVimが何してるかみればよいのか","ts":"1579573074.069600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QcC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"78999847-3f7e-4b7e-815a-972ff00b3a9c","type":"message","user":"U03C71D7H","text":"`--entrypoint sh` してシェルから vim を立ち上げると問題なくて、現象が発生しないケースも稀にあるので、たぶん起動タイミングかなぁと思ってます","ts":"1579573090.070200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lLrV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9a81c382-34b1-4fcb-8a40-56b1f499a109","type":"message","user":"UAZ33BKV2","text":"Vim内のterm初期化時にスペシャル処理がはしってないか...ですか(pty resetとか?状態取得処理は動くかな?)","ts":"1579573093.070300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"63oBx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7d11d97b-4824-4a10-beb1-f7a727876c83","type":"message","user":"U03C71D7H","text":"回避方法があって image 作り直しが必要なら GitHub Actions のパワーをフル活用して過去バージョン全部再ビルドしたい (まずは回避方法…)","ts":"1579573194.071000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G5QM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2cd5f43a-7e01-42b8-af77-fd5c948e9d0a","type":"message","user":"UDDCM376D","text":"SIGNWIN","ts":"1579573536.072600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6vqNU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9ded0057-229e-4917-a099-7ab371fb80eb","type":"message","user":"U06BRP8VD","text":"term.c の `set_termname()` のフローを、初回起動時と `:set term&amp;` 実行時で比べたら何か違いが出てくるかも。あとは /bin/sh が読み込むだろう /etc/profile (?) とかの中身かなぁ。","ts":"1579573570.073200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dVnjX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a50b6cfc-0b74-44c9-afef-6c70f538e804","type":"message","user":"UDDCM376D","text":"`sleep 1 &amp;&amp; vim`したら、発生しない可能性あり","ts":"1579574102.074000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"efN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29d780e8-5729-46a5-aec2-1bf57a216a51","type":"message","user":"UDDCM376D","text":"SIGWINCHあたりが絡んでいそう","ts":"1579574173.075100","edited":{"user":"UDDCM376D","ts":"1579574253.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XtMr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3a90d9fb-dcb5-4365-a034-546ff7ddf8fe","type":"message","user":"UDDCM376D","text":"&gt; intro が表示されなかったり `:version` がうまく表示されなかったり(1行に重なって表示されてしまう)します。 `:set term&amp;` で term を再設定(再検出?)すると直るんですが、この現象を回避する方法について何か知ってる人がいたら教えてください。\nよくよくみたら違うかも","ts":"1579574301.075500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d=GNm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1db92f47-3e34-4187-ba78-5da0a2408ea8","type":"message","user":"UDDCM376D","text":"`:version` って打ったらこうなった","ts":"1579574386.075600","files":[{"id":"FSK1ZPF1R","created":1579574383,"timestamp":1579574383,"name":"image.png","title":"image.png","mimetype":"image/png","image_exif_rotation":1,"filetype":"png","pretty_type":"PNG","user":"UDDCM376D","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":7982,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FSK1ZPF1R/image.png","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FSK1ZPF1R/download/image.png","original_h":39,"original_w":876,"thumb_64":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_80.png","thumb_160":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_160.png","thumb_360":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_360.png","thumb_360_gif":"","thumb_360_w":360,"thumb_360_h":16,"thumb_480":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_480.png","thumb_480_w":480,"thumb_480_h":21,"thumb_720":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_720.png","thumb_720_w":720,"thumb_720_h":32,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/UDDCM376D/FSK1ZPF1R/image.png","permalink_public":"https://slack-files.com/T03C4RC8V-FSK1ZPF1R-eeaf9da4dd","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"thumb_800":"https://files.slack.com/files-tmb/T03C4RC8V-FSK1ZPF1R-600b80dd13/image_800.png","thumb_800_h":36,"thumb_800_w":800,"thumb_tiny":"AwACADCjRRRQUOH3PxNJSj7n4mkpgHYUdjR2FL2NAH//2Q==","username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vIWE"}]},{"client_msg_id":"1476d072-6915-45a4-ba0e-6d20e937e811","type":"message","user":"U03C71D7H","text":"それが発生している問題ですね","ts":"1579574412.076100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wuaLN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d7af3e51-9afc-4cab-a973-938b2541a02d","type":"message","user":"U7986PPFH","text":"以前調べた時は、Dockerは端末設定を起動後に非同期で行うのでVimの起動に間に合ってない、とかだった覚えがある","ts":"1579574631.078000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mw1z"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"58dd4793-00d5-4eb0-a799-4b444027b23e","type":"message","user":"U03C6TEAZ","text":"vim が起動直後に terminal とネゴシエーションしてる端末スペック問い合わせが一般的な端末と動作が違うんだと思います。","ts":"1579574639.078200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5NaL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c6c581ad-b962-4fee-bbc8-abbc2d7c6524","type":"message","user":"UDDCM376D","text":"ちょっと動かしてみたけど、コマンドラインは１行しか表示されないのか","ts":"1579574751.079500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dMH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29c9276f-c12b-45a7-9d51-9f8d762d15c6","type":"message","user":"U03C71D7H","text":"せめて非同期に行われた端末設定を Vim が拾えればいいのでしょうが…可能なのかどうかもよくわからない","ts":"1579574760.079800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TLgU9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5793c192-4b16-4359-bc1c-bd7aebca3bb2","type":"message","user":"U06BRP8VD","text":"へー起動後に非同期にやるんだ。","ts":"1579574809.080500","team":"T03C4RC8V","reactions":[{"name":"sorena","count":2,"users":["U7B4ZD49X","UK7DT8URY"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6aP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"83d43777-2e7b-4d98-b9b2-8c7b101fcc49","type":"message","user":"U03C71D7H","text":"そう、この問題以前も調べた(正確には詳しい人に調べてもらったw)のけど結局根本的には解決しなくて…あれから時間もかなり経ったので何か事情が変わってたりあるいはもっと詳しい人が出現したりしないかな、と言う感じでの質問でした","ts":"1579574866.081800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EaeU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"82094563-ebe6-4f4c-8c04-45148303cde9","type":"message","user":"UDDCM376D","text":"Dockerのソースを読むのが良さそうな気配","ts":"1579574897.082200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DjgB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eef41f52-d1da-49bd-be2c-32be058fbc49","type":"message","user":"U03C6TEAZ","text":"完全にエスパーだけど、1個 bash 等を挟むと行けるかも。","ts":"1579575292.082700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Y8Xf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3db275ab-eb97-4216-9784-d4ed0b1832e7","type":"message","user":"U03C6TEAZ","text":"bash -i -c vim 的な","ts":"1579575345.083200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"g7gFU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dca9d71f-c7a2-4a22-80f4-b4d9bfaf6331","type":"message","user":"U03C71D7H","text":"挟むだけじゃだめでした。 `[\"/bin/sh\", \"-c\", \"sleep 0.1; exec /usr/local/bin/vim\"]` sleep 入れるといけました","ts":"1579575575.084100","team":"T03C4RC8V","reactions":[{"name":"grin","count":1,"users":["U06BRP8VD"]},{"name":"+1","count":2,"users":["U06BRP8VD","UK7DT8URY"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OCZB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d3ac5e3b-8575-4274-84a0-a52ea5c99fa1","type":"message","user":"U03C71D7H","text":"とはいえ事情を知らないとキモすぎる workaround","ts":"1579575597.084400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7=i"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"713bdf85-2e7f-43fd-8448-36484d566ec4","type":"message","user":"UNJ2DANJC","text":"sleep入れる系はだいたいいつか壊れる エスパーですけど","ts":"1579576863.086100","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U9S4G0LJW"]},{"name":"wakaru","count":3,"users":["U7B4ZD49X","U03C71D7H","U776661HA"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lN="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c0336983-68c2-445a-a737-863b24a3e2ea","type":"message","user":"UAZ33BKV2","text":"ttyの特定の状態をreadできるまで待つとかすると、こんどはそれ返さない系で無限待ちになったりする、エスパー伊東ですが","ts":"1579576926.087200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"W6SJn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a81200af-142c-495d-b4e2-d097f15636be","type":"message","user":"UNJ2DANJC","text":"知らんけど==エスパー","ts":"1579576960.087600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OjL08"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fed5a771-bcd5-463b-a510-bf2d398f777d","type":"message","user":"UAZ33BKV2","text":"想像==エスパー伊東","ts":"1579576983.087800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RtJbn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"181be3eb-7ef7-4e56-b49c-368d9dd33800","type":"message","user":"UAZ33BKV2","text":"(いや、ギャグですが)","ts":"1579576998.088100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MD7xI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dc31d737-28ad-4613-9af9-c2978612ecd0","type":"message","user":"UDDCM376D","text":"wait SIGWINCH","ts":"1579577025.088500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4GA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"adcd9acf-c11b-477f-8ba5-7f617da4ca97","type":"message","user":"UAZ33BKV2","text":"ターミナルサイズ変更か、ありそうですね...(ぴったり同じだったりすると出ないとかあるかな?)","ts":"1579577095.089300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vjUy6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9a971c89-ba22-48df-ab6d-9c5aba49791f","type":"message","user":"U03C6TEAZ","text":"bash なら resize コマンドが使えるかも。","ts":"1579578220.089800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YXu+k"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d808853d-6798-4667-808a-58fd3dc3bb69","type":"message","user":"U7986PPFH","text":"```#!/bin/sh\nresize &gt;/dev/null\nexec \"$@\"```\n/docker-entrypoint.sh\nこれで `[\"/docker-entrypoint.sh\", \"/usr/local/bin/vim\"]` するとうまくいっています","ts":"1579579631.092100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oG+nI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9029d93c-1cd5-4cee-af93-d949d064545c","type":"message","user":"U03C71D7H","text":"sleep よりか遥かに良さそう","ts":"1579579764.092500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wPFX7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1da0daec-7c5f-46fe-aa8f-224784ff9482","type":"message","user":"UDDCM376D","text":":goodpoem:","ts":"1579579780.092700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ECx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"16df7187-f571-4298-8c84-c379d4324c7d","type":"message","user":"U03C71D7H","text":"コンテナ内に置くファイルを極力減らすならこうかなー `ENTRYPOINT [\"/bin/sh\", \"-c\", \"resize &gt; /dev/null; exec /usr/local/bin/vim\"]`","ts":"1579580026.093200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VDny/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3d52297b-3ca2-4b34-ac99-54b285c7802f","type":"message","user":"U03C71D7H","text":"workaround として採用したい気持ちもありつつ他にワナがないか心配もある…","ts":"1579580226.093800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F6F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dc82f3c3-9ab2-4308-a6bb-9acc3d3d088d","type":"message","user":"U03C6TEAZ","text":"ブログを書こう","ts":"1579580495.094000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"L40"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"351f68fd-75b9-46e4-99be-3565b714213a","type":"message","user":"U03C6TEAZ","text":"ちなみに resize コマンドはターミナル応答を待つコマンドなので、たぶん安全(?)","ts":"1579580533.094600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"w0w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"62aa6377-8b29-437a-b60a-ae346fd3949a","type":"message","user":"U03C71D7H","text":"ブログ良さそう","ts":"1579580653.094800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"l3HT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b46bd1ab-2659-45e4-9fad-e235266d7c89","type":"message","user":"U03C6TEAZ","text":"/usr/bin/resize は bash の builtin じゃなかった。","ts":"1579581845.095100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WUN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56d9da2e-b7c7-424b-8eed-631e908f4a9c","type":"message","user":"U03C6TEAZ","text":"xterm が提供してるぽい。","ts":"1579581851.095300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"trpxs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"468c519a-7d6a-47dc-92fa-4bd5ea25b673","type":"message","user":"U03C6TEAZ","text":"X 入ってない環境で実行したらエラーになった。","ts":"1579581885.096300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r+N"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c9c28038-fc84-448c-8863-1577b936ac97","type":"message","user":"UAZ33BKV2","text":"xtermが定義されるdockerの枠内だと、ないとこまりそうだけど、ベースイメージによってはないかもしれない...ですかね?","ts":"1579581888.096500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rH+d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3cf2d824-7c92-491c-b36e-254943caa954","type":"message","user":"UAZ33BKV2","text":"あー、Xないと無いだとわりと無さそう","ts":"1579581917.097000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cF+by"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3F36D4A8-6189-4B52-A7D0-BA9FF20B07DB","type":"message","user":"U776661HA","text":"自分もdockerのやつハマってたのですごい俺得な知見だった","ts":"1579581938.097700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PjLA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"46d64269-64c6-4dd8-94bb-b78c96f5bbc7","type":"message","user":"U03C71D7H","text":"alpine ではとりあえず問題なかった","ts":"1579581963.098000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OG0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fde8925e-9601-463f-bdd3-03ee1a25c1cd","type":"message","user":"UAZ33BKV2","text":"alpine :erai:","ts":"1579581980.098600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7PkG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"af482955-aafc-4103-8d52-ca5fc17e2a8d","type":"message","user":"U03C71D7H","text":"ついでに alpine のベース上げようかな。上げるとサイズ増えるのか減るのか","ts":"1579581988.098800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"W055O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"23e9ad03-e7ab-45da-8962-7864c5583d4b","type":"message","user":"U03C71D7H","text":"試すか","ts":"1579581998.099000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"v1K"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"31a121e0-ceda-4f98-ae19-09a621a5cbda","type":"message","user":"U03C6TEAZ","text":"```stty size | sed 's/^/COLUMNS=/' | sed 's/ / LINES=/'```","ts":"1579582028.099200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k0ZN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"10858c33-269d-44e7-be11-dbbac6684baf","type":"message","user":"U03C6TEAZ","text":"これを挟めたらいいかも。","ts":"1579582035.099400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"f1v"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"247193be-9332-41ef-8b0b-8605f2485344","type":"message","user":"U03C71D7H","text":"お、更なる改善? (もう何が原因で何をしているのかわかっていない)","ts":"1579582071.099900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Io/F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bf509155-cdd6-48ee-a795-10d047119843","type":"message","user":"U03C6TEAZ","text":"LINES COLUMNS 変数と実際の端末領域との差異","ts":"1579582087.100200","edited":{"user":"U03C6TEAZ","ts":"1579582095.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qfqhs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"49681f49-6520-4947-bce0-3259a81b958d","type":"message","user":"U03C6TEAZ","text":"docker が割り当てる端末の大きさたぶん 80x25 とかになってて初回の問い合わせで実際の端末サイズに変えられると思うんですが、その差異によって起きてるのかと。","ts":"1579582137.101300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HBx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1fbc6bcd-bd19-427e-bd4a-8ce8f66d8c1a","type":"message","user":"U03C6TEAZ","text":"stty size で実際の端末サイズが取れるのでそれを環境変数 COLUMNS/LINES に設定してやればいけそうという話です。","ts":"1579582170.102200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xNRG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d371d15f-ae3c-46a6-8d2c-e67649103e78","type":"message","user":"U03C71D7H","text":"スクリーン全体が小さくなってしまわないのはなぜなんでしょう?","ts":"1579582185.102500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qhQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a22eecc9-8884-4fcc-8c94-62e283bc0048","type":"message","user":"U03C71D7H","text":"そもそものサイズが小さいとでかい端末の左上の方にちょこんと Vim が表示されそうだけどそうはなっていないのがよくわかっていない","ts":"1579582224.103500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sk+n5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ee44660e-d58b-44cf-81c5-deef6b36e7da","type":"message","user":"U03C6TEAZ","text":"初期は COLUMNS/LINES 未設定、内部的なサイズだけ 80x25 とかなんだと思うんですが、vim が起動時に端末サイズを端末に問い合わせて違う値が返ってきたもんだからリサイズして画面がおかしくなる、みたいな動作かなと思います。","ts":"1579582279.104700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cEz+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4f11be0c-c099-4aec-9324-cc5d378c4c84","type":"message","user":"U03C6TEAZ","text":"エスパー気味。","ts":"1579582301.104900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"win"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"737c01f6-79b2-4b3d-9f68-1558ede3e799","type":"message","user":"U03C71D7H","text":"端末のこの辺りの挙動複雑すぎて(そもそも基本も知らないのだけど)全然わからん、ってなりますね…端末のプロが必要","ts":"1579582368.105800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xXw70"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"685c5545-eca3-47fc-85fe-0fe1d56fa080","type":"message","user":"U03C6TEAZ","text":"twitter だと ttdoda さんか、kefir_ さん","ts":"1579582476.106200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hzxIl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f57f3dc9-be5a-4763-875f-3e5a396ef198","type":"message","user":"U03C71D7H","text":"workaround がユーザーから観測可能(環境変数が残ってしまう)のが少し気持ち悪いと感じてしまう潔癖症","ts":"1579582539.106700","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":2,"users":["U9S4G0LJW","U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MbPhK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"412d7a7a-aab4-4736-9de4-2833a51bbfdb","type":"message","user":"U03C6TEAZ","text":"Twitter でぼやくと返信してくれる人たちもいますね。","ts":"1579582589.107400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"njUT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c5ad7a3-d257-48ef-8350-f47c8fea2b01","type":"message","user":"UDDCM376D","text":"docker run -itすると、たしかDockerが端末のリサイズをしていた気がする","ts":"1579582629.108400","team":"T03C4RC8V","reactions":[{"name":"sasugori","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CA2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5425370a-9e53-42f3-9b4b-54e6ad97d04a","type":"message","user":"UDDCM376D","text":"APIだとこの辺かな\n<https://docs.docker.com/engine/api/v1.40/#operation/ExecResize>","ts":"1579582680.108600","attachments":[{"fallback":"Docker Engine API v1.40 Reference","id":1,"title":"Docker Engine API v1.40 Reference","title_link":"https://docs.docker.com/engine/api/v1.40/#operation/ExecResize","text":"Reference for the API served by Docker Engine.","blocks":null,"service_name":"docs.docker.com","service_icon":"https://docs.docker.com/favicon.ico","from_url":"https://docs.docker.com/engine/api/v1.40/#operation/ExecResize","original_url":"https://docs.docker.com/engine/api/v1.40/#operation/ExecResize"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mxUr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"419456fb-09b1-4674-b7ea-48a95b249a39","type":"message","user":"UDDCM376D","text":"<https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/run.go>","ts":"1579582792.109100","attachments":[{"fallback":"run.go - docker/cli - Sourcegraph","id":1,"title":"run.go - docker/cli - Sourcegraph","title_link":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/run.go","text":"Sourcegraph is a web-based code search and navigation tool for dev teams. Search, navigate, and review code. Find answers.","blocks":null,"service_name":"sourcegraph.com","from_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/run.go","original_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/run.go"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wrbn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5061a02d-e383-4aeb-a2bd-7295014405bd","type":"message","user":"UDDCM376D","text":"ソースだとこの辺","ts":"1579582797.109300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xMbJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"13067f1e-f9fe-47f1-ba9d-91283b6b7e74","type":"message","user":"UDDCM376D","text":"docker runは\nコンテナを作って、コンテナ内でプロセスを生成して、そのプロセスの標準入出力をTCPでストリーミングしています（と記憶している）","ts":"1579582840.110100","edited":{"user":"UDDCM376D","ts":"1579582872.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xqhjX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"691e94bd-239e-4b2a-a141-dea744a9a462","type":"message","user":"U03C6TEAZ","text":"Windows だけサイズ合わせ入っててうける。","ts":"1579582877.110600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VvJm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"31b9ca67-d2eb-44db-82fc-8649f0b40f22","type":"message","user":"U03C6TEAZ","text":"```\tif runtime.GOOS == \"windows\" {\n\t\thostConfig.ConsoleSize[0], hostConfig.ConsoleSize[1] = dockerCli.Out().GetTtySize()\n\t}```","ts":"1579582881.110800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cJxW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b31f530d-d348-46dc-ac6a-d687a8ae84ec","type":"message","user":"UDDCM376D","text":"<https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L71:6>","ts":"1579582928.111000","attachments":[{"fallback":"tty.go - docker/cli - Sourcegraph","id":1,"title":"tty.go - docker/cli - Sourcegraph","title_link":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L71:6","text":"Sourcegraph is a web-based code search and navigation tool for dev teams. Search, navigate, and review code. Find answers.","blocks":null,"service_name":"sourcegraph.com","from_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L71:6","original_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L71:6"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YfaM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f8de139f-f9ba-4bf2-9aa5-2381b794a126","type":"message","user":"U03C71D7H","text":"どうして… &gt;Winだけ","ts":"1579582951.111500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jyw9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"11b634ff-f97a-4c04-99ed-6d56063f417a","type":"message","user":"UDDCM376D","text":"<https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L19:6>","ts":"1579583002.111800","attachments":[{"fallback":"tty.go - docker/cli - Sourcegraph","id":1,"title":"tty.go - docker/cli - Sourcegraph","title_link":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L19:6","text":"Sourcegraph is a web-based code search and navigation tool for dev teams. Search, navigate, and review code. Find answers.","blocks":null,"service_name":"sourcegraph.com","from_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L19:6","original_url":"https://sourcegraph.com/github.com/docker/cli@d443b7409192f29bf82258396f0170dff6cba707/-/blob/cli/command/container/tty.go#L19:6"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6lEW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fdc0cfa8-5917-4380-9dc3-2a89958e8e0e","type":"message","user":"UDDCM376D","text":"ここでリサイズしています","ts":"1579583006.112100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FNfri"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b755033b-070f-4bb7-aad5-963e593c7f11","type":"message","user":"U03C6TEAZ","text":"prevH prevW が race condition うける。","ts":"1579583016.112400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MvJc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"853c4a5d-0cc8-44c3-bec0-41c9ba15fae5","type":"message","user":"U03C6TEAZ","text":"`-i` の時だけ goroutine じゃなくする修正送ったらいいんじゃないすかね。","ts":"1579583106.113200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ScG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"438485d6-4521-4b29-862d-09c93740a639","type":"message","user":"U03C6TEAZ","text":"```\tif runtime.GOOS == \"windows\" {\n\t\tgo func() {\n\t\t\tprevH, prevW := cli.Out().GetTtySize()\n\t\t\tfor {\n\t\t\t\ttime.Sleep(time.Millisecond * 250)\n\t\t\t\th, w := cli.Out().GetTtySize()\n\n\t\t\t\tif prevW != w || prevH != h {\n\t\t\t\t\tresizeTty(ctx, cli, id, isExec)\n\t\t\t\t}\n\t\t\t\tprevH = h\n\t\t\t\tprevW = w\n\t\t\t}\n\t\t}()\n\t} else {\n\t\tsigchan := make(chan os.Signal, 1)\n\t\tgosignal.Notify(sigchan, signal.SIGWINCH)\n\t\tgo func() {\n\t\t\tfor range sigchan {\n\t\t\t\tresizeTty(ctx, cli, id, isExec)\n\t\t\t}\n\t\t}()\n\t}```\nここはいろいろ無理やりすぎて面白い。","ts":"1579583157.113700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"e3ajz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a79448f2-c63c-4692-a3a5-f4f4298a656a","type":"message","user":"U03C71D7H","text":"go func() の中で resizeTty() 呼んでるな。なるほどなー","ts":"1579583199.114600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k+R"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e1971317-c01a-4a51-ab0a-90ff00fa83e2","type":"message","user":"U03C6TEAZ","text":"たぶん、xterm みたいな端末の右下をつまんでビロロロロロってリサイズして何度もイベントが発生するのを避けたいのだろうけど。","ts":"1579583205.114800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mzR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e27a644e-101b-4df2-90c0-f4d68022a510","type":"message","user":"U03C6TEAZ","text":"`-i` というより初回だけ goroutine 使わない修正がいいのかも。","ts":"1579583245.115300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AbuCb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d45eac5-137a-49f1-a657-500beed928f8","type":"message","user":"U03C71D7H","text":"最初の `resize` コマンドを使うやつは強制的に `SIGWINCH` を発生させてその後で Vim を起動するみたいな感じなのかな (雰囲気しかわかっていない)","ts":"1579583352.116100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PTJc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6dc9f55a-46fc-4656-889e-7f48e31ec256","type":"message","user":"U03C6TEAZ","text":"resize コマンドは端末に対してサイズ要求投げて戻ってきた値を COLUMNS=XXX LINES=XXX という形式で出力するだけだった気がします。","ts":"1579583537.116900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UKksy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec7e8ec9-b8ac-427a-8767-02fcaa5254ea","type":"message","user":"U03C6TEAZ","text":"なので `eval $(resize)`","ts":"1579583552.117200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CbyBB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b6e8feac-2ade-4861-a3f6-8530f1bca17a","type":"message","user":"U03C71D7H","text":"単に resize するとうまく行くのは時間差が発生しているだけ(sleep と同じ)…?","ts":"1579583625.117800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zhjpX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"72F78AB5-51D9-4713-85DB-216C846C982D","type":"message","user":"UDDCM376D","text":"そんな気がします","ts":"1579583691.118100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"K5s=W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0ac8058c-0a38-42e9-9f0f-7657b0f9c775","type":"message","user":"U03C71D7H","text":"うむむむ","ts":"1579583719.118300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pQRit"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b1bcd3e3-de28-4e70-9141-020fe7a9dcb1","type":"message","user":"UDDCM376D","text":"CLIのソースに手を入れないとしたら起動タイミングをずらす方法以外は思いつかない","ts":"1579584335.119300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"H6YAs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7c11220a-38ae-481d-876f-ec00731f21b6","type":"message","user":"U03C71D7H","text":"LINES/COLUMNS を設定する workaround も、設定のために値を取得する段階で sleep 相当の時間がかかっていて有効なのかどうかがいまいちよくわからない","ts":"1579584504.120100","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["UDDCM376D"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XZs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c1a0625d-da40-4d22-bea4-b0125b0d28a7","type":"message","user":"U06BRP8VD","text":"uwa-","ts":"1579584619.120600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3SPdq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8d7c1715-a87b-4d9f-a303-20db5221224b","type":"message","user":"U06BRP8VD","text":"きもいw","ts":"1579584627.121000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d=m"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50508383-0267-4240-8131-533c2a08362e","type":"message","user":"U03C71D7H","text":"```\tVimは端末からより確かな方法でサイズが得られると、環境変数 $COLUMNS と\n\t$LINES を無視します。'cpoptions' にフラグ 'l' を加えると $COLUMNS と\n\t$LINES が他の方法で得られたサイズを上書きするようになります。```","ts":"1579584717.121400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oEuX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3fabcdba-53ee-4981-9268-fe69d8ed305e","type":"message","user":"UDDCM376D","text":"sleepよりは良さそうではある","ts":"1579584763.121600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FRFmb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2d146284-5951-42ec-a7e6-32e0af15bdc2","type":"message","user":"U03C71D7H","text":"いや、無視すると書いてあるので使われているのかどうかわからない","ts":"1579584784.122000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/YXJ0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21da43e4-defa-4cc4-a9d6-f0b594a9cc61","type":"message","user":"UDDCM376D","text":"あ、ほんとだ","ts":"1579584808.122400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"foE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
