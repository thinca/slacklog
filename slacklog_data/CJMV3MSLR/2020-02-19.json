[{"client_msg_id":"72acfef4-6234-460a-97ac-3747a976ef07","type":"message","user":"U8996GYBF","text":"コマンドラインで `&lt;C-r&gt;=` を使った場合の挙動について質問させてください\n`@/` に `\\vfoo` や `\\&lt;foo\\&gt;` が入っている場合なんですが\n`&lt;C-r&gt;=substitute(@/, '\\(\\\\v\\|\\\\&lt;\\|\\\\&gt;\\)', '', 'g')` を実行すると `\\v`, `\\&lt;`, `\\&gt;` が削除されます。\n`:echo substitute(@/, '\\(\\\\v\\|\\\\&lt;\\|\\\\&gt;\\)', '', 'g')` でも同様です。\nなんですが、nnoremapで\n`nnoremap &lt;Leader&gt;&lt;Leader&gt; :&lt;C-u&gt;&lt;C-r&gt;=substitute(@/, '\\(\\\\v\\|\\\\&lt;\\|\\\\&gt;\\)', '', 'g')&lt;CR&gt;` のようにした場合に置換されずにコマンドラインに入力されてしまいます。\nどこか書き方を間違えているでしょうか。\n\n環境は\n```$ nvim --version\nNVIM v0.5.0-nightly-112-g405f49a9b```\nです","ts":"1582101856.135800","edited":{"user":"U8996GYBF","ts":"1582101900.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1cK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b7ab9e92-f1c6-49c0-a832-3198e5bbab79","type":"message","user":"U9S4G0LJW","text":"`|` を `&lt;Bar&gt;` にするとよいです","ts":"1582102040.136200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JbY6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"11917c31-e524-4fb6-9b03-cf8496d451e4","type":"message","user":"U9S4G0LJW","text":"歴史的経緯から `\\|` が特別に `|` の入力に使えるようになっていて、 `\\` が消滅してしまうためこのような挙動になるらしい","ts":"1582102167.137700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5nhKz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aaa40172-2d0c-43e8-b53f-90b1f6af5463","type":"message","user":"U9S4G0LJW","text":":h map_bar","ts":"1582102170.137900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6XNo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UPZHKAM7W","text":"```\n                                                        *map_bar* *map-bar*\n'|' 文字は、マップコマンドと次のコマンドを分けるために使われるので、'|' 文字を\n{rhs} に含めるには特殊な方法が必要です。\n次の3つの方法があります:\n   方法      使用できる条件                     例       \n   &lt;Bar&gt;     'cpoptions'に'&lt;'が含まれていない   :map _l :!ls &lt;Bar&gt; more^M\n   \\|        'cpoptions'に'b'が含まれていない   :map _l :!ls \\| more^M\n   ^V|       VimとViで常に使用できる            :map _l :!ls ^V| more^M\n \n(ここで ^V は CTRL-V を表します。一つの CTRL-V を挿入するには CTRL-V を二度押\nしで入力します。この用途では、|&lt;&gt;|表記を使って \"&lt;C-V&gt;\" とすることはできません)。\n \n'cpoptions' が標準設定のままなら、三つ全ての方法が使用できます。\n \n'cpoptions' に 'b' が含まれている場合、\"\\|\" は、'\\' で終わるマップコマンドの後\nに、別のコマンドが続いているとみなされます。これは Vi 互換ですが、他のコマンド\nの場合を考えるとあまり論理的ではありません。\n```","ts":"1582102171.138000","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"47f376cf-3756-453a-b4b3-a80635b9f231","type":"message","user":"U8996GYBF","text":"`&lt;C-r&gt;=substitute(@/, '\\\\v&lt;Bar&gt;\\\\&lt;&lt;Bar&gt;\\\\&gt;', '', 'g')&lt;CR&gt;`\nで動作しない・・・\nまだなんかミスってますかね・・・？","ts":"1582102268.138400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PiA=A"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"39fbc35a-9adc-42c4-af11-cd2e4eb1b361","type":"message","user":"U9S4G0LJW","text":"`nnoremap &lt;Leader&gt;&lt;Leader&gt; :&lt;C-u&gt;&lt;C-r&gt;=substitute(@/, '\\(\\\\v\\&lt;Bar&gt;\\\\&lt;\\&lt;Bar&gt;\\\\&gt;\\)', '', 'g')&lt;CR&gt;`\nでどうです？","ts":"1582102301.138700","edited":{"user":"U9S4G0LJW","ts":"1582102435.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=Gw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"41be59f9-3a65-4f31-ae3a-eb8735a11c1b","type":"message","user":"U9S4G0LJW","text":"\\は抜いたらだめです","ts":"1582102306.138900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N6K"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"395d19a4-e83f-4b5c-bd88-a77b7cfeae55","type":"message","user":"U8996GYBF","text":"あー、ダメなんですね","ts":"1582102332.139200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZX51"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bb045fc0-8220-4cbc-8f56-204ff555a165","type":"message","user":"U8996GYBF","text":"ダメだ、何が違うんだろう","ts":"1582102404.139400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Igi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2c2243aa-6f88-4c46-9d80-f5558f05d484","type":"message","user":"U9S4G0LJW","text":"うーん、こっちだとこれで上手くいくんですけどねぇ…","ts":"1582102448.139900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9dYqp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3a4c04d5-19b2-4e11-b83d-10567169d2d5","type":"message","user":"U9S4G0LJW","text":"最後の&lt;CR&gt;が抜けてた","ts":"1582102453.140200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IhbG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92081662-330b-4388-9b0f-b9a6b28af897","type":"message","user":"UAZ33BKV2","text":"helpにあるようにcpo に設定しちゃってる、とか?","ts":"1582102483.141000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/anik"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"daccb42e-9316-44cc-9a42-9c672be975ce","type":"message","user":"U8996GYBF","text":"あ、コピペじゃなくて手元でエスケープしたら一部ミスってた\nすみません","ts":"1582102516.141400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iH2a"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cd9a7b56-dc2d-442e-a3f9-09a0f46cbbb0","type":"message","user":"U8996GYBF","text":"Barの後ろの `&gt;` はエスケープしないんですね","ts":"1582102528.141700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r23"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ed3c9c58-3311-4033-b842-ac1334c2c0fa","type":"message","user":"U9S4G0LJW","text":"`&lt;Bar&gt;` で一綴りなのでそのままでOK","ts":"1582102552.142200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"R0V9s"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8f2730de-c276-4d29-beb6-d1545e3ac8c0","type":"message","user":"U8996GYBF","text":"これでまともに使える・・・\nありがとうございます","ts":"1582102607.142800","team":"T03C4RC8V","reactions":[{"name":"tada","count":1,"users":["U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Awom"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c6a418b-b5cc-4a9d-9d80-f9e5ab06822a","type":"message","user":"U8996GYBF","text":"正規表現も一般的なのよりエスケープ多いしこの辺ややこしい・・・","ts":"1582102635.143800","team":"T03C4RC8V","reactions":[{"name":"sorena","count":2,"users":["U9S4G0LJW","UEB0VGD7E"]},{"name":"wakaru","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nHHvV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d08cbccf-cb30-4eb1-8eef-bb86aa0ecbb5","type":"message","user":"U9S4G0LJW","text":"very magic以外使えない体にされました","ts":"1582102657.144300","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":3,"users":["UBNPMJJGM","UB88NP1PY","UL6CFN8NR"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uvM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"27091b05-a006-4f12-be04-d3b18dd25f16","type":"message","user":"U9S4G0LJW","text":"みんなやらかすよね、これ。完全に罠","ts":"1582102667.144600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HgO6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"87d1bb95-4024-4b33-b5f7-e8d478e79462","type":"message","user":"U8996GYBF","text":"いや、これくらいなら1-2分見たらまだ全然いけるか","ts":"1582102869.146100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vGM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"96bfa015-bd8e-4e7d-9f5d-f5f3a8019a8d","type":"message","user":"U78A6ESHM","text":"`\\` 多すぎる…","ts":"1582102945.146300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DUS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6cd0081f-1b93-4edb-8f4e-540ac590c1cb","type":"message","user":"U8996GYBF","text":"一般的な正規表現とVim scriptを相互変換する何かがほしい","ts":"1582102981.147000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"j6gB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ee3a0109-af22-431d-aeb9-bca892636466","type":"message","user":"U78A6ESHM","text":"Vim の正規表現に慣れすぎて Python の正規表現が書けなくて一瞬困った…","ts":"1582103015.147500","team":"T03C4RC8V","reactions":[{"name":"tired_face","count":1,"users":["U9S4G0LJW"]},{"name":"wakaru","count":1,"users":["UBQ2H65JQ"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Pk2x"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d06d2d51-99e1-4b0f-bccf-09caa1b15f0b","type":"message","user":"U7H4TJEG0","text":"\\vを使えばいくらかマシには…","ts":"1582103070.147900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zR96d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b5b9d7cc-0b33-4b88-adc0-b7d5b366dc7a","type":"message","user":"U7H4TJEG0","text":"なんか %() を覚えられない病とかはあるふつうは (?:)  なので","ts":"1582103136.148500","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":2,"users":["UBNPMJJGM","UEACRCY0Z"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OO1wR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"018e244b-583b-468d-8ec7-1fb9eeee77be","type":"message","user":"U9S4G0LJW","text":"正規表現なにもわからないので使う度 `:h pattern` してる","ts":"1582103166.149000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hB/8c"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"779772ec-daa7-45d9-b26b-bc7c0f641234","type":"message","user":"UL6CFN8NR","text":"<https://regex101.com/> が Vim の正規表現に対応してくれたらすごくハッピーなんですが","ts":"1582122895.150400","attachments":[{"fallback":"Regex101 - online regex editor and debugger","id":1,"title":"Regex101 - online regex editor and debugger","title_link":"https://regex101.com/","text":"Regex101 allows you to create, debug, test and have your expressions explained for PHP, PCRE, Python, Golang and JavaScript. The website also features a community where you can share useful expressions.","blocks":null,"service_name":"regex101.com","service_icon":"https://regex101.com/static/assets/apple-icon-57x57.png","from_url":"https://regex101.com/","original_url":"https://regex101.com/"}],"team":"T03C4RC8V","reactions":[{"name":"tashikani","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"z3WYd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dc103426-8fab-4828-8e5f-5107dd4179a5","type":"message","user":"UL6CFN8NR","text":"<https://github.com/firasdib/Regex101/issues/50>\n\n&gt; Vim regex is... weird.","ts":"1582122965.150800","attachments":[{"fallback":"GitHub: Support for vim regex patterns · Issue #50 · firasdib/Regex101","id":1,"title":"Support for vim regex patterns · Issue #50 · firasdib/Regex101","title_link":"https://github.com/firasdib/Regex101/issues/50","text":"Any chance of seeing support for vim regex pattern in regex101? See also: <http://vimregex.com/>","thumb_url":"https://avatars3.githubusercontent.com/u/1335165?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/firasdib/Regex101/issues/50","original_url":"https://github.com/firasdib/Regex101/issues/50"}],"team":"T03C4RC8V","reactions":[{"name":"laughing","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7XJg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5f008039-fd89-4183-9c28-56d7cbe25918","type":"message","user":"UL6CFN8NR","text":"悲しい...","ts":"1582122992.151100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CYe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"74e51dc2-d549-4951-a2d8-e7ac141c98e4","type":"message","user":"UAZ33BKV2","text":"あとどっかのregexをグラフ構造にしてくれるやつが対応してくれると嬉しい","ts":"1582123357.151600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hwJ8b"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6eaffb13-a2e9-42cf-a20e-a19312cad114","type":"message","user":"U03C6TEAZ","text":"慣れると `\\zs` や `\\ze` が無いと辛くなります。","ts":"1582123558.152100","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":3,"users":["U776661HA","U03C71D7H","UGHD6GP16"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mE5x"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UTWEXKHLZ","text":"<@UTWEXKHLZ> has joined the channel","ts":"1582091283.132500","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null}]
