[{"client_msg_id":"7f70d0c8-fdf7-4b32-b45d-beee11888bde","type":"message","user":"UDDCM376D","text":"[質問]\n`job_start()` で `out_io` でバッファを指定して、コマンド実行結果をバッファに書き出すときのうごきについて。\n\n`job_start()`が作ったバッファって `bw!` で削除しても `bufnr()` でバッファ番号を取れるのですが、\nこれは仕様とおりですか？","ts":"1568676510.039700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c6a9d4a8-6ab5-4afa-bb01-bd59c9c9cd73","type":"message","user":"UDDCM376D","text":"あー、すいません、↑は勘違いです","ts":"1568677042.040000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b0dda4f6-944c-4276-b605-f212132e7c85","type":"message","user":"UDDCM376D","text":"`bufnr` って指定したバッファ名と完全一致したバッファ番号を返すのではなかったのか","ts":"1568677257.040900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a7ce40f5-8736-4ade-a420-92d9c86974e0","type":"message","user":"UDDCM376D","text":":h bufnr","ts":"1568677260.041100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U894RTUJY","text":"```\n                                                        *bufnr()*\nbufnr({expr} [, {create}])\n                結果はバッファの番号。バッファ番号はコマンド \":ls\" で表示され\n                るものと同様。{expr}の使い方は前述の |bufname()| を参照。バッ\n                ファが存在しない場合-1が返される。ただし、{create}が与えられて\n                0でないときは、バッファリストに載せない新しいバッファを作成し\n                その番号を返す。\n                bufnr(\"$\")は最後のバッファを意味する:  \n        :let last_buffer = bufnr(\"$\")\n                結果は存在しているバッファのうちで、もっとも大きなバッファ番号\n                となる。 Note そのバッファ番号より小さいバッファ番号を持つ(ハ\n                ズの)バッファが、必ずしも全て存在するとは限らない。なぜなら\n                \":bwipeout\" がバッファを消すことができるからだ。バッファが存在\n                するかテストするにはbufexists()を使う。\n```","ts":"1568677260.041200","bot_id":"B894RTUCU","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"31d1a8ad-4f85-4032-bfaf-350e1847d71c","type":"message","user":"UDDCM376D","text":"[質問]\n`job_start()` で実行結果をバッファに追記するようにしている場合は、実行後、バッファが開いていなければ開くようにしたいのですが、\nどの様にやるのが良いでしょうか？\n\n↓のようにやってみたのですが、 `[DOCKER BUILD]` に結果は書き込まれるものの、\nウィンドウが表示されず、その理由は `bufnr(s:build_result_buffer_name)` の結果がすでに開いている `Dockerfile` のバッファIDを返しているからです。\n\n完全一致したバッファ名からバッファ番号を取得する方法があればいいいのですが…\n\n```\nlet s:build_result_buffer_name = '[DOCKER BUILD]'\n\nfunction! s:docker_build_exit_cb(ch, status) abort\n\tlet buf_number = bufnr(s:build_result_buffer_name)\n\tif empty(win_findbuf(buf_number))\n\t\texe \"new | e \" .. s:build_result_buffer_name\n\tendif\nendfunction\n\nfunction! docker#api#image#build(first, last, ...) abort\n\t\" is last arg is '-', stdin from current buffer\n\tif a:000[-1] ==# '-'\n\t\tlet buf = join(getline(a:first, a:last), \"\\n\")\n\t\tlet cmd = ['docker', 'build'] + a:000\n\t\tcall job_start(cmd, {\n\t\t\t\t\t\\ 'in_io': 'buffer',\n\t\t\t\t\t\\ 'in_name': '%',\n\t\t\t\t\t\\ 'in_top': a:first,\n\t\t\t\t\t\\ 'in_bot': a:last,\n\t\t\t\t\t\\ 'out_io': 'buffer',\n\t\t\t\t\t\\ 'out_name': s:build_result_buffer_name,\n\t\t\t\t\t\\ 'out_msg': 0,\n\t\t\t\t\t\\ 'err_io': 'buffer',\n\t\t\t\t\t\\ 'err_name': s:build_result_buffer_name,\n\t\t\t\t\t\\ 'err_msg': 0,\n\t\t\t\t\t\\ 'out_modifiable': 0,\n\t\t\t\t\t\\ 'exit_cb': function('s:docker_build_exit_cb'),\n\t\t\t\t\t\\ })\n\telse\n\n\tendif\nendfunction\n```","ts":"1568678030.046000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1b5aacec-a2c7-464a-8fb4-86cc83d37e61","type":"message","user":"UDDCM376D","text":"↑問題解決","ts":"1568685386.048500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8ba2d619-470c-4ce6-b9a4-6808973fef48","type":"message","user":"ULSHV7A6R","text":"MacのiTermでtmux上のNeovimを起動して、checkhealthを実行すると、以下のような警告が出ます。\nどのように対応すればよいのでしょうか？\n## tmux\n  - OK: escape-time: 0ms\n  - INFO: $TERM: screen-256color\n  - WARNING: Neither Tc nor RGB capability set. True colors are disabled. |'termguicolors'| won't work properly.\n    - ADVICE:\n      - Put this in your ~/.tmux.conf and replace XXX by your $TERM outside of tmux:\n          set-option -sa terminal-overrides ',XXX:RGB'\n      - For older tmux versions use this instead:\n          set-option -ga terminal-overrides ',XXX:Tc'","ts":"1568708274.050100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0398b266-7662-423e-b479-c258d47a0f9c","type":"message","user":"U8CC7MDCL","text":"true color使うにはtmuxに追加の設定が必要だった筈…\n```\nset -g default-terminal \"screen-256color\"\nset -ga terminal-overrides \",xterm-256color:Tc\"\n```\nこの設定でいい筈","ts":"1568708563.051900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"95b92fe1-4ce2-443a-9142-f5209e90b90d","type":"message","user":"UAZ33BKV2","text":"<https://qiita.com/delphinus/items/b8c1a8d3af9bbacb85b8#%E6%9B%B4%E3%81%AB-true-color-%E3%82%92%E4%BD%BF%E3%81%86>\nが参考になるかな?","ts":"1568708575.052200","attachments":[{"fallback":"Qiita: tmux on iTerm2 で斜体 &amp; True Color を使う - Qiita","id":1,"title":"tmux on iTerm2 で斜体 &amp; True Color を使う - Qiita","title_link":"https://qiita.com/delphinus/items/b8c1a8d3af9bbacb85b8#%E6%9B%B4%E3%81%AB-true-color-%E3%82%92%E4%BD%BF%E3%81%86","text":"_True Color も Italic (Oblique) Font も表示できないなんて 20 世紀までだよねー_ と言いたいところですが、以外と時間がかかりました。iTerm2 3.0 &amp; tmux 2.2 以降でこれ...","thumb_url":"https://cdn.qiita.com/assets/qiita-fb-2887e7b4aad86fd8c25cea84846f2236.png","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-f9a6afad761ec2306e10db2736187c8b.png","thumb_width":200,"thumb_height":200,"from_url":"https://qiita.com/delphinus/items/b8c1a8d3af9bbacb85b8#%E6%9B%B4%E3%81%AB-true-color-%E3%82%92%E4%BD%BF%E3%81%86","original_url":"https://qiita.com/delphinus/items/b8c1a8d3af9bbacb85b8#%E6%9B%B4%E3%81%AB-true-color-%E3%82%92%E4%BD%BF%E3%81%86"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"286579fb-6d4c-4633-9442-1baf8dd15388","type":"message","user":"ULSHV7A6R","text":"追加の設定は行っていたのに反映されなかったのですが、tmuxを再起動したら反映されました。\ntmuxってすべてのウィンドウを閉じないと設定が再読込されないんですね。\n失礼しました。","ts":"1568709666.054400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"949ea6f5-6550-464e-9256-f71cfc6721a0","type":"message","user":"U9S4G0LJW","text":"あれ、デーモンみたいなものが立ち上がってますからね","ts":"1568709728.055500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"18fad43b-1483-4469-9d32-44d465d95948","type":"message","user":"U7CGPB4NR","text":"`bind r source-file ~/.tmux.conf` というのをtmux.conf に書いておくと、 `&lt;prefix&gt;r` で設定をリロードできて便利です。","ts":"1568709746.055900","team":"T03C4RC8V","reactions":[{"name":"banjaku","count":2,"users":["U9S4G0LJW","U8CC7MDCL"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dfb80e82-cacc-413a-873d-afd985a15c09","type":"message","user":"ULSHV7A6R","text":"ありがとうございます！","ts":"1568709764.056500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8c98912e-127b-4deb-a791-ee4be45270f7","type":"message","user":"U7CGPB4NR","text":"多分これを書かなくても `&lt;prefix&gt;:source-file ~/.tmux.conf` みたいに直接もできます。vi modeじゃない場合はちょっとキーバインドが違うかも知れません","ts":"1568709809.057300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"249a8a51-c512-46ba-9ade-2ccad4e424ea","type":"message","user":"ULSHV7A6R","text":"vi modeなのでそのコマンドでも再読込できることを確認できました。ありがとうございます。","ts":"1568709892.058300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6a08b170-ee48-4c44-8719-8de53975151f","type":"message","user":"UDDCM376D","text":"tmuxはステータスバーの設定は反映されますが\n一部の設定はデーモンを再起動しないと反映されないみたいですね","ts":"1568710407.059100","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":2,"users":["U7CGPB4NR","ULYNZQPT7"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e6408e6f-92a7-4a1e-b08b-51bfd6b7b493","type":"message","user":"ULSHV7A6R","text":"また質問で恐縮なのですが、Neovimでpython2 providerを無効化しても、PCにpython2をインストールしていない場合に、checkhealthでエラーが出るのはなぜでしょうか？\n以下、設定です。\nlet g:loaded_python_provider = 0\nlet g:python_host_prog = ''","ts":"1568712977.061700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c5d31efd-bf9e-48bb-ad75-472618335838","type":"message","user":"UDDCM376D","text":"neovim使っていないのであまりわかっていないのですが、\nどんなエラーですか？","ts":"1568713456.062400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"33de723b-0a6a-4a18-98c9-495d330c853d","type":"message","user":"ULSHV7A6R","text":"以下のようなエラーです。python2は無効化にしてあるのに発生しています。\n## Python 2 provider (optional)\n  - INFO: Disabled (g:loaded_python_provider=0).  This might be due to some previous error.\n  - INFO: Using: g:python_host_prog = \"\"\n  - WARNING: No Python executable found that can `import neovim`. Using the first available executable for diagnostics.\n  - ERROR: Python provider error:\n    - ADVICE:\n      - provider/pythonx: Could not load Python 2:\n          python2 not found in search path or not executable.\n          /usr/bin/python2.7 does not have the \"neovim\" module. :help |provider-python|\n          python2.6 not found in search path or not executable.\n          /usr/bin/python does not have the \"neovim\" module. :help |provider-python|\n  - INFO: Executable: Not found","ts":"1568714607.062500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2069e6cc-beee-42c8-bd19-b8b19baec803","type":"message","user":"U7JL1UKKL","text":"そのエラーはneovim開発者に聞いた方がよいと思う","ts":"1568714734.063200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fa10a761-2a70-4e97-b6d6-f791834d1861","type":"message","user":"U7JL1UKKL","text":"あー、エラーを見るに無効にしてるから発生してるぽい","ts":"1568714781.063800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b5811c9a-8c68-48be-9d18-d2ff2531697f","type":"message","user":"U7JL1UKKL","text":"チェックを無効にできるかはよくわからないので","ts":"1568714791.064200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e8f4f44f-9b91-44b9-b800-4644e615f367","type":"message","user":"U7JL1UKKL","text":"How do I disable Python2 provider check in checkhealth?\nという感じかな","ts":"1568715075.065400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7a185f37-93ae-425e-a603-e62f6dd0c15e","type":"message","user":"ULSHV7A6R","text":"わざわざ英文まで提示していただきありがとうございます。\nissueを投げてみました。","ts":"1568717284.066300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UNERGGR32","text":"<@UNERGGR32> has joined the channel","ts":"1568719606.066500","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"bcacee45-d9f2-453a-a52d-1e1a0eabf682","type":"message","user":"ULSHV7A6R","text":"英語に自信ないのですが、Bugとして認識いただけたようです。\n<https://github.com/neovim/neovim/issues/11040>","ts":"1568720394.067200","attachments":[{"fallback":"GitHub: How do I disable Python2 provider check in checkhealth? · Issue #11040 · neovim/neovim","id":1,"title":"How do I disable Python2 provider check in checkhealth? · Issue #11040 · neovim/neovim","title_link":"https://github.com/neovim/neovim/issues/11040","text":"init.vim let g:loaded_python_provider = 0 let g:python_host_prog = &amp;#39;&amp;#39; Checkhealth message. ## Python 2 provider (optional) - INFO: Disabled (g:loaded_python_provider=0). This might be due t...","thumb_url":"https://avatars0.githubusercontent.com/u/6471485?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/neovim/neovim/issues/11040","original_url":"https://github.com/neovim/neovim/issues/11040"}],"edited":{"user":"ULSHV7A6R","ts":"1568720503.000000"},"team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29f63226-56e2-499c-ab57-bc5fbe9f1d33","type":"message","user":"U7JL1UKKL","text":"バグだったか","ts":"1568721978.067700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d72069fd-1ae8-4ddf-a880-67f28e3d0ac2","type":"message","user":"U7JL1UKKL","text":"そういうコードはなさそうに思っていた","ts":"1568721990.068100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
