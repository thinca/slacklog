[{"client_msg_id":"a6f208b6-666c-4351-b2e9-6e371b0ccedf","type":"message","user":"U03C71D7H","text":"blocks 対応やれる人がいるとめっちゃ助かりますねぇ","ts":"1589938971.382900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1BOKa"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e5d1a048-96a9-4bfc-a37b-f952a2f7d9c0","type":"message","user":"U06ECBRTJ","text":"可変な json 要素にどう対応するかが焦点ですね…\n`text` という要素に、文字列とオブジェクト、両方が入ることがあるので…(大体 Polly のせい","ts":"1589939125.384400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RFEe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U014B342RCZ","text":"<@U014B342RCZ> has joined the channel","ts":"1589940673.384600","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"dec2419e-abfd-4aa8-ae3d-44db8ed94e46","type":"message","user":"U03C71D7H","text":"その辺りは KoRoN さんが slack-go を fork したやつを使うようにしたのもあって、block 関係の struct もこの中に入っているのでなんかいい感じに扱えるのではないだろうか (ライブラリの中をちゃんと見てないけど)\n<https://github.com/vim-jp/slacklog-slack/blob/slacklog/block.go>","ts":"1589947257.386100","attachments":[{"fallback":"GitHub: vim-jp/slacklog-slack","id":1,"title":"vim-jp/slacklog-slack","title_link":"https://github.com/vim-jp/slacklog-slack/blob/slacklog/block.go","text":"Slack API in Go - community-maintained fork created by the original author, @nlopes - vim-jp/slacklog-slack","thumb_url":"https://avatars2.githubusercontent.com/u/1051958?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/vim-jp/slacklog-slack/blob/slacklog/block.go","original_url":"https://github.com/vim-jp/slacklog-slack/blob/slacklog/block.go"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sD+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"026c6e4c-3926-4781-a29e-1cf49ebbd538","type":"message","user":"U03C71D7H","text":"あと Polly がバグってるとかでなければ Block は Slack が定めている仕様なので Polly は悪くないはずだよ\n<https://api.slack.com/reference/block-kit/blocks>","ts":"1589947362.387000","attachments":[{"fallback":"Slack: Reference: Layout blocks","id":1,"title":"Reference: Layout blocks","title_link":"https://api.slack.com/reference/block-kit/blocks","text":"Learn how to build bot users, send notifications, and interact with workspaces using our APIs.","thumb_url":"https://a.slack-edge.com/80588/img/services/api_200.png","blocks":null,"service_name":"Slack","service_icon":"https://a.slack-edge.com/80588/marketing/img/meta/favicon-32.png","thumb_width":200,"thumb_height":200,"from_url":"https://api.slack.com/reference/block-kit/blocks","original_url":"https://api.slack.com/reference/block-kit/blocks"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"E32O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"54732254-0754-4fbf-bd57-29d38e18b179","type":"message","user":"UAZ33BKV2","text":"(slackに投稿できてる時点でslack側のメッセージの枠におさまる状態になってるはず/情報の保持の責務はslackにある、はず?)","ts":"1589947518.388100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6XZIO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"333d1fcc-49d6-46b5-98f6-8d67ac2b4155","type":"message","user":"U03C71D7H","text":"そのはずですね","ts":"1589947554.388300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KDy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21565831-5b96-4a83-96b6-5bd49f854f62","type":"message","user":"U03C71D7H","text":"Block の仕様が複雑で、再実装(再レンダリング)しようとしている我々がつらいと言うだけで Polly も Slack も別に悪くはない","ts":"1589947612.389100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XXm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f628bf8d-ec3f-44ac-810a-f320142e6ccb","type":"message","user":"U06BRP8VD","text":"僕がちょっと気になってるのは、最初期のログにも Blocks ってあるのかしら? それがあるなら Blocks に bet all で良い。","ts":"1589948084.390600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UD/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"48ab0710-0802-434a-8266-1228c6c05d07","type":"message","user":"U06BRP8VD","text":"実はあとから Block 導入されてて、それ以前のtextはtextで残さなきゃダメってなると、かなりツライ。","ts":"1589948108.391100","edited":{"user":"U06BRP8VD","ts":"1589948118.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rYLd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8200d134-9e29-480d-a4ed-e7d6c99c3b3e","type":"message","user":"U03C71D7H","text":"どっちもあります…","ts":"1589948122.391600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pkSvq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"343226c0-c7e3-44ef-a7e6-11354e8f76b3","type":"message","user":"U06ECBRTJ","text":"後からなはずですね…","ts":"1589948131.392200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KxEj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"523d6083-129c-4213-bbc5-b145dabd53d0","type":"message","user":"U06BRP8VD","text":"「どっちもある」とは?","ts":"1589948141.392500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"J5002"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"54a85c33-c285-41f0-bf43-1d6b05385388","type":"message","user":"U03C71D7H","text":"と言うか今でも block ある場合とない場合があるはず…","ts":"1589948145.392600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ttdj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"268086cc-1320-40c7-9576-57af4ce88949","type":"message","user":"U03C71D7H","text":"block がある場合とない場合がある、です","ts":"1589948163.393000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3Efh9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b005c516-a04f-4d47-85fa-4d38bd343103","type":"message","user":"U06BRP8VD","text":"まじかー","ts":"1589948197.393200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Gbq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6d221f14-e3a3-4e57-8393-fd545230d4eb","type":"message","user":"U06BRP8VD","text":"ああ、メッセージに特殊要素が無い=プレーンテキストだけの場合はblockなくても良いんだけど。","ts":"1589948234.394000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WCy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b3bf1188-f9d4-428c-9c3d-7d122e4e237b","type":"message","user":"U06BRP8VD","text":"そのチェックがいるかな。","ts":"1589948240.394200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r3lG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c9bbf9f-8b82-461a-a6b2-9d1ed12a642d","type":"message","user":"U06BRP8VD","text":"textのパースが不要になる状況が好ましい。","ts":"1589948264.394900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"LEbr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bb259ab3-e39c-4ca3-a622-d52db222f353","type":"message","user":"U03C71D7H","text":"理想は、block がある場合はそちらをレンダリング、ない場合は text をレンダリング、になるんじゃないかなーと思っています","ts":"1589948273.395200","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"84bG5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"63291422-8451-44b3-b3c4-d8440c9d17fa","type":"message","user":"U03C71D7H","text":"たぶん。改めて確認はした方がよさそう…","ts":"1589948292.395700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"blzD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"268c179e-2743-4088-bc66-34f6dcddd388","type":"message","user":"UAZ33BKV2","text":"textだけのblockに先に変換しておいて、レンダリングはblockだけがんばる、というのもある?\nフロントでがんばるのも大変そう...(どっちの場合も)","ts":"1589948313.396200","edited":{"user":"UAZ33BKV2","ts":"1589948325.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7192w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9c26e37-a3a9-4901-8715-b0284f82b5b7","type":"message","user":"U03C71D7H","text":"1つ勘違いをしていたけど、最近のログは blocks は全部付いてるのか (パッと眺めた限り)","ts":"1589948415.396900","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zVh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eb4df83f-5f4b-4508-9508-e700b3aff67f","type":"message","user":"U06BRP8VD","text":"textしかないやつは、もうフォーマット諦めて良いんじゃないかな。","ts":"1589948996.397400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nMEG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8f580f4f-8b2e-4b91-9ac6-7281bcab3775","type":"message","user":"U03C71D7H","text":"今くらいの雑な感じでひとまずはいいんじゃないでしょうか","ts":"1589949050.397800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BeJD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6b329f60-f5e4-45cc-835f-624828613a50","type":"message","user":"U03C71D7H","text":"完璧はたぶん無理なので、変なレンダリングを見付けたら報告だけはしておく。直せたら直す (優先度低) みたいな","ts":"1589949113.398800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SicR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd2b9c9a-efe4-41c7-a5e3-c51a590708f3","type":"message","user":"U06BRP8VD","text":"できれば text の parse は完全に落としたい。","ts":"1589949165.399400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8eKn6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"679b24da-a418-48be-8abe-acbc1cbd85e8","type":"message","user":"U03C71D7H","text":"完全に落とすと改行すらされなくなりますが…","ts":"1589949186.400000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dUo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c1ae8083-ad97-48eb-bdd7-3a18708117d6","type":"message","user":"U06BRP8VD","text":"Blocks には改行ないといってる?","ts":"1589949221.400500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SUNu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f913dd29-432c-4d48-ad98-f055d6ea2289","type":"message","user":"U06BRP8VD","text":"落とすのはもちろん Blocks 対応できたらだけど。","ts":"1589949231.400900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Iu3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"01514270-2749-4e4f-9718-c1899c3b8fee","type":"message","user":"U03C71D7H","text":"Blocks にも改行はあります","ts":"1589949262.401100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zs+aI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d5d09cc6-6370-4437-8516-a5f56e5b950f","type":"message","user":"U03C71D7H","text":"parse まではやらなくてもいいと思うんですが現状やってる簡単な置換くらいはやらないと、メンションやチェンネルへの参照が全部 ID で表示されてしまうので結構つらい気がします…","ts":"1589949593.402100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4PP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"279bbc0d-2c06-42ed-8920-e44f883eb8b3","type":"message","user":"U06BRP8VD","text":"Blocks にはそれら全部 parse 済みで入ってるでしょ? あとはどのくらいの数のメッセージに Blocks がないのか(textだけでやらなきゃいけないのか)で、その量次第では切り捨てるべきだと僕は考えてる。\n\nどうしてかっていうと、あの手のがあると template (フロント)側と generator 側の両方で対応コードをメンテしなきゃいけない。でそれは重い負債になる。\n\nもし仮に text しかないのを救うのなら、自前で text から Blocks を構築するべきところ。","ts":"1589949927.405100","edited":{"user":"U06BRP8VD","ts":"1589949986.000000"},"team":"T03C4RC8V","reactions":[{"name":"tiken","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EgKaj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"329d05c7-e9a1-4dd9-8dca-6da5401fb178","type":"message","user":"U03C71D7H","text":"random のログを雑に grep したところ、blocks の初登場は 2019-11-06。それ以前には blocks は存在しないようです。\nblocks 自体かなり最近入った機能です。","ts":"1589950263.406300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5MdHX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2815695e-b3c8-40a1-8fe8-90045aa6984c","type":"message","user":"U06BRP8VD","text":"んじゃ自前で text から Blocks 構築だな","ts":"1589950364.407400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xln5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1de591ae-7332-4658-994c-ef4065f5c9e3","type":"message","user":"U06BRP8VD","text":"フロント側が Blocks だけみてレンダリングできるようにすれば盤石","ts":"1589950396.408100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lMUy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fafa2ff5-2df4-41c4-9765-2a001e780492","type":"message","user":"U03C71D7H","text":"2019-11-06 のも polly のものでした。通常の発言には blocks はついておらず。2019-11-20 から一部の発言に blocks が付くようになっているな…過渡期かなぁ","ts":"1589950483.408800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VI0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"40605240-1769-4f82-ae99-f5be93fb0110","type":"message","user":"U03C71D7H","text":"text → Blocks できるようになると便利そうだけど結構大変そうだ","ts":"1589950515.409300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"A8n"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b31be81e-c2a2-42c9-a232-166def9faea7","type":"message","user":"U03C71D7H","text":"Blocks 自体のレンダリングに比べればまだなんとかなりそうな気もする (わからんけど)","ts":"1589950608.410800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0we"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7b4a747a-9e26-42ce-a63f-154468869581","type":"message","user":"U06BRP8VD","text":"そこが責任分界点として正しいし、たぶんなんちゃってparse&amp;render維持するよりは楽。","ts":"1589950611.410900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5/S"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c5f12979-a9c3-4d68-b469-0896da9d0cc8","type":"message","user":"U6XP9LZ6V","text":"WYSIWYG が入ったあたりかな？","ts":"1589950658.411300","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Z4AbK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5243c9a6-72ee-442a-972c-401d77e69c73","type":"message","user":"U03C71D7H","text":"そんな感じがしますね &gt;変わったタイミング","ts":"1589950670.411600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y6Glg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"456B7580-5034-4B6E-9B55-C492E2BE42A5","type":"message","user":"U78A6ESHM","text":"しばらく忙しくて進捗だせなさそう :fire: ","ts":"1589982276.412700","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U06BRP8VD"]},{"name":"iinoyo","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"v8sc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
