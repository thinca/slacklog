[{"type":"message","user":"UMXBVCCSJ","text":"<@UMXBVCCSJ> has joined the channel","ts":"1569060420.035700","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"f8e9a6dc-508f-4199-9672-f86bcaa96433","type":"message","user":"UGYM5NT2T","text":"`助けてください`\nNGINXを用いてURLによって、2つの異なるNodeアプリにアクセスを振り分けたいのですが上手く行かなくて苦戦しています。。\n以下、docker-compose.yml と NGINXのdefoult.confの画像です。もし何か怪しい点があったら教えてほしいです。","ts":"1569064132.041000","thread_ts":"1569064132.041000","edited":{"user":"UGYM5NT2T","ts":"1569064800.000000"},"reply_count":18,"replies":[{"user":"U8R597E9H","ts":"1569065805.041500"},{"user":"UGYM5NT2T","ts":"1569065915.041700"},{"user":"U8R597E9H","ts":"1569066038.041900"},{"user":"UGYM5NT2T","ts":"1569066153.043100"},{"user":"U8R597E9H","ts":"1569066287.043300"},{"user":"UGYM5NT2T","ts":"1569066666.043500"},{"user":"UJ70JTGR3","ts":"1569069976.047800"},{"user":"UGYM5NT2T","ts":"1569070066.048600"},{"user":"UJ70JTGR3","ts":"1569070152.049900"},{"user":"UJ70JTGR3","ts":"1569070187.050600"},{"user":"UJ70JTGR3","ts":"1569070280.051300"},{"user":"U8CC7MDCL","ts":"1569070358.051700"},{"user":"UJ70JTGR3","ts":"1569070473.053500"},{"user":"UGYM5NT2T","ts":"1569070759.053800"},{"user":"UJ70JTGR3","ts":"1569070853.055000"},{"user":"U8CC7MDCL","ts":"1569070952.057400"},{"user":"U8CC7MDCL","ts":"1569071123.057700"},{"user":"UGYM5NT2T","ts":"1569072470.057900"}],"files":[{"id":"FNLFMM4H3","created":1569064129,"timestamp":1569064129,"name":"image.png","title":"image.png","mimetype":"image/png","image_exif_rotation":1,"filetype":"png","pretty_type":"PNG","user":"UGYM5NT2T","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":853090,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FNLFMM4H3/image.png","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FNLFMM4H3/download/image.png","original_h":1254,"original_w":2420,"thumb_64":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_64.png","thumb_80":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_80.png","thumb_160":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_160.png","thumb_360":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_360.png","thumb_360_gif":"","thumb_360_w":360,"thumb_360_h":187,"thumb_480":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_480.png","thumb_480_w":480,"thumb_480_h":249,"thumb_720":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_720.png","thumb_720_w":720,"thumb_720_h":373,"thumb_960":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_960.png","thumb_960_w":960,"thumb_960_h":497,"thumb_1024":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_1024.png","thumb_1024_w":1024,"thumb_1024_h":531,"permalink":"https://vim-jp.slack.com/files/UGYM5NT2T/FNLFMM4H3/image.png","permalink_public":"https://slack-files.com/T03C4RC8V-FNLFMM4H3-a791814e35","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"thumb_800":"https://files.slack.com/files-tmb/T03C4RC8V-FNLFMM4H3-c5772db806/image_800.png","thumb_800_h":415,"thumb_800_w":800,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"8b7c1ad4-e728-4f42-b66d-5bb80e48723f","type":"message","user":"U8R597E9H","text":"docker-compose.yml の nginx のところにある「depends_on」を「link」にするとどうでしょうか。","ts":"1569065805.041500","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d9eae8e0-b021-484f-9222-05e9279b25a5","type":"message","user":"UGYM5NT2T","text":"やってみましたが変わらないです。。","ts":"1569065915.041700","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4e90e60e-6925-4786-87bb-b54939cf8ff4","type":"message","user":"U8R597E9H","text":"ぎゃ、links でした。すいません。","ts":"1569066038.041900","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"B7CB3BFF-0717-46B1-839E-4E1B4DC767BE","type":"message","user":"UGYM5NT2T","text":"はい。linksでやってみましたがリバースプロキシの不具合に直接的な影響は無いっぽいです。。","ts":"1569066153.043100","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"83553010-16f5-4d31-96d3-b4edb231faf7","type":"message","user":"U8R597E9H","text":"あとは `location /` に `/master` もヒットしてしまっているとかですかね。。。？ちょっとわからないです :bow:","ts":"1569066287.043300","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3aafd7ea-8540-4746-878d-3a5969abdd9c","type":"message","user":"UGYM5NT2T","text":"いえ！参考になります。ありがとうございます！","ts":"1569066666.043500","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"A20CC13F-EBBB-44D9-911E-33594CD3E20B","type":"message","user":"UJ70JTGR3","text":"ちょっとみましたがこれ今はどういう状況ですか？設定見る限りguestの方にだけうまくアクセスできる状況見えますが違うでしょうか？","ts":"1569069976.047800","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b02ea303-2dd1-46c8-bba2-9e5827f2c0be","type":"message","user":"UGYM5NT2T","text":"そうです！8080でアクセスしてもguestにしかアクセス出来ない状況です。。","ts":"1569070066.048600","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2EDD5A6B-E953-465E-AF7F-72BB7757291D","type":"message","user":"UJ70JTGR3","text":"もしそうならmasterの方のproxyの設定を\n\n<http://master:3000/>\n\nにしてみてください\n","ts":"1569070152.049900","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U8CC7MDCL"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51FAC0F5-0B96-4128-830E-380585BD69DC","type":"message","user":"UJ70JTGR3","text":"スマホのキーボードからバッククオートが探せない...","ts":"1569070187.050600","thread_ts":"1569064132.041000","edited":{"user":"UJ70JTGR3","ts":"1569070258.000000"},"parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"AF53B964-CE74-4FD0-BFC8-AF0B74F8216D","type":"message","user":"UJ70JTGR3","text":"proxy_passの項目です","ts":"1569070280.051300","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a3b03c0d-0b0b-4ab5-b489-e31935f954ad","type":"message","user":"U8CC7MDCL","text":"portsの項目はコンテナのポートとホストのポートの紐付けを行うものなので、直接master/guestにアクセスする必要が無ければmaster/guestのports項目は無くていいですね。\nあとはippachiさんの書くとおりポート3000でOKです","ts":"1569070358.051700","thread_ts":"1569064132.041000","edited":{"user":"U8CC7MDCL","ts":"1569070499.000000"},"parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59D07DB2-E6C3-4D03-BEAD-03DFE55D85FE","type":"message","user":"UJ70JTGR3","text":"そうですね\nこの場合nginxとnodeのコンテナ間の通信で閉じていてホストを介していないのでportsの設定は必要ないと思います","ts":"1569070473.053500","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8def6bbb-e324-400c-8246-74d55722f508","type":"message","user":"UGYM5NT2T","text":"docker-composeの21行目のport指定も `3000:3000` でいいということでしょうか？","ts":"1569070759.053800","thread_ts":"1569064132.041000","edited":{"user":"UGYM5NT2T","ts":"1569070822.000000"},"parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"B8CE027D-0F23-4BB4-B542-F0C6702B077C","type":"message","user":"UJ70JTGR3","text":"いえguest、masterともにportの指定自体が必要ないです","ts":"1569070853.055000","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29f7ac07-a2b0-45c8-a21b-ddd244f043ee","type":"message","user":"U8CC7MDCL","text":"portsは上に書いたとおり\n&lt;ホストポート&gt;:&lt;コンテナポート&gt;\nの紐付け設定なので、proxy経由でのアクセスのみにしたいのであればportsの設定は特にいりません","ts":"1569070952.057400","thread_ts":"1569064132.041000","edited":{"user":"U8CC7MDCL","ts":"1569071044.000000"},"parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c91cf620-2a85-4f5e-945b-ae9950340612","type":"message","user":"U8CC7MDCL","text":"あとはdefault.confの18行目のポートを3000に直せば繋ると思います。","ts":"1569071123.057700","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f41020c5-0e5e-4dd3-85d5-e55fee05c9d6","type":"message","user":"UGYM5NT2T","text":"出来ました！本当助かりました。。\n丁寧に教えて頂きありがとうございます！！","ts":"1569072470.057900","thread_ts":"1569064132.041000","parent_user_id":"UGYM5NT2T","team":"T03C4RC8V","reactions":[{"name":"tada","count":2,"users":["UJ70JTGR3","U8CC7MDCL"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
