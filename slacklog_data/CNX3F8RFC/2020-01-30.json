[{"client_msg_id":"ef6685f4-af98-4fb8-8883-14dee1de0e01","type":"message","user":"U03C4RC8X","text":"vimrcでやろうとしたけどできなかった件についてブログ記事書きました <https://ujihisa.wordpress.com/2020/01/29/how-to-prioritize-deopletes-filename-completion-higher-than-others-but-less-than-vimshell/>","ts":"1580334971.011600","attachments":[{"fallback":"standards Link: How to prioritize deoplete&#8217;s filename completion higher than others but less than&nbsp;vimshell","id":1,"author_name":"ujihisa","author_link":"https://ujihisa.wordpress.com/author/ujihisa/","title":"How to prioritize deoplete’s filename completion higher than others but less than vimshell","title_link":"https://ujihisa.wordpress.com/2020/01/29/how-to-prioritize-deopletes-filename-completion-higher-than-others-but-less-than-vimshell/","text":"deoplete:&nbsp;https://github.com/Shougo/deoplete.nvim/\nvimshell:&nbsp;https://github.com/Shougo/vimshell.vim\nProblem\nWhen I auto-complete filenames/dirnames, particularly when it prefixes ./ or ~/, I always expect filename completions comes first, and I don&rsquo;t need other completions; they are just noise. In vimshell it works as I expect, but in cmdwin buffer which filetype is vim it doesn&rsquo;t work as I expect.\ngood (vimshell):\n\nbad (cmdwin, which means filetype=vim): \n&nbsp;\nI tried solving this by setting filetype priority into deoplete, but it didn&rsquo;t work:\ncall deoplete#custom#source('file', 'rank', 1000)\nBecause vimshell&rsquo;s completion rank is 500, filetype completion for vim&rsquo;s rank is 500, and filename completion rank is 150. The higher the rank is the higher the candidates appear. The number 500 is the default rank for arbitrary omni-completions.\n&nbsp;\nSolution\nJust patch the rank locally against vimshell and deoplete&rsquo;s file source. It&rsquo;s dirty but it works.\ndeoplete:\ndiff --git a/rplugin/python3/deoplete/source/file.py b/rplugin/python3/deoplete/source/file.py\nindex 910dde6..24576de 100644\n--- a/rplugin/python3/deoplete/source/file.py\n+++ b/rplugin/python3/deoplete/source/file.py\n@@ -22,7 +22,7 @@ class Source(Base):\nself.name = 'file'\nself.mark = '[F]'\nself.min_pattern_length = 0\n- self.rank = 150\n+ self.rank = 550\nself.events: typing.List[str] = ['InsertEnter']\nself.vars = {\n'enable_buffer_path': True,\nvimshell:\ndiff --git a/rplugin/python3/deoplete/sources/vimshell.py b/rplugin/python3/deoplete/sources/vimshell.py\nindex 0f36424..a5e9eff 100644\n--- a/rplugin/python3/deoplete/sources/vimshell.py\n+++ b/rplugin/python3/deoplete/sources/vimshell.py\n@@ -36,7 +36,7 @@ class Source(Base):\nself.mark = '[vimshell]'\nself.filetypes = ['vimshell']\nself.is_bytepos = True\n- self.rank = 500\n+ self.rank = 600\n\ndef get_complete_position(self, context):\nreturn self.vim.call('vimshell#complete#get_keyword_position')\n&nbsp;\nNow they works as below.\nvimshell:\n\ncmdwin:\n\nYes!","thumb_url":"https://i2.wp.com/i.gyazo.com/f0c8647be8423cbc336b666664236d9c.png?fit=200%2C150&ssl=1","blocks":null,"service_name":"standards","service_icon":"https://s2.wp.com/i/webclip.png","thumb_width":200,"thumb_height":109,"from_url":"https://ujihisa.wordpress.com/2020/01/29/how-to-prioritize-deopletes-filename-completion-higher-than-others-but-less-than-vimshell/","original_url":"https://ujihisa.wordpress.com/2020/01/29/how-to-prioritize-deopletes-filename-completion-higher-than-others-but-less-than-vimshell/"}],"team":"T03C4RC8V","reactions":[{"name":"subara","count":1,"users":["UAZ33BKV2"]},{"name":"eyes","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y=x6p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0267beef-7c03-4b06-9fc9-01008d101000","type":"message","user":"U03C4RC8X","text":"めっちゃ便利・・・","ts":"1580334975.011900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gIL6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cb05e2ee-f4ca-403b-b5cb-06dd92ce9be4","type":"message","user":"U03C71D7H","text":"anyenv から asdf に乗り換えようかと思って試しているんですが、 Mac で asdf-lua で lua 入れようとするとビルド時にリンクエラーで死んでしまう…","ts":"1580357314.013100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"weih"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"453a2c5a-31b6-4085-b8d7-be8ce2b72b44","type":"message","user":"U03C71D7H","text":"asdf を Mac で使ってて Lua 入れてるって人はいませんか?","ts":"1580357334.013600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IHu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"45879977-5532-47c8-926d-a522c51b4125","type":"message","user":"U7B4ZD49X","text":"asdf知らなかったです。私も乗り換えよーっと","ts":"1580357626.014000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0IdM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8d7f4565-7716-45e2-850e-543c211e16c4","type":"message","user":"U03C6TEAZ","text":"asdf と聞くと common lisp を思い出すマン","ts":"1580357667.014300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Yom"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0c4af8b4-dfed-49c6-8382-1851073189b7","type":"message","user":"U7B4ZD49X","text":"ZpluginがZinitになっとるｗ\n<https://github.com/zdharma/zinit>","ts":"1580363801.014800","attachments":[{"fallback":"GitHub: zdharma/zinit","id":1,"title":"zdharma/zinit","title_link":"https://github.com/zdharma/zinit","text":"Flexible Zsh plugin manager with clean fpath, reports, completion management, turbo mode, annexes, services, packages - zdharma/zinit","thumb_url":"https://avatars2.githubusercontent.com/u/26310601?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":220,"thumb_height":220,"from_url":"https://github.com/zdharma/zinit","original_url":"https://github.com/zdharma/zinit"}],"team":"T03C4RC8V","reactions":[{"name":"eyes","count":1,"users":["U72TB62UF"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r9C"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9C9DFA3C-B3AB-4329-AF03-62117567A3DD","type":"message","user":"U8996GYBF","text":"おっ","ts":"1580364830.015200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wRwNT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"F5F1F3FB-B7B4-467E-BF6F-8F880BDE2ED8","type":"message","user":"U8996GYBF","text":"使い方は大体一緒・・・？","ts":"1580364846.015700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6WQB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fc469b99-ec80-432a-8578-d969d3aa2ca6","type":"message","user":"UBNPMJJGM","text":"たぶん単にリネームしただけですね &gt; zinit\nコマンドとディレクトリ変えれば移行完了","ts":"1580367106.015800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JujTn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3fe46c89-1616-4f5b-b8f7-cc14fe0cc477","type":"message","user":"UBNPMJJGM","text":"GitHubのリダイレクト嫌な人はremote情報も変えないとか","ts":"1580367214.015900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Inf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"81B8F0E0-BC29-444B-B512-5B8E741A98C8","type":"message","user":"U80CX6XDZ","text":"ちょっと前何回もzpluginをググってもzinitしか出てこなかったので、焦りました。","ts":"1580377368.017200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cw0QJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"URB072GTU","text":"<@URB072GTU> has joined the channel","ts":"1580378350.017400","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"2526deea-1602-42f5-b3c4-fd805ee8b11f","type":"message","user":"U7B4ZD49X","text":"とりあえずzshrcのzpluginをzinitにリネームしたらちゃんと動いたのでよかったです :smile:","ts":"1580378665.018500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cOl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"308b674f-44ed-44a6-87f0-4bafdfb057dc","type":"message","user":"U7B4ZD49X","text":"asdf導入してみましたが、zinitの設定これでよいのかわからない・・・利用者がなぜかあまりいない・・・\n<https://github.com/yutakatay/dotfiles/blob/2509a0126935010304f3b1f6b622c284021b1cfc/.zsh/rc/pluginlist.zsh#L126>","ts":"1580379043.019400","attachments":[{"fallback":"GitHub: yutakatay/dotfiles","id":1,"title":"yutakatay/dotfiles","title_link":"https://github.com/yutakatay/dotfiles/blob/2509a0126935010304f3b1f6b622c284021b1cfc/.zsh/rc/pluginlist.zsh#L126","text":"The best and strongest dotfiles. Contribute to yutakatay/dotfiles development by creating an account on GitHub.","thumb_url":"https://avatars3.githubusercontent.com/u/8683947?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":312,"thumb_height":312,"from_url":"https://github.com/yutakatay/dotfiles/blob/2509a0126935010304f3b1f6b622c284021b1cfc/.zsh/rc/pluginlist.zsh#L126","original_url":"https://github.com/yutakatay/dotfiles/blob/2509a0126935010304f3b1f6b622c284021b1cfc/.zsh/rc/pluginlist.zsh#L126"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jTEF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b63a5619-f2cc-410d-9545-6ae7a87f0919","type":"message","user":"U03C71D7H","text":"zsh 使ってるけど zinit みたいなプラグインマネージャには未だに手を出していない…","ts":"1580379154.019900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mLi="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"73743d3c-8762-4d97-ab66-5c2c19b731ca","type":"message","user":"U7B4ZD49X","text":"プラグインなくてもそこそこ機能しますしね。","ts":"1580379197.020500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"m/s="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f860dba5-1267-4276-8e65-d418b2b82617","type":"message","user":"U03C71D7H","text":"asdf-lua が Mac で使えるかよかったら確認してほしい…","ts":"1580379209.020800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Rol"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"06dbd39b-31fc-4830-b9a2-465eac3df2f6","type":"message","user":"U7B4ZD49X","text":"Mac環境持ってないです :cry:","ts":"1580379236.021100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5OLnG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4cf75e25-8e2f-44b0-969e-7a8eb47cc3ed","type":"message","user":"U03C71D7H","text":":munen:","ts":"1580379295.021300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZqF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7f73ba6d-979b-4d1f-9728-f521d0513ea2","type":"message","user":"U03C71D7H","text":"Mac 窓から投げ捨てたい","ts":"1580379316.021700","team":"T03C4RC8V","reactions":[{"name":"+1","count":2,"users":["U7B4ZD49X","U7CGPB4NR"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d9Mrm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"94ba3b4f-0afc-4818-b5ab-b2d50de66369","type":"message","user":"U03C71D7H","text":"仕事でなければ絶対に使わない…","ts":"1580379336.022000","team":"T03C4RC8V","reactions":[{"name":"sorena","count":2,"users":["UD1FQV38V","UEB17JJJE"]},{"name":"laughing","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HDkND"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"53abd88d-32c6-4672-8f72-5b9bc424bedc","type":"message","user":"UEB17JJJE","text":"明日時間作れたらMacで試してみますね","ts":"1580394057.022800","team":"T03C4RC8V","reactions":[{"name":"subara","count":2,"users":["U7B4ZD49X","U03C71D7H"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oHv6v"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
