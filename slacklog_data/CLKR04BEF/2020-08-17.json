[{"client_msg_id":"df682a35-f40d-49fa-b226-322cc2feafa5","type":"message","user":"U03C6TEAZ","text":"逆に access でやるなら stat いる？","ts":"1597674830.013800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2Kx"}]},{"client_msg_id":"d7c76f47-fa46-4cf0-a7e3-7cdb6009e0da","type":"message","user":"U03C6TEAZ","text":"`S_IEXEC` って無かったっけ。","ts":"1597674727.013200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+LJ"}]},{"client_msg_id":"04cebc54-521d-42cf-8c32-05e59fa6cf9c","type":"message","user":"U03C6TEAZ","text":"これ mch_access せなあかんのかな。","ts":"1597674687.012700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vgju+"}]},{"client_msg_id":"884eeadf-f954-4537-9941-87b2aa2776e1","type":"message","user":"U03C6TEAZ","text":"\u003chttps://github.com/vim/vim/blob/a1b9b0cc011ef15869ac25cb93e1b4baa0cb7f38/src/os_unix.c#L3131\u003e","ts":"1597674680.012300","attachments":[{"fallback":"GitHub: vim/vim","id":1,"title":"vim/vim","title_link":"https://github.com/vim/vim/blob/a1b9b0cc011ef15869ac25cb93e1b4baa0cb7f38/src/os_unix.c#L3131","text":"The official Vim repository. Contribute to vim/vim development by creating an account on GitHub.","thumb_url":"https://avatars0.githubusercontent.com/u/11618545?s=400\u0026v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":48,"thumb_height":48,"from_url":"https://github.com/vim/vim/blob/a1b9b0cc011ef15869ac25cb93e1b4baa0cb7f38/src/os_unix.c#L3131","original_url":"https://github.com/vim/vim/blob/a1b9b0cc011ef15869ac25cb93e1b4baa0cb7f38/src/os_unix.c#L3131"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N8WrX"}]},{"client_msg_id":"8fc855ec-57ad-4a3f-92e8-47370832d1aa","type":"message","user":"UAZ33BKV2","text":"PRチャンスというかせんとあかんレベルなのでは","ts":"1597673122.012100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9NQ"}]},{"client_msg_id":"7749fd5e-27a5-4f3a-b6a1-6a5bcd7e8e3b","type":"message","user":"U9S4G0LJW","text":":majika:","ts":"1597672916.011700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5Fh"}]},{"client_msg_id":"25e0ba7a-3e45-454b-a952-92181b82be46","type":"message","user":"U03C6TEAZ","text":"vimrc で executable で分岐するコード書くとちょっと遅くなる。","ts":"1597672797.011500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qBV4U"}]},{"client_msg_id":"f67ac848-8f51-493e-8291-ea776282f89b","type":"message","user":"U03C6TEAZ","text":"なんかしらんのですが vim の遅いんですよね。","ts":"1597672772.011100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GfSr"}]},{"client_msg_id":"7fc58c57-f68f-41e3-9fb1-512a136651d0","type":"message","user":"U9S4G0LJW","text":"whichだってやってることは同じだと思うけど…","ts":"1597671990.010500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OvWj"}]},{"client_msg_id":"18b2b794-cc3d-414c-a073-0c1acf713c60","type":"message","user":"UAZ33BKV2","text":"OSの機能でexecutableチェックできないんですっけ..","ts":"1597671812.009800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"T/5s"}]},{"client_msg_id":"3696e34d-27c8-49ed-b916-b95d56208e8d","type":"message","user":"U03C6TEAZ","text":"`PATH` を `:` で split して各ディレクトリで `path + exe` の `stat(2)` を実行してるので。","ts":"1597671777.009400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"LoR"}]},{"client_msg_id":"d7b87aa8-3bbc-4670-9f21-67a78ab04a00","type":"message","user":"U03C6TEAZ","text":"あとこれ系のプラグインだとコマンドの有無を確認するのに `executable()` 使ってるんですが、これが結構遅いんですよ。","ts":"1597671736.008800","team":"T03C4RC8V","reactions":[{"name":"totemoturai","count":1,"users":["U776661HA"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xdyl"}]},{"client_msg_id":"4c838d68-f8b8-4aec-9bd3-1f34c5fb28ab","type":"message","user":"UAZ33BKV2","text":"もしかして、domain socketのファイルがあるディレクトリにしかけちゃう?とか、\nいやでも再現性があったりなかったり、場所依存でもなさそう?","ts":"1597671614.008200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wlD"}]},{"client_msg_id":"7ff563d3-0bcc-4d3e-8a46-b5846422a58e","type":"message","user":"U9S4G0LJW","text":"だとすると疑わしいのはsystem()関連かな","ts":"1597671476.007500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WAYl8"}]},{"client_msg_id":"9092a6e2-b433-4e50-87cf-f7a411952eb5","type":"message","user":"U9S4G0LJW","text":"netrwのソース見たけどログ吐くプラグインじゃないな","ts":"1597671456.007100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yPB8g"}]},{"client_msg_id":"6452ebc3-1466-4e7d-a590-23ddf7cffc51","type":"message","user":"UB88NP1PY","text":"私の環境の何かがそれを引き起こしているはずなので、なんか気持ち悪いですけど。","ts":"1597671223.006700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"P5Gh"}]},{"client_msg_id":"2e1e9a3a-01d7-46f4-9efe-8ba6017d4dfd","type":"message","user":"U9S4G0LJW","text":"Vimのデフォルト設定だと書き込みを同期的に行うので割と遅い","ts":"1597671088.005700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rMNg"}]},{"client_msg_id":"c6ef914e-91f2-4472-b49d-f37808e053a0","type":"message","user":"UB88NP1PY","text":"そうするとまぁ Netrw 固有の問題ですかね。そこまで深追いしなくていいか。。","ts":"1597671069.005500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ml5V"}]},{"client_msg_id":"edb0ceaa-1563-4509-b0d1-47cd879725b1","type":"message","user":"U9S4G0LJW","text":"エラーログとかゴリゴリ吐き出してるとかそういうやつ？","ts":"1597671047.005200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zNfaS"}]},{"client_msg_id":"5e59b3b2-8015-4a5c-980e-a4b84c0646a6","type":"message","user":"UB88NP1PY","text":"`vim . --startuptime` で Netrw に時間がかかっているように見えないのは script 自身じゃなくて system call で時間がかかってるからなのかな。","ts":"1597671018.004300","edited":{"user":"UB88NP1PY","ts":"1597671242.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oW+"}]},{"client_msg_id":"714e0172-38de-4776-9674-42fa0e268ae8","type":"message","user":"UAZ33BKV2","text":"いちど詰りだすとどうにもならない、のかな","ts":"1597671011.004000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5m+JS"}]},{"client_msg_id":"208c88e6-8227-4bb6-8444-b9778f39c2c5","type":"message","user":"UB88NP1PY","text":"現象としては、一度発生し始めるとどのディレクトリを開いても発生する感じなんですよね。たかだか数ファイルの場所でも。","ts":"1597670996.003300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Efw"}]},{"client_msg_id":"12044048-f4c5-41be-9fc1-416e614d4689","type":"message","user":"U9S4G0LJW","text":"Slackのお気に入りから取り出してきたけどお気に入り機能結構不便だな \u003chttps://vim-jp.slack.com/archives/CJMV3MSLR/p1583495039395500\u003e","ts":"1597670949.002700","attachments":[{"fallback":"[March 6th, 2020 3:43 AM] vim-jp-bot: Plugin Manager for :help\n\nUsage: /vimhelp plugin {cmd} {args}\n\n  install/add {plugin-name}...\n  uninstall/rm/remove/delete {plugin-name}...\n  update [{plugin-name}...]\n  list\n","id":1,"author_id":"UPZHKAM7W","author_subname":"vim-jp-bot","author_link":"https://vim-jp.slack.com/services/BPM858KEE","author_icon":"https://a.slack-edge.com/80588/img/services/hubot_48.png","text":"Plugin Manager for :help\n\nUsage: /vimhelp plugin {cmd} {args}\n\n  install/add {plugin-name}...\n  uninstall/rm/remove/delete {plugin-name}...\n  update [{plugin-name}...]\n  list\n","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #question","ts":1583495039.395500,"from_url":"https://vim-jp.slack.com/archives/CJMV3MSLR/p1583495039395500","original_url":"https://vim-jp.slack.com/archives/CJMV3MSLR/p1583495039395500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"csqKU"}]},{"client_msg_id":"c7e86dac-00d9-4b34-89fd-1abe2d3d9507","type":"message","user":"UAZ33BKV2","text":"まあある程度は早くなるうえ、無駄減るのはありますよね","ts":"1597670931.002400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Vsx"}]},{"type":"message","user":"UPZHKAM7W","text":"```\nreaddirex({directory} [, {expr}])                       *readdirex()*\n                |readdir()| の拡張バージョン。\n                {directory} にあるファイルとディレクトリの情報を持つ辞書のリス\n                トを返す。\n                これはディレクトリ内のファイルとディレクトリの属性をリストアッ\n                プ時に同時に取得したい時に便利である。\n                これは |readdir()| を呼んだあと、各ファイルとディレクトリに対\n                して |getfperm()|, |getfsize()|, |getftime()|, |getftype()|\n                を呼ぶより特に MS-Windows で速い。\n                このリストは名前でソートされる (大文字/小文字区別有り)。\n \n                ファイルとディレクトリの情報の辞書は以下の項目を持つ:\n                        group   エントリのグループ名。 (Unix のみ)\n                        name    エントリの名前。\n                        perm    エントリの許可属性。|getfperm()| を参照。\n                        size    エントリのサイズ。|getfsize()| を参照。\n                        time    エントリの最終更新時間。|getftime()| を参照。\n                        type    エントリの種別。\n                                Unix では、以下を除いてほぼ |getftype()| と\n                                同じ:\n                                    ディレクトリへのシンボリックリンク\n                                                        \"linkd\"\n                                    それ以外のシンボリックリンク\n                                                        \"link\"\n                                MS-Windows では:\n                                    通常のファイル      \"file\"\n                                    ディレクトリ        \"dir\"\n                                    ジャンクション      \"junction\"\n                                    ディレクトリへのシンボリックリンク\n                                                        \"linkd\"\n                                    それ以外のシンボリックリンク\n                                                        \"link\"\n                                    それ以外のリパースポイント\n                                                        \"reparse\"\n                        user    エントリの所有者のユーザー名。 (Unix のみ)\n                Unix では、もしエントリがシンボリックリンクなら、リンク先対象\n                の情報を辞書に含む(ただし、\"type\" 項目は除く)。\n                MS-Windows では、パフォーマンス上の理由によりシンボリックリン\n                ク自身の情報を含む。\n \n                {expr}が省略されるとすべてのエントリが含まれる。\n                {expr}が与えられると、それは何をすべきかをチェックするために評\n                価される:\n                        {expr}の結果が -1 の場合、それ以上のエントリは処理され\n                        ない。\n                        {expr}の結果が 0 の場合、このエントリはリストに追加さ\n                        れない。\n                        {expr}の結果が 1 の場合、このエントリはリストに追加さ\n                        れる。\n                \".\" と \"..\" のエントリは常に除かれる。\n                {expr} を評価するごとに、|v:val| にそのエントリの辞書を設定す\n                る。\n                {expr} が関数の場合はエントリが引数として与えられる。例え\n                ば、\".txt\" で終わるファイルのリストを取得するには、次のように\n                する:  \n                  readdirex(dirname, {e -\u0026gt; e.name =~ '.txt$'})\n \n                |method| としても使用できる:  \n                        GetDirName()-\u0026gt;readdirex()\n```","ts":"1597670885.001400","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"a7a1030a-3682-4a07-8153-3750d7c52985","type":"message","user":"U9S4G0LJW","text":":h readdirex()","ts":"1597670884.001300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PSTfa"}]},{"client_msg_id":"ffdbcf32-9efd-4ef4-85a6-8e86ba9f35bb","type":"message","user":"UAZ33BKV2","text":"お","ts":"1597670882.001200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"i2MT"}]},{"type":"message","user":"UPZHKAM7W","text":"Update success: vim-jp/vimdoc-ja (9d8aeb1 =\u0026gt; 7ff07d9)","ts":"1597670873.000800","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"3b097be8-655b-4671-b5e9-9db6737a56c6","type":"message","user":"U9S4G0LJW","text":":vimhelp plugin update vim-jp/vimdoc-ja","ts":"1597670870.000700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iuC0r"}]},{"type":"message","user":"UPZHKAM7W","text":"Shougo/dein.vim\nShougo/deoplete.nvim\nShougo/neosnippet\nkana/vim-textobj-line\nlambdalisue/fern.vim\nmattn/hahhah-vim\nthinca/vim-plz_donate\nthinca/vim-quickrun\nthinca/vim-splash\nthinca/vim-themis\ntyru/eskk.vim\ntyru/pay-for-uganda.vim\nvim-jp/autofmt\nvim-jp/vimdoc-ja\nvim-jp/vital.vim","ts":"1597670856.000400","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"890b1135-1713-4570-a832-f56ca8ec96b2","type":"message","user":"U9S4G0LJW","text":":vimhelp plugin list","ts":"1597670855.000300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"m905"}]},{"client_msg_id":"cecb1cca-389a-4237-acc4-06f0e8d3d812","type":"message","user":"UAZ33BKV2","text":"あー、botの更新コマンドしらないや...","ts":"1597670675.499200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xny"}]},{"type":"message","user":"UPZHKAM7W","text":"```\nreaddirex({directory} [, {expr} [, {dict}]])                    *readdirex()*\n                Extended version of |readdir()|.\n                Return a list of Dictionaries with file and directory\n                information in {directory}.\n                This is useful if you want to get the attributes of file and\n                directory at the same time as getting a list of a directory.\n                This is much faster than calling |readdir()| then calling\n                |getfperm()|, |getfsize()|, |getftime()| and |getftype()| for\n                each file and directory especially on MS-Windows.\n                The list will by default be sorted by name (case sensitive),\n                the sorting can be changed by using the optional {dict}\n                argument, see |readdir()|.\n \n                The Dictionary for file and directory information has the\n                following items:\n                        group   Group name of the entry. (Only on Unix)\n                        name    Name of the entry.\n                        perm    Permissions of the entry. See |getfperm()|.\n                        size    Size of the entry. See |getfsize()|.\n                        time    Timestamp of the entry. See |getftime()|.\n                        type    Type of the entry.\n                                On Unix, almost same as |getftype()| except:\n                                    Symlink to a dir    \"linkd\"\n                                    Other symlink       \"link\"\n                                On MS-Windows:\n                                    Normal file         \"file\"\n                                    Directory           \"dir\"\n                                    Junction            \"junction\"\n                                    Symlink to a dir    \"linkd\"\n                                    Other symlink       \"link\"\n                                    Other reparse point \"reparse\"\n                        user    User name of the entry's owner. (Only on Unix)\n                On Unix, if the entry is a symlink, the Dictionary includes\n                the information of the target (except the \"type\" item).\n                On MS-Windows, it includes the information of the symlink\n                itself because of performance reasons.\n \n                When {expr} is omitted all entries are included.\n                When {expr} is given, it is evaluated to check what to do:\n                        If {expr} results in -1 then no further entries will\n                        be handled.\n                        If {expr} results in 0 then this entry will not be\n                        added to the list.\n                        If {expr} results in 1 then this entry will be added\n                        to the list.\n                The entries \".\" and \"..\" are always excluded.\n                Each time {expr} is evaluated |v:val| is set to a |Dictionary|\n                of the entry.\n                When {expr} is a function the entry is passed as the argument.\n                For example, to get a list of files ending in \".txt\":  \n                  readdirex(dirname, {e -\u0026gt; e.name =~ '.txt$'})\n \n                For example, to get a list of all files in the current\n                directory without sorting the individual entries:  \n                  readdirex(dirname, '1', #{sort: 'none'})\n \n \n                Can also be used as a |method|:  \n                        GetDirName()-\u0026gt;readdirex()\n```","ts":"1597670646.498600","bot_id":"BPM858KEE","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"f8f10d34-0a6a-49a8-98d6-13dd045a4e97","type":"message","user":"UAZ33BKV2","text":"何回やってるか、みたいな統計とれると傾向が見れるかな...\nreaddirex、Linuxでどれくらい改善効果あったっけ...(疑問なだけ)\n:h readdirex()","ts":"1597670645.498500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"31t"}]},{"client_msg_id":"2f30084b-2cad-49f2-a5a9-7cf4332d8fa6","type":"message","user":"U9S4G0LJW","text":"まあ望めなさそう、Dr.Chipですし","ts":"1597670318.497600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8hf"}]},{"client_msg_id":"e6039a6e-3679-41ed-b244-47399c134594","type":"message","user":"U9S4G0LJW","text":"readdirex~","ts":"1597670302.497200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oxEHc"}]},{"client_msg_id":"d0f2c191-62ac-4fc9-a44c-402ecd16afd2","type":"message","user":"U03C6TEAZ","text":"netrw だともしかすると\n* フィアルの一覧 (N 個のファイル)\n* ファイルのサイズ取得 (N 個のファイル)\n* ファイルの属性取得 (N 個のファイル)\nみたいな事になってそう。","ts":"1597670270.496900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sr6"}]},{"client_msg_id":"e1ef9fcc-6c8a-4604-8b87-58c3cd227e23","type":"message","user":"UAZ33BKV2","text":"unix stream sendmsgで長いからunix domain socketの送信完了待ち? エンキューされてすぐもどってきたりしないのかな...","ts":"1597669708.495500","edited":{"user":"UAZ33BKV2","ts":"1597669734.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8bN"}]},{"client_msg_id":"a1765df1-f83b-4db4-91b9-e9a7d97a205d","type":"message","user":"UB88NP1PY","text":"やってるのは、`perf record -g vim .` ですね。その後手入力ですぐ `:q` してます。`perf record -g vim . -c \"q\"` だと再現しなくって。","ts":"1597669534.494700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jdh+i"}]},{"client_msg_id":"82c326e4-055c-459e-9dba-d9721766eeb8","type":"message","user":"U03C71D7H","text":"svg ってプレビュー見れないのか…","ts":"1597669443.493700","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U7B4ZD49X"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"n9c"}]},{"client_msg_id":"b86f77ed-f1c2-48ab-955a-41406bd93531","type":"message","user":"U9S4G0LJW","text":"なんでwriteなんだろう、何か書き込んでる？","ts":"1597669290.493400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TQr"}]},{"type":"message","user":"UB88NP1PY","text":"こんな感じの絵が取れました。幅を取っている \"__lock_text_start\" というのが原因なのかな。","ts":"1597669124.492500","files":[{"id":"F019BH42PND","created":1597669050,"timestamp":1597669050,"name":"perf_netrw.svg","title":"perf_netrw.svg","mimetype":"image/svg+xml","image_exif_rotation":0,"filetype":"svg","pretty_type":"SVG","user":"UB88NP1PY","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":337004,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F019BH42PND/perf_netrw.svg","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F019BH42PND/download/perf_netrw.svg","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/UB88NP1PY/F019BH42PND/perf_netrw.svg","permalink_public":"https://slack-files.com/T03C4RC8V-F019BH42PND-0e2d9fd216","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""},{"id":"F019BH4C857","created":1597669059,"timestamp":1597669059,"name":"perf_nerdtree.svg","title":"perf_nerdtree.svg","mimetype":"image/svg+xml","image_exif_rotation":0,"filetype":"svg","pretty_type":"SVG","user":"UB88NP1PY","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":306296,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F019BH4C857/perf_nerdtree.svg","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F019BH4C857/download/perf_nerdtree.svg","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/UB88NP1PY/F019BH4C857/perf_nerdtree.svg","permalink_public":"https://slack-files.com/T03C4RC8V-F019BH4C857-ce78f54533","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pmXo"}]},{"client_msg_id":"3d5509e9-0916-44c2-98ae-b7c13d52af1e","type":"message","user":"UB88NP1PY","text":"ありがとうございます。","ts":"1597667998.491700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wlhnK"}]},{"client_msg_id":"8432e3df-7442-40f3-ab6a-5bf0d23c72ea","type":"message","user":"UB88NP1PY","text":"うーん、再現しなくなってしまった。いまいち要領を得ないなぁ。。","ts":"1597667995.491500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jlaZ0"}]},{"client_msg_id":"8b157fe7-a51b-480b-b331-fef7bb554e10","type":"message","user":"U7JL1UKKL","text":"システムコールのトレースをしても良いかも","ts":"1597664340.491000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"537x"}]},{"client_msg_id":"b40ce06e-33df-4420-bf0d-113f6d6a3f86","type":"message","user":"U7JL1UKKL","text":"そうですね","ts":"1597664296.490500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8ASHl"}]},{"type":"message","user":"U018YPPL875","text":"\u003c@U018YPPL875\u003e has joined the channel","ts":"1597657627.490300","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"ade7827e-565f-4238-be76-197477ec0930","type":"message","user":"UB88NP1PY","text":"Flame graphs というやつを描いてみたらもっと詳しく分かりそう。。","ts":"1597655608.490100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yALAE"}]},{"client_msg_id":"cb85c3bf-3ea2-4e69-977e-1297b28eecda","type":"message","user":"UB88NP1PY","text":"NERDTree の `g:NERDTreeHijackNetrw = 1` だと起きないので、netrw が参照しに行っているファイルの spinlock 待ちということなのかな。","ts":"1597655362.489000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bnD"}]},{"client_msg_id":"71ccf9c1-7da1-4bac-b905-a2e9883a4a4f","type":"message","user":"UB88NP1PY","text":"前にちょっとお話しした netrw でディレクトリ開くのがすごい遅い件なんですが、再現したので perf でデータ取ってみました。見た感じ単に system call 待ちで時間がかかっているというだけですかね。Vim 側の問題ではないかな？\n```Samples: 5K of event 'cpu-clock:pppH', Event count (approx.): 1428500000\nOverhead  Command  Shared Object          Symbol\n  29.77%  vim      [kernel.kallsyms]      [k] __lock_text_start\n   8.59%  vim      libpthread-2.27.so     [.] __libc_recvmsg\n   6.14%  vim      [kernel.kallsyms]      [k] do_syscall_64\n   3.82%  vim      [kernel.kallsyms]      [k] finish_task_switch\n   2.42%  vim      vim                    [.] utfc_ptr2len\n   1.37%  vim      [kernel.kallsyms]      [k] copy_user_generic_unrolled\n   1.31%  vim      vim                    [.] vim_strchr\n   1.28%  vim      libc-2.27.so           [.] __poll\n   1.17%  vim      libc-2.27.so           [.] malloc\n   1.07%  vim      [kernel.kallsyms]      [k] __fget_light\n   1.02%  vim      vim                    [.] utf_composinglike\n   0.86%  vim      [kernel.kallsyms]      [k] unix_stream_read_generic\n   0.86%  vim      libpthread-2.27.so     [.] __pthread_mutex_lock\n   0.81%  vim      libpthread-2.27.so     [.] __nanosleep\n   0.81%  vim      vim                    [.] do_cmdline\n   0.74%  vim      libc-2.27.so           [.] __memmove_avx_unaligned_erms\n   0.63%  vim      [kernel.kallsyms]      [k] _raw_spin_lock\n   0.63%  vim      libc-2.27.so           [.] __GI___writev\n   0.61%  vim      libpthread-2.27.so     [.] __pthread_mutex_unlock\n   0.58%  vim      [kernel.kallsyms]      [k] sock_recvmsg\n   0.58%  vim      [kernel.kallsyms]      [k] unix_stream_recvmsg\n   0.58%  vim      vim                    [.] find_name_end```","ts":"1597655235.488100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rHL"}]},{"client_msg_id":"7b905c60-2a29-49e5-85cf-9b5bf434cd30","type":"message","user":"UEB0VGD7E","text":"あ、なるほどそういうことですか\nマージありがとうございます","ts":"1597633684.484400","team":"T03C4RC8V","reactions":[{"name":"man-bowing","count":1,"users":["U776661HA"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"b3lku"}]},{"client_msg_id":"41615B82-9CA1-4788-AE17-C9EE502016A3","type":"message","user":"U776661HA","text":"Vim と Neovim の挙動違いでした","ts":"1597624761.483600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tTwTl"}]},{"client_msg_id":"7fe54f46-2556-4b25-bda9-a03514bdce6d","type":"message","user":"UEB0VGD7E","text":"PRした","ts":"1597590410.482400","team":"T03C4RC8V","reactions":[{"name":"+1","count":5,"users":["U78A6ESHM","U06BRP8VD","U9S4G0LJW","U7JL1UKKL","U017BU3UZBQ"]},{"name":"69b9bbe795f19442","count":1,"users":["U776661HA"]},{"name":"man-bowing","count":1,"users":["U776661HA"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BdwX"}]}]
