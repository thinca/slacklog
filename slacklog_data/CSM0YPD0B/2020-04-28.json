[{"client_msg_id":"ebd9cf90-1eb8-4bf1-bcd3-c37394e0f993","type":"message","user":"UK23J3NG4","text":"初投稿です。\nいつも大変参考にさせていただいています。\n\n（初投稿なのに）Vimの話は一切関係なくて申し訳ありません。\nDocker(Compose)+Djangoで開発を行っているのですが、runserverしている状態でプログラムを書いていてSyntaxErrorをしてしまうとその度にコンテナが落ちてしまい、作業効率に支障をきたしています。。。\nSyntaxErrorしてもコンテナを落ちないようにする方法はありますでしょうか？\n\nこちら、知見のある方がいらっしゃいましたらご教授頂きたいです。","ts":"1588046115.089300","team":"T03C4RC8V","reactions":[{"name":"iinoyo","count":2,"users":["U9S4G0LJW","UK7DT8URY"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yDUCp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7c72926a-ff4e-4ac0-8333-404b98d6e474","type":"message","user":"UDDCM376D","text":"syntax errorでサーバが落ちるんですか？","ts":"1588046296.091000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ul6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"644eb3c5-cae3-48c8-af17-f4e8bc8208d0","type":"message","user":"UDDCM376D","text":"docker-compose.yamlを貼ってもらえれると嬉ぴっぴです","ts":"1588046316.091800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qnAzh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5fc4c024-0d20-44b0-b1a5-3651632074c1","type":"message","user":"UNJ2DANJC","text":"docker-composeにrestart_policyがあるのでそれで再起動ですかね <https://docs.docker.com/compose/compose-file/#restart_policy>","ts":"1588046318.092000","attachments":[{"fallback":"Docker Documentation: Compose file version 3 reference","id":1,"title":"Compose file version 3 reference","title_link":"https://docs.docker.com/compose/compose-file/#restart_policy","text":"Reference and guidelines These topics describe version 3 of the Compose file format. This is the newest version. Compose and Docker compatibility matrix There are several versions of the Compose...","thumb_url":"https://docs.docker.com/favicons/docs@2x.ico","blocks":null,"ts":1587730555,"service_name":"Docker Documentation","service_icon":"https://docs.docker.com/favicons/docs@2x.ico","thumb_width":129,"thumb_height":128,"from_url":"https://docs.docker.com/compose/compose-file/#restart_policy","original_url":"https://docs.docker.com/compose/compose-file/#restart_policy"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7Iojd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2e47b77e-14f4-484e-82a2-7fd3583ee34c","type":"message","user":"UK23J3NG4","text":"```app_central_1  |   File \"/code/config/settings.py\", line 16, in &lt;module&gt;\napp_central_1  |     hoge\napp_central_1  | NameError: name 'hoge' is not defined\npvs2_app_central_1 exited with code 1```","ts":"1588046329.092500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vhF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0e1c670f-0eb5-4426-9d38-2c1e85f9ec24","type":"message","user":"UK23J3NG4","text":"こんな感じですね。。。","ts":"1588046338.092900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"R6Y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21d97ec0-21c5-4b8c-96b0-422692ffac7e","type":"message","user":"UK23J3NG4","text":"```version: '3.7'\n\nx-app-service: &amp;app-service-template\n  stdin_open: true\n  tty: true\n  command: python manage.py runserver_plus 0.0.0.0:8000\n  depends_on:\n    - db\n\nservices:\n  app_central:\n    build:\n      context: ./central/django\n      dockerfile: Dockerfile.dev\n    &lt;&lt;: *app-service-template\n    volumes:\n      - ./central/django/app:/code\n    environment:\n      DEBUG: 'True'\n      DB_DEFAULT_NAME: central\n      DB_DEFAULT_USER: root\n      DB_DEFAULT_PASSWORD: password\n      DB_DEFAULT_HOST: db\n      AMAZON_COGNITO_DOMAIN: XXXXXXXX\n    ports:\n      - '8000:8000'\n    links:\n      - db```\ndocker-compose.ymlはこんな感じです。","ts":"1588046414.093500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MQny"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fefed11b-add2-4602-91ea-c23616c27f16","type":"message","user":"UK23J3NG4","text":"開発環境なので、パスワードどかはすみません:sweat_drops:","ts":"1588046451.094200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uusU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"451c55ac-cbb5-4a7e-8ef4-36188999221a","type":"message","user":"UK23J3NG4","text":"VSCODEのリモートコンテナプラグインで作業している人もいるため、再起動されると困るらしいです・・・。最悪はrestart_policyですかね。","ts":"1588046768.096200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JWwUq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"507962d1-39b1-4476-951e-322216943c66","type":"message","user":"UK7DT8URY","text":"Djangoなにも知らないのですが……\n`manage.py` で全例外をキャッチするように変更したら落ちない気がしました。","ts":"1588048578.100200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lEWmd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f619c2af-8407-4df7-8fa9-d45558957096","type":"message","user":"UNJ2DANJC","text":"コンテナの中に入って作業するならENTRYPOINTとかCMDで起動しないほうがいいと思いますね 一旦shellを起動してそこからdjangoを起動したほうがいいと思います","ts":"1588048581.100300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F9XX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"be66f697-0105-4eb7-a86f-73a6304d3a3f","type":"message","user":"UK23J3NG4","text":"自分もDjango始めたばっかりなので・・・\n基本はローカルにあるファイル（ここでいうと./central/django/app）を編集するのですが、確かにコンテナの中に入って作業するならCMDでの起動はしないほうが良いかもです。（一応そのためにtty: trueを入れたんですが…）","ts":"1588049072.102800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"opX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d92538d-a63e-432a-8b57-85ecb9a584d0","type":"message","user":"UDDCM376D","text":"&gt; コンテナの中に入って作業するならENTRYPOINTとかCMDで起動しないほうがいいと思いますね 一旦shellを起動してそこからdjangoを起動したほうがいいと思います\nこれで良いかなと思ったけど、都度サーバー再起動しないといけないのはかえってつらそう","ts":"1588053000.103400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZCl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ff226403-9469-40ad-9b51-c381e0ee579c","type":"message","user":"UDDCM376D","text":"syntaxエラーの旅、サーバー落ちるのは、そもそもどうなんだろう…","ts":"1588053022.103900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"J0p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"38998634-b241-4683-8746-0f32252dec5a","type":"message","user":"U06BRP8VD","text":"ライブマイグレーション(?)をサポートしているならそれを実現しているモジュールの問題。もしもサポートしてないならそれ(syntax error でサーバー止まる)はそういうもんという感じする。","ts":"1588053794.104800","edited":{"user":"U06BRP8VD","ts":"1588053806.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oJN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c458322d-cbad-4eb2-b11c-5a22aaf9a1d5","type":"message","user":"UK23J3NG4","text":"自分の設置が間違っていると思って、他の方の開発環境（たとえば <https://qiita.com/k4ssyi/items/b8d1355fed43b526aee1> ）のgithubをcloneしてdocker-compose upしても同じ現象に陥るので、そういうものなのかな。。。","ts":"1588054263.106600","thread_ts":"1588054263.106600","attachments":[{"fallback":"Qiita: Django3.0の開発環境をDocker,Docker-compose,Poetryで作ってみた  - Qiita","id":1,"title":"Django3.0の開発環境をDocker,Docker-compose,Poetryで作ってみた  - Qiita","title_link":"https://qiita.com/k4ssyi/items/b8d1355fed43b526aee1","text":"はじめに Dockerとdocker-composeを使ってDjangoの開発環境を作成します。 他の人が書いた記事にすでにDockerで開発環境をつくる記事はありますが、ライブラリ管理にrequirements.txtを使用し...","image_url":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2&w=1200&mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DDjango3.0%25E3%2581%25AE%25E9%2596%258B%25E7%2599%25BA%25E7%2592%25B0%25E5%25A2%2583%25E3%2582%2592Docker%252CDocker-compose%252CPoetry%25E3%2581%25A7%25E4%25BD%259C%25E3%2581%25A3%25E3%2581%25A6%25E3%2581%25BF%25E3%2581%259F%2520%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3Ddc31040212399c58b1438dddd91dddec&mark-align=center%2Cmiddle&blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540k4ssyi%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3D3be5b46fc3040d85d19eed25917c32fe&blend-align=center%2Cmiddle&blend-mode=normal&s=5af7b2204e77b3d15a52db01f402c12b","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png","from_url":"https://qiita.com/k4ssyi/items/b8d1355fed43b526aee1","original_url":"https://qiita.com/k4ssyi/items/b8d1355fed43b526aee1"}],"reply_count":1,"replies":[{"user":"UPWFF5YQ7","ts":"1588238417.116800"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"j/N0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b95e3407-d177-4876-ab10-ed09bda0971c","type":"message","user":"UEA8SS1RN","text":"dockerで質問です。\n<https://github.com/vikke/sam_sample> なコードを書いたのですが、aplコンテナが上がってくれません。docker-compose.ymlの volumeを外すとaplコンテナのsleepが起動してくれてます。\nアドバイスお願いします。","ts":"1588060019.109800","attachments":[{"fallback":"GitHub: vikke/sam_sample","id":1,"title":"vikke/sam_sample","title_link":"https://github.com/vikke/sam_sample","text":"Contribute to vikke/sam_sample development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/530689?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/vikke/sam_sample","original_url":"https://github.com/vikke/sam_sample"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7KWt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e3e1bb40-5281-4d34-8b0c-b64d803076e8","type":"message","user":"U06BRP8VD","text":"apl の start-api.sh が /go/sam-app/ に置いてあるのに、docker-composeのほうの volume でその場所を上書きしちゃってるので、shが見えない状態になってるんでしょう。","ts":"1588060430.111200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ef9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7479fcdb-c62d-480b-a1d8-f0f548637c4d","type":"message","user":"U06BRP8VD","text":"volumeはマージじゃなくて完全に上書きというか… mountと一緒ですね。","ts":"1588060462.112000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vom5M"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"88978b62-7ea6-43bb-9b60-781c7a6c8f56","type":"message","user":"U06BRP8VD","text":"で、エントリポイントが見つからないから上がらないんですよ。","ts":"1588060488.112400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q9d5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2376494c-8c07-4184-b68e-4e469a5fcdb7","type":"message","user":"U06BRP8VD","text":"エラーメッセージかログにでてるんじゃない?","ts":"1588060507.112700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7YH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ef91c621-6b12-45de-a561-cc5c499ca102","type":"message","user":"UEA8SS1RN","text":"なるほど。ログちゃんと監視してみます。","ts":"1588060794.113400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wI+0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"de32d9d6-db96-4256-ad12-6e88da9f52f6","type":"message","user":"UEA8SS1RN","text":"Dockerfileが先に走って、docker-composeが走るんですね。","ts":"1588060869.114100","edited":{"user":"UEA8SS1RN","ts":"1588060885.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2WL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"78b5ec9a-b4ad-4857-bb26-f71e35a23e2e","type":"message","user":"U06BRP8VD","text":"まぁそうですね。\n\ndocker-compose はdockerイメージを使って複数のコンテナを起動・管理するもので、Dockerfileはそのdockerイメージを作るためのレシピって感じです。","ts":"1588061126.116000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jbnZB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21c5a917-0827-4971-8f15-03cc4d79f68a","type":"message","user":"U06BRP8VD","text":"なのでDockerfile(= docker build) が先に走る","ts":"1588061141.116400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IA2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"97dab02a-18c3-4757-aefe-bec7c5bcda2b","type":"message","user":"UEA8SS1RN","text":"すごい分りやすい。理解が進みます。","ts":"1588061267.116700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WW/f3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
