[{"client_msg_id":"fe59ae08-842a-4e05-9518-f32dc2ef168c","type":"message","user":"UNJ2DANJC","text":"github actionsのVMとほぼ同じdocker imageを作ろうとしたらdockerビルドが全然終わらない\nどうやらdotnetのバージョンをむちゃくちゃいっぱいダウンロードして全バージョンでsmokeテスト流すスクリプトがあるみたいで、それにアホみたいに時間がかかっている...\n<https://github.com/johejo/gh-actions-ubuntu>","ts":"1596723048.105300","attachments":[{"fallback":"GitHub: johejo/gh-actions-ubuntu","id":1,"title":"johejo/gh-actions-ubuntu","title_link":"https://github.com/johejo/gh-actions-ubuntu","text":"Contribute to johejo/gh-actions-ubuntu development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/25817501?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":133,"thumb_height":133,"from_url":"https://github.com/johejo/gh-actions-ubuntu","original_url":"https://github.com/johejo/gh-actions-ubuntu"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"e+B2R"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5ddf2aaf-30b7-458f-9119-0a16de21cce1","type":"message","user":"U03C71D7H","text":"当然だけど、job 側に `if` を設定して何も走らないようにしても、trigger の条件に引っかかれば workflow 自体は走っちゃう。「tag の push 時のテストだけ release する」ということがやりたくても、普段のブランチの push で空の release の workflow が走りまくることになる。","ts":"1596641042.093900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KT7JB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a5f405e4-ad25-4538-963a-0e923e786454","type":"message","user":"U03C71D7H","text":"そういえば `if` などによって job が 1 つも走らない workflow から `workflow_run` を起動した場合は、 `conclusion` は `skipped` になった","ts":"1596641137.094700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"142ls"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8412b02c-800a-4fa3-9cba-3447d366b050","type":"message","user":"U03C71D7H","text":"あーそういうことか。意図した仕様かどうかはとても怪しいが、 `workflow_run` トリガーに渡せるオプションに `branches` があるのだけど、これはどうやら `github.event.workflow_run.head_branch` に当たる部分に適用されるらしい。つまり tag が push されたら tag の名前に対してマッチのチェックがされる\nということは `branches: ['v*.*.*']` のように設定しておけば、バージョンタグへの push で走ったテストのみに workflow を走らせることができそう(job 側で `conclusion` のチェックも忘れずに)。当然、バージョンタグに似た名前のブランチを push してしまった場合にも走るので要注意。 `v*` くらいだと誤爆が起きる。 `v2.0.0-dev` みたいなブランチを作ると死ぬ","ts":"1596642366.098400","team":"T03C4RC8V","reactions":[{"name":"eyes","count":1,"users":["US90LD360"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IYU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f1400cdc-c2f0-4904-9db5-77badf227f51","type":"message","user":"UDDCM376D","text":"github action\nrelease タグを打ってpushしたのにciが動かないんだけど…","ts":"1596649725.099100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6us5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e0d7e721-1776-47cc-bb53-8a43af095978","type":"message","user":"UDDCM376D","text":"動いているやつを満々持ってきたんだけどな\n<https://github.com/skanehira/code2img/blob/master/.github/workflows/release.yaml>","ts":"1596649764.099500","attachments":[{"fallback":"GitHub: skanehira/code2img","id":1,"title":"skanehira/code2img","title_link":"https://github.com/skanehira/code2img/blob/master/.github/workflows/release.yaml","text":"generating images of source code. Contribute to skanehira/code2img development by creating an account on GitHub.","thumb_url":"https://avatars2.githubusercontent.com/u/7888591?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/skanehira/code2img/blob/master/.github/workflows/release.yaml","original_url":"https://github.com/skanehira/code2img/blob/master/.github/workflows/release.yaml"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7ze9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56996bbb-bbea-4042-9cdd-0e4b0c0db957","type":"message","user":"UDDCM376D","text":"<https://github.com/skanehira/code2img/blob/master/.github/workflows/ci.yaml>\nこれは動くのに","ts":"1596649820.099900","attachments":[{"fallback":"GitHub: skanehira/code2img","id":1,"title":"skanehira/code2img","title_link":"https://github.com/skanehira/code2img/blob/master/.github/workflows/ci.yaml","text":"generating images of source code. Contribute to skanehira/code2img development by creating an account on GitHub.","thumb_url":"https://avatars2.githubusercontent.com/u/7888591?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/skanehira/code2img/blob/master/.github/workflows/ci.yaml","original_url":"https://github.com/skanehira/code2img/blob/master/.github/workflows/ci.yaml"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QO6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"19942cba-c035-4806-b700-ce4d69c2b0a7","type":"message","user":"U03C71D7H","text":"tag のコミットの時点では workflow ファイルがないですね","ts":"1596674177.100400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"j3U"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"49bee6dd-5e27-4bd0-aff1-e3630c790c9d","type":"message","user":"UDDCM376D","text":"あー","ts":"1596674257.100700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tJK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c73c919e-ece2-405a-a311-0c6df2511869","type":"message","user":"UDDCM376D","text":"そういうことか","ts":"1596674260.101000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RT6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4fda93ef-67ce-45c9-b429-43e24c171368","type":"message","user":"UDDCM376D","text":"コミット時点でworkflowが無いとだめなのか","ts":"1596674272.101300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dI5I1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"05176f08-9e29-4e40-aa2b-f1552848ddf5","type":"message","user":"UDDCM376D","text":"ありがとうございます","ts":"1596674286.101500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"J9oiF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"12661a44-fb89-48b9-8c37-b9dc9c7d4be6","type":"message","user":"UDDCM376D","text":"できた","ts":"1596674552.101800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oDMUq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b0befdb2-43d7-494d-8eb7-1e98239f7906","type":"message","user":"UDDCM376D","text":"感謝","ts":"1596674559.102100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Wpzv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
