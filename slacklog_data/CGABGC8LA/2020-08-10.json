[{"client_msg_id":"3d9f6496-b56a-4d22-aecc-57fafa7bc2bf","type":"message","user":"U03C6TEAZ","text":"DecodeRuneInString で読み取りつつ size を加算していってオーバーしたらやめる。","ts":"1596993478.081000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aWZ4Q"}]},{"client_msg_id":"ec92d79d-ab27-42a7-9780-0e511a9fcc29","type":"message","user":"UERCTTT8B","text":"SO なんですか","ts":"1596993077.080100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4M9/u"}]},{"client_msg_id":"922e14b2-a180-45f8-a325-3ead96267ad9","type":"message","user":"U03C6TEAZ","text":"SO に載ってるコードでサイズオーバーしたらカットする様なコードで合ってます。","ts":"1596992768.079700","team":"T03C4RC8V","reactions":[{"name":"mattn_yoshi","count":2,"users":["UKHUVMBJR","U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"L3r"}]},{"client_msg_id":"e34274be-ec4d-4b3e-83c0-9ef6b1ba0c2c","type":"message","user":"U03C71D7H","text":"Go なんもわからんのでコピペでコード書いてるのでそろそろ怒られそう","ts":"1596992710.079200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HpG"}]},{"client_msg_id":"375f32f2-cd59-46bf-8852-576ed893f0cb","type":"message","user":"U03C71D7H","text":"UTF-8 は任意のバイトを見ればそのバイトが何バイトで構成されている文字の何バイト目かが一発でわかるようになってます。そういうエンコーディングです。","ts":"1596992531.078600","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":2,"users":["U9S4G0LJW","U8R597E9H"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fJQ"}]},{"client_msg_id":"3646bd52-a816-4fdc-87b1-be64516c6623","type":"message","user":"U03C71D7H","text":"まあとりあえずさっきのコードでできたのでよし","ts":"1596992482.077700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kJQr7"}]},{"client_msg_id":"cff73830-2f93-4d87-a670-2394029c9d2f","type":"message","user":"U9S4G0LJW","text":"末尾から読んでいって一番最後のruneとして読めるものが確定できれば先頭から舐める必要はないだろうけど、可能なんだろうか(全然詳しくないので適当言ってます)","ts":"1596992473.077500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=cnw"}]},{"client_msg_id":"26f32150-042a-4d86-bbe8-50a04d2e8209","type":"message","user":"U03C71D7H","text":"じゃあやっぱり UTF-8 と仮定できるなら先頭から舐めないといけないというのはおかしい気がするけどな","ts":"1596992319.076500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6sF"}]},{"client_msg_id":"d5149f61-951a-4524-9e95-2b868c5c8b63","type":"message","user":"U03C71D7H","text":"string 自体は任意のバイト列だけど、rune として扱う場合は UTF-8 という仮定があるってことなのか","ts":"1596992289.075900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HRPd"}]},{"client_msg_id":"1f696341-0439-4102-8051-dac7825ee35a","type":"message","user":"U9S4G0LJW","text":"runeへの変換時にUTF-8を仮定してるみたいですね","ts":"1596992155.075200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"faqoJ"}]},{"client_msg_id":"693cb353-1cd9-4f9f-97ff-31b05c8dd552","type":"message","user":"U9S4G0LJW","text":"\u003chttps://golang.org/ref/spec#Conversions_to_and_from_a_string_type\u003e","ts":"1596992143.074700","attachments":[{"fallback":"The Go Programming Language Specification - The Go Programming Language","id":1,"title":"The Go Programming Language Specification - The Go Programming Language","title_link":"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type","text":"Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.","blocks":null,"service_name":"golang.org","service_icon":"https://golang.org/favicon.ico","from_url":"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type","original_url":"https://golang.org/ref/spec#Conversions_to_and_from_a_string_type"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3bf"}]},{"client_msg_id":"6a8da843-93a3-404f-afc8-1bb146080523","type":"message","user":"U03C71D7H","text":"内部のエンコーディング方式が不明なのにどうやって rune に変換しているんだろう","ts":"1596992029.074500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XKm"}]},{"client_msg_id":"1a5c175c-3340-4fd9-a006-2b4921963516","type":"message","user":"U03C71D7H","text":"割と困りますね…","ts":"1596991994.074000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DHo2"}]},{"client_msg_id":"f966cd8e-b2df-4f17-8171-08ba7e9f8d3a","type":"message","user":"UERCTTT8B","text":"そうとは限らないですね","ts":"1596991968.073800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eYCv"}]},{"client_msg_id":"01bd0598-ec53-44d0-9606-58e2acdd0983","type":"message","user":"UERCTTT8B","text":"UTF-8 じゃない string もつくれるので","ts":"1596991963.073600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Hes"}]},{"client_msg_id":"42432227-167c-477d-aa10-34841afcbdbc","type":"message","user":"U03C71D7H","text":"そうとは限らない?","ts":"1596991962.073500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"K892"}]},{"client_msg_id":"079b3418-ea80-4306-9d5d-03385232ddcd","type":"message","user":"U03C71D7H","text":"\u0026gt; Goのstring確かただのバイト列なので全体舐めるしかないはず\nでも UTF-8 なんですよね?","ts":"1596991946.073200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NX0a"}]},{"client_msg_id":"3942998c-cc6f-4e3b-a2e6-6953989a0776","type":"message","user":"UKHUVMBJR","text":"まあ結局そんな感じになりそうですね","ts":"1596991793.072600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oF5Rn"}]},{"client_msg_id":"9dc5db42-0213-46b6-a2ff-b214928f2dbe","type":"message","user":"U9S4G0LJW","text":"Goのstring確かただのバイト列なので全体舐めるしかないはず","ts":"1596991783.072300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rRP"}]},{"client_msg_id":"199d3ab3-a5df-4c8a-9875-97c57c178d37","type":"message","user":"U03C71D7H","text":"\u003chttps://stackoverflow.com/questions/20401873/remove-invalid-utf-8-characters-from-a-string\u003e これでできそう。末尾だけじゃなくて全体舐めるっぽいけど","ts":"1596991742.071700","attachments":[{"fallback":"Stack Overflow: Remove invalid UTF-8 characters from a string","id":1,"title":"Remove invalid UTF-8 characters from a string","title_link":"https://stackoverflow.com/questions/20401873/remove-invalid-utf-8-characters-from-a-string","text":"I get this on json.Marshal of a list of strings: json: invalid UTF-8 in string: \"...ole\\xc5\\\" The reason is obvious, but how can I delete/replace such strings in Go? I've been reading docst on un...","thumb_url":"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon@2.png?v=73d79a89bded","blocks":null,"service_name":"Stack Overflow","service_icon":"https://cdn.sstatic.net/Sites/stackoverflow/Img/apple-touch-icon.png?v=c78bd457575a","thumb_width":316,"thumb_height":316,"from_url":"https://stackoverflow.com/questions/20401873/remove-invalid-utf-8-characters-from-a-string","original_url":"https://stackoverflow.com/questions/20401873/remove-invalid-utf-8-characters-from-a-string"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PffR"}]},{"client_msg_id":"9518a3ed-2489-44f4-9a08-170a02e477f2","type":"message","user":"UKHUVMBJR","text":"\u003chttps://pkg.go.dev/strings?tab=doc#Reader.ReadRune\u003e\nとかで1runeずつ読んでサイズがオーバーしたら終わる、みたいな","ts":"1596991649.071300","attachments":[{"fallback":"strings package · pkg.go.dev","id":1,"title":"strings package · pkg.go.dev","title_link":"https://pkg.go.dev/strings?tab=doc#Reader.ReadRune","text":"Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.","blocks":null,"service_name":"pkg.go.dev","service_icon":"https://pkg.go.dev/favicon.ico","from_url":"https://pkg.go.dev/strings?tab=doc#Reader.ReadRune","original_url":"https://pkg.go.dev/strings?tab=doc#Reader.ReadRune"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"p+j7"}]},{"client_msg_id":"be856a9b-d60f-4ca9-b778-d6094eef38c3","type":"message","user":"U03C71D7H","text":"それにしてもやり方がよくわからず","ts":"1596991589.070700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lGRk"}]},{"client_msg_id":"71b9c70e-ccf3-4514-8439-3b9494e7d00e","type":"message","user":"UKHUVMBJR","text":"rune単位で何かやるときって大体先頭から舐めていくしかない気がするんですけど、どうなんでしょ","ts":"1596991540.070500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1oO"}]},{"client_msg_id":"007c9b56-ddaa-4c8b-8727-c56df26cbb03","type":"message","user":"U03C71D7H","text":"ぶっ壊れた文字を `utf8.ValidRune()` に渡しても true 返ってくる…","ts":"1596990728.069900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JIBo"}]},{"client_msg_id":"c3a2d65e-2e4f-43d1-b6af-5a76debc4df2","type":"message","user":"U03C71D7H","text":"Go で string を n バイト以下に、ただし rune 単位で切り詰めたい(末尾の文字の rune が壊れていたら消したい)んですがどうするのがいいでしょう?","ts":"1596989961.069400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hGhWx"}]}]
