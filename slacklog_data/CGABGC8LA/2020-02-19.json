[{"client_msg_id":"9e7ffa8d-35ac-4e6f-8040-85ff65de7df2","type":"message","user":"UGP5AJKU4","text":"( <#CQ57P4XU4|lsp> で聞いたほうがいいかもしれませんが…)\nmonorepoでgo module管理のプロジェクトを見ると何故かvim-lspが標準ライブラリ以外参照できなくなるんですが、何か制約あるんでしょうか？\n\nmonorepoのgoのプロジェクト部分だけをゴッソリ抜き出すと普通にvim-lspで参照出来るんですが","ts":"1582109196.148700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1YO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ccccf7c6-a92d-437b-ac1d-303d9a2d2fc4","type":"message","user":"U03C6TEAZ","text":"ファイル数、多いですか？","ts":"1582109267.149100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KfN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7aaa1462-6198-4654-8725-ac28cefd4a4b","type":"message","user":"UGP5AJKU4","text":"今のところそこまでは多くないです。\nGoの部分は全体で100ファイル行かないぐらいとか程度だと思います。\nちなみに、普通にgo build とかは出来ています。\nいまちょっとローカルで場所を変えたりとかイジったりとかして原因探し中なのですが、全然検討つかず…聞いてみました。","ts":"1582109439.152300","edited":{"user":"UGP5AJKU4","ts":"1582109460.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/rsE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8f9f202a-cd75-4927-96bc-a4118ab7fc42","type":"message","user":"U03C6TEAZ","text":"root_uri の指定は go.mod のある位置ですか？","ts":"1582109589.154000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Dps20"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"605bb59d-3582-4463-a4de-4ad8ed1369d3","type":"message","user":"UGP5AJKU4","text":"えーっと、、root_uriはvim-lsp-settingsに任せるようにしていて\nカレントディレクトリはGoのプロジェクトのところ(go.modのある位置)にある状態でvimを開いています。","ts":"1582110431.155400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0Xj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5072851e-cca8-4254-8c31-ddcfc2246132","type":"message","user":"UGP5AJKU4","text":"vim-lsp-settings 外して\n`'root_uri': { server_info-&gt;lsp#utils#path_to_uri(lsp#utils#find_nearest_parent_directory(lsp#utils#get_buffer_path(), 'go.mod'))},`\n指定してregister_serverしてみましたが、やはりmonorepoの構成だとうまくいかないようでした。\nmonorepoでなければうまくいくようです。","ts":"1582115630.156600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MVFsK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6cbbfb1b-c722-48f9-8ee6-15dccff3d12a","type":"message","user":"U03C6TEAZ","text":"ディレクトリの walk が遅いからかなと思いましたが一応色々よけてる様ですね。","ts":"1582115981.157200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pA2N"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bc743a13-d470-430f-bbe6-4d617c219666","type":"message","user":"U03C6TEAZ","text":"```\t\tif base == \"\" || base[0] == '.' || base[0] == '_' ||\n\t\t\tbase == \"testdata\" ||\n\t\t\t(w.root.Type == RootGOROOT &amp;&amp; w.opts.ModulesEnabled &amp;&amp; base == \"vendor\") ||\n\t\t\t(!w.opts.ModulesEnabled &amp;&amp; base == \"node_modules\") {\n\t\t\treturn filepath.SkipDir\n\t\t}```","ts":"1582115985.157500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BPyDK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a4abecea-66ee-4cfd-8046-0c2baeae3300","type":"message","user":"U03C6TEAZ","text":"あと確認できるとすればログくらいだと思います。","ts":"1582116054.158600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"77d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d2b31168-0479-4c09-8f41-215157ac2664","type":"message","user":"UGP5AJKU4","text":"こんな感じなのですが\n\n```hogehoge\n    |___packages/api &lt;- これがGoのプロジェクト\n    |___packages/webapp\n    |___packages/fuga\n    |___packages/piyo```\n\nhogehoge 直下の `.git` を丸々消してみると正常に動くようになりました…？何故なのかはわからないですが","ts":"1582116153.160400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Fxmw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a896f4a2-4d0f-47a4-90d7-84cbfe40507c","type":"message","user":"U03C6TEAZ","text":"あとシンボリックリンクがあると辿る作りになってます。","ts":"1582116154.160500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CBK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ba754ea9-de10-4ab3-bb3c-7d75f4a2c8de","type":"message","user":"UAZ33BKV2","text":".gitがあると、そちらが優先的にroot_uriとして認識されてる...とかではないだろうとは思うのですが、不可解ですねえ..","ts":"1582116219.161200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FuiD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8687b61f-bdc0-4be6-a0af-4c17d9a823d9","type":"message","user":"U03C6TEAZ","text":"vim-lsp の方は現在の uri から上昇する作りになってたと思います。","ts":"1582116248.161600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d/h8i"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"377c8157-2dbb-40bd-810e-8c9bd1b5918f","type":"message","user":"U03C6TEAZ","text":"vim-findroot みたいなプラグインが入ってると cwd を hogehoge に戻されたりしますね。","ts":"1582116314.162400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QdhW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"14d8db44-4870-4677-b2e0-636d96124055","type":"message","user":"UAZ33BKV2","text":"カレントをhogehogeにされて下にあるgo.modを見付けられない+.gitがあってそこに固定される?","ts":"1582116350.162900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5Oqy5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f95d86e3-f30e-4a29-9a62-5df8d2a130af","type":"message","user":"U03C6TEAZ","text":"この条件であれば巨大リポじゃなくても再現できそうですし、あとで試してみます。","ts":"1582116403.164000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yv8WF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"009ef7f1-5821-4a56-ad93-40b95fbfa292","type":"message","user":"UAZ33BKV2","text":"あ、.gitがカレントを上にする、か","ts":"1582116407.164400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ve1e"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9cff0a0d-761c-4565-9b5b-452f74aa1622","type":"message","user":"U03C6TEAZ","text":".oO( 原稿ががが )","ts":"1582116411.164500","team":"T03C4RC8V","reactions":[{"name":"totemoturai","count":1,"users":["UGP5AJKU4"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CV8X"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"09a3b63e-ec40-4b1a-b791-e0961cce2f4e","type":"message","user":"UGP5AJKU4","text":"動き的にはそうですね、 おそらく `.git` の階層で root_uriが解決されてる感じです。\nあと多分monorepoもGoもあまり関係なくて <#CQ57P4XU4|lsp> な話でした…","ts":"1582116446.165100","edited":{"user":"UGP5AJKU4","ts":"1582116496.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2W0G"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5712c24d-a059-483e-9191-b3a24b6a220c","type":"message","user":"U03C6TEAZ","text":"あー","ts":"1582116522.165700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3cq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a54a0584-c39f-49e0-bd2e-2f480208aa7d","type":"message","user":"U03C6TEAZ","text":"自分で上昇して traversal してると思ったら vim の finddir 使ってるのを見てしまった時の顔","ts":"1582116550.166500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xxuS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"572dff8f-e42f-4ad9-8633-28431dc1a2f7","type":"message","user":"UGP5AJKU4","text":"あ、あと補足ですが monorepo内のtypescript-language-serverの方は普通に動いてる感じです。","ts":"1582116653.167500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yLK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"060e22a8-d3cd-4e86-bfc9-b993ba47b3a8","type":"message","user":"U03C6TEAZ","text":"`.;` じゃないと下降になるんだっけ","ts":"1582116676.167800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G1KN6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cf027146-abe7-42c5-9bcb-659b165e60e4","type":"message","user":"U03C6TEAZ","text":"typescript-language-server の方は .git が root であってもなくても動きそうな気はします。","ts":"1582116705.168300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"68aw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"351db33d-df6b-40e2-9c69-e70acd0481b3","type":"message","user":"U03C6TEAZ","text":"go は go.mod のある場所が root じゃないと動かなそう。","ts":"1582116724.168700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BVp8S"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"529ccb25-69e9-4ddc-a378-83e485de871a","type":"message","user":"UAZ33BKV2","text":":help file-searching","ts":"1582116788.169000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xkPl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"60c074fc-39b8-41f7-bafd-bda297558001","type":"message","user":"UAZ33BKV2","text":"まあないよな","ts":"1582116792.169200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"n81"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"943f7675-d4a3-4c09-97bc-feb327ae4104","type":"message","user":"UAZ33BKV2","text":"<https://vim-jp.slack.com/archives/C03C4RC9F/p1582116803314400>","ts":"1582116812.169400","attachments":[{"fallback":"[February 19th, 2020 4:53 AM] vimhelp: ```\n11. ファイル検索                                        *file-searching*\n \n{Vimが |+path_extra| 機能付きでコンパイルされたときのみ有効}\n \n現在の所、オプション 'path', 'cdpath', 'tags' と|finddir()|, |findfile()| で、\n本節で説明する「ファイル検索」にしたがってワイルドカードの展開が行われる。\nそれ以外のコマンドでは |wildcards| という少し異なるルールにしたがう。\n \nファイル検索には以下の3種類がある:\n```","id":1,"author_id":"UPZHKAM7W","author_subname":"vimhelp","author_link":"https://vim-jp.slack.com/services/BPM858KEE","author_icon":"https://a.slack-edge.com/80588/img/services/hubot_48.png","text":"```\n11. ファイル検索                                        *file-searching*\n \n{Vimが |+path_extra| 機能付きでコンパイルされたときのみ有効}\n \n現在の所、オプション 'path', 'cdpath', 'tags' と|finddir()|, |findfile()| で、\n本節で説明する「ファイル検索」にしたがってワイルドカードの展開が行われる。\nそれ以外のコマンドでは |wildcards| という少し異なるルールにしたがう。\n \nファイル検索には以下の3種類がある:\n```","mrkdwn_in":["text"],"blocks":null,"footer":"Posted in #random","ts":1582116803.314400,"from_url":"https://vim-jp.slack.com/archives/C03C4RC9F/p1582116803314400","original_url":"https://vim-jp.slack.com/archives/C03C4RC9F/p1582116803314400"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MhV5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a8a3b78e-8a80-47be-a2d4-e398729d7948","type":"message","user":"U03C6TEAZ","text":"<https://github.com/vim-jp/issues/issues/1176>","ts":"1582116820.169800","attachments":[{"fallback":"GitHub: C ドライブ直下での finddir() による上方検索の結果が想定した動作と異なる · Issue #1176 · vim-jp/issues","id":1,"title":"C ドライブ直下での finddir() による上方検索の結果が想定した動作と異なる · Issue #1176 · vim-jp/issues","title_link":"https://github.com/vim-jp/issues/issues/1176","text":"質問・報告の内容 C ドライブ直下での finddir() による上方検索の結果が、想定した動作と異なります。 &amp;quot; 前提条件、:pwd で見えるカレントディレクトリに .git フォルダがあって、 &amp;quot; C ドライブ直下には .git フォルダがない状態。 :echo finddir(&amp;#39;.git&amp;#39;, &amp;#39;C:\\&amp;#39;) &amp;quot; 何も表示されな...","thumb_url":"https://avatars2.githubusercontent.com/u/1051958?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/vim-jp/issues/issues/1176","original_url":"https://github.com/vim-jp/issues/issues/1176"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ns8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"721c26f6-2b38-4924-9378-d219609758f1","type":"message","user":"U03C6TEAZ","text":"これか？","ts":"1582116822.170200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NTCTG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6edaa3a5-a536-478b-9acb-ccd686fb6eb4","type":"message","user":"UAZ33BKV2","text":"普通は下 `;` で上","ts":"1582116825.170400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8Cj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8b5241aa-628b-464a-8133-6b6bbf9302ae","type":"message","user":"U03C6TEAZ","text":"あ、いや違う。","ts":"1582116856.170800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Z2o"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6dabc913-f17f-4dad-b26e-c1d4eebd683b","type":"message","user":"UAZ33BKV2","text":"かな...?","ts":"1582116883.171000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qJAn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7f901568-8746-4277-ba1e-e07bb6a515e2","type":"message","user":"U03C6TEAZ","text":"後でちゃんと時間取ろう。(原稿...)","ts":"1582116907.171700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gio"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d2d4831f-67a2-4517-a0f8-3fee508eb13f","type":"message","user":"UNJ2DANJC","text":"testifyのcontributing guide 責任の重さが伝わってくる <https://github.com/stretchr/testify/blob/master/CONTRIBUTING.md>\n\n```Quality isn't an afterthought - Testify is a testing library, so it seems reasonable that we should have a decent test suite. This is doubly important because a bug in Testify doesn't just mean a bug in our users' code, it means a bug in our users' tests, which means a potentially unnoticed and hard-to-find bug in our users' code.```","ts":"1582086030.142700","attachments":[{"fallback":"GitHub: stretchr/testify","id":1,"title":"stretchr/testify","title_link":"https://github.com/stretchr/testify/blob/master/CONTRIBUTING.md","text":"A toolkit with common assertions and mocks that plays nicely with the standard library - stretchr/testify","thumb_url":"https://avatars2.githubusercontent.com/u/1841476?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":168,"thumb_height":168,"from_url":"https://github.com/stretchr/testify/blob/master/CONTRIBUTING.md","original_url":"https://github.com/stretchr/testify/blob/master/CONTRIBUTING.md"}],"edited":{"user":"UNJ2DANJC","ts":"1582086072.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1hR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
