[{"type":"message","user":"UR4M5BQSY","text":"<@UR4M5BQSY> has joined the channel","ts":"1575213336.312400","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"fd5ebf28-616d-416f-8cf0-a5fcd9c4575d","type":"message","user":"U03C6TEAZ","text":"途中から「そうじゃない」感がある。 <https://imil.net/blog/2019/11/27/Understanding-golang-channel-range-again/>","ts":"1575253141.313100","attachments":[{"fallback":"iMil.net: Understanding golang channel range... again","id":1,"title":"Understanding golang channel range... again","title_link":"https://imil.net/blog/2019/11/27/Understanding-golang-channel-range-again/","text":"thy who never fails, neither succeeds","blocks":null,"service_name":"iMil.net","from_url":"https://imil.net/blog/2019/11/27/Understanding-golang-channel-range-again/","original_url":"https://imil.net/blog/2019/11/27/Understanding-golang-channel-range-again/"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JfI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"465a7bfa-31d7-422c-9650-b65091033d1c","type":"message","user":"U03C6TEAZ","text":"ジェネレータパターンで書いたら綺麗になるやつ。","ts":"1575253474.313500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lBvJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a025e9f-c9b5-473a-89e7-bc16b21002ca","type":"message","user":"UG6DF6W87","text":"<https://play.golang.org/p/OF7E9St5PR0>\nこんなかんじ...?","ts":"1575254672.313900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7ue="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0ea56fd0-5e7b-425e-88ef-dc45f5a03d22","type":"message","user":"U03C6TEAZ","text":"はい。","ts":"1575254841.314500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"d+M"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c28226a9-64c4-48a5-8ebf-8bdc555dcb4f","type":"message","user":"U03C6TEAZ","text":"こうしないと range chan の最初を抜き取るタイミングで並行にできないんですよね。","ts":"1575254878.315200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ncj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ac9d2f8c-7e3e-4d02-87b4-c7a96a7ee608","type":"message","user":"U03C6TEAZ","text":"パフォーマンスは pthread 使ったのと大して変わらなくなる。","ts":"1575254931.315700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mh33"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dc97762a-0c5e-4bd5-a28f-569a6ec8d80e","type":"message","user":"U03C6TEAZ","text":"```var wg sync.WaitGroup\n\tc := make(chan string)\n\tfor _, t := range []string{\"a\", \"b\", \"c\"} {\n\t\twg.Add(1)\n\t\tgo func(s string) {\n\t\t\tfmt.Printf(\"go %s, before chan\\n\", s)\n\t\t\tc &lt;- s\n\t\t\tfmt.Printf(\"go %s, after chan\\n\", s)\n\t\t\twg.Done()\n\t\t}(t)\n\t}\n\n\tgo func() {\n\t\tc &lt;- \"oooweeeee I'm still heeeere\"\n\t\ttime.Sleep(time.Second * 2) // wait 2 seconds\n\t\tfmt.Println(\"ran now\")\n\t\twg.Wait()\n\t\tclose(c)\n\t}()\n\n\tfor s := range c {\n\t\tfmt.Println(s)\n\t}```\nブログの例だと c の受信を始める時点では goroutine が 3 つともブロックした状態で止まって何も仕事してなくて、1個抜き取るごとにバラバラーと動く。","ts":"1575255092.317400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5Xb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"894ed152-23c2-45c4-941f-c0b00160bfa8","type":"message","user":"UG6DF6W87","text":"あーたしかに、そうですね","ts":"1575255162.317700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HcnY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b42d610e-7271-4921-94e1-8cd24b8e6616","type":"message","user":"U03C6TEAZ","text":"最近は context 持たせるのがほぼ定石になってきたので sonictemplate に雛形書きたい。","ts":"1575255453.318600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Gi6F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c85e2e7a-3d90-404b-923a-7cc6d5ea5573","type":"message","user":"U03C6TEAZ","text":"こういう奴 <https://play.golang.org/p/Dfl_6Kc7rJ1>","ts":"1575255471.319000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/uleW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5e960c1d-90cf-4ddf-bf88-03cc404f57ea","type":"message","user":"U03C6TEAZ","text":"ブログのはシーケンシャルじゃないので等価にするならこうかな","ts":"1575256063.319800","team":"T03C4RC8V","reactions":[{"name":"tashikani","count":1,"users":["UG6DF6W87"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/f5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"79621bd4-17e9-4d3b-baa8-1e8c1ea2c3a0","type":"message","user":"U03C6TEAZ","text":"<https://play.golang.org/p/Q4QoxzDKWwB>","ts":"1575256063.319900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JM=hM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"97970da2-03c9-4fb0-a633-789162393fa4","type":"message","user":"U06BRP8VD","text":"僕の感覚では、chan は書く側は常に1人が好ましい。","ts":"1575257819.320600","team":"T03C4RC8V","reactions":[{"name":"wakaru","count":1,"users":["UG6DF6W87"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8zpmg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"65da3d23-cf3f-4041-b686-ab807c7796ff","type":"message","user":"U06BRP8VD","text":"じゃないとcloseのタイミングが取れないのよね。非同期にcloseされちゃう可能性のあるchanに書くのはとてもむずかしい。","ts":"1575258043.321500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GOP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"UJV2VRS9X","text":"<@UJV2VRS9X> has joined the channel","ts":"1575271444.322600","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null}]
