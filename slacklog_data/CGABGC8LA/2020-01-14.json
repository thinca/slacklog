[{"client_msg_id":"da1018bc-abac-4c27-a8c3-64958ffb0a26","type":"message","user":"U06BRP8VD","text":"ふむ。小さいstackについてはspanを更に分割して使ってるっぽい。","ts":"1578990169.118200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dC+kb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0457906b-f929-47d8-8d3a-b7e33898c044","type":"message","user":"UDDCM376D","text":"<@U03C6TEAZ> <https://github.com/mattn/go-sqlite3> ドライバについて質問です\nSQLiteの実態ってファイルと思いますが、go-sqlite3って実際ファイルへの書き込みは C のライブラリでやっているんですか？","ts":"1578990208.118700","attachments":[{"fallback":"GitHub: mattn/go-sqlite3","id":1,"title":"mattn/go-sqlite3","title_link":"https://github.com/mattn/go-sqlite3","text":"sqlite3 driver for go using database/sql. Contribute to mattn/go-sqlite3 development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/go-sqlite3","original_url":"https://github.com/mattn/go-sqlite3"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2A1N"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ac6b359b-d59c-48cc-87ef-4c46f09ceb7b","type":"message","user":"U06BRP8VD","text":"go-sqlite3はそもそもCで書かれたsqlite3を呼び出してるだけですよ～","ts":"1578990281.119300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iY5Xp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"71b8346e-ee28-4bfb-8f95-f0a352e1c744","type":"message","user":"U03C6TEAZ","text":"C の binding です。","ts":"1578990361.119700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k3C7m"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3505cd9d-825a-479e-82da-655ee9f4d457","type":"message","user":"UDDCM376D","text":"ありがとうございます\nCでは、ファイルへの書き込み処理もやっている理解であっていますか？","ts":"1578990448.120700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gzTnL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"608f9b2d-ae3f-4e7f-8e7a-bc4c2178cebe","type":"message","user":"U03C6TEAZ","text":"はい。","ts":"1578990479.121000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zYtZP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"be85db82-dcbd-4905-a926-aa3250cc321d","type":"message","user":"UDDCM376D","text":"ありがとうございます！","ts":"1578990483.121200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sClSQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fad3f47e-805b-4118-9fe0-f0ed8de3dd4f","type":"message","user":"U06BRP8VD","text":"Cで実際に書いてるコードはこのあたりだけど、ちょっと初心者だと読みにくいかも。\n<https://github.com/sqlite/sqlite/blob/master/src/os_unix.c>","ts":"1578990627.121900","attachments":[{"fallback":"GitHub: sqlite/sqlite","id":1,"title":"sqlite/sqlite","title_link":"https://github.com/sqlite/sqlite/blob/master/src/os_unix.c","text":"Official Git mirror of the SQLite source tree. Contribute to sqlite/sqlite development by creating an account on GitHub.","thumb_url":"https://avatars0.githubusercontent.com/u/48680494?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":290,"thumb_height":290,"from_url":"https://github.com/sqlite/sqlite/blob/master/src/os_unix.c","original_url":"https://github.com/sqlite/sqlite/blob/master/src/os_unix.c"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UN0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2388a7ac-7846-4eae-ba4b-dafe911a8a10","type":"message","user":"U06BRP8VD","text":"`osWrite()` とかそのへんっぽい。","ts":"1578990645.122400","thread_ts":"1578990645.122400","reply_count":2,"replies":[{"user":"U06BRP8VD","ts":"1578990701.122500"},{"user":"U06BRP8VD","ts":"1578990771.122700"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kye5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7e77ebb8-a6e3-4fb9-b1f7-f31f0d663c5d","type":"message","user":"U06BRP8VD","text":"ほんと読むには極悪な構成だw","ts":"1578990701.122500","thread_ts":"1578990645.122400","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jmjWp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c06e9f5-a74e-4efb-a572-355a4986b179","type":"message","user":"U06BRP8VD","text":"うーんわかるけどもw","ts":"1578990771.122700","thread_ts":"1578990645.122400","parent_user_id":"U06BRP8VD","files":[{"id":"FSB1TSCLR","created":1578990771,"timestamp":1578990771,"name":"Untitled","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"c","pretty_type":"C","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":264,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FSB1TSCLR/untitled","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FSB1TSCLR/download/untitled","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FSB1TSCLR/untitled","permalink_public":"https://slack-files.com/T03C4RC8V-FSB1TSCLR-c7544ee621","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FSB1TSCLR/untitled/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OtJ"}]},{"client_msg_id":"50209d3a-2909-4f2f-a7d6-0f54f2735fdb","type":"message","user":"UDDCM376D","text":"ありがとうございます\nC、雰囲気で読んでいますｗ","ts":"1578990895.123500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"n8gcQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7b58d8ce-0beb-438a-b551-51b193dc0d46","type":"message","user":"U06BRP8VD","text":"osWrite = write システムコールだとおもって読めばよいです。あとは osXxx はだいたい同じっぽ。","ts":"1578991167.124600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xReyx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec6e4ef4-c986-4018-acc7-0350e8f2a215","type":"message","user":"U03C6TEAZ","text":"何がやりたいか言って頂いたら即答できる可能性あります。","ts":"1578991420.124900","team":"T03C4RC8V","reactions":[{"name":"sasumatsu","count":2,"users":["U06BRP8VD","UA4RVLHK7"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ghf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8aa2dbdd-18cc-4e2a-b26d-01f9523c7847","type":"message","user":"UDDCM376D","text":"&gt; osWrite = write システムコールだとおもって読めばよいです。あとは osXxx はだいたい同じっぽ。\nありがとうございます！","ts":"1578991967.125200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uSj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9a756e3d-16c9-4a04-9345-9ff9ce8ef2df","type":"message","user":"UDDCM376D","text":"&gt; 何がやりたいか言って頂いたら即答できる可能性あります。\nえっと、説明が難しいですが、ざっくり話しますと\n\n組み込みでSQLiteを使おうとしていますが、\n電源断のときにSQLiteがどういった動きをするのかを大まか知りたい\nというのが質問の意図でした\n\nで、SQLiteの実態はファイルで、それにwriteしているだけってのがわかったので、\nあとはファイルシステム周りの調査をしている\nという感じです\n（わかりづらくてすいません）","ts":"1578992195.129400","edited":{"user":"UDDCM376D","ts":"1578992215.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"h+0s0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"86e1cac9-6121-4ab4-a8c4-f6786e40cf4d","type":"message","user":"U03C6TEAZ","text":"flush してるかどうかの話ですかね。","ts":"1578992240.129800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"INhf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4cffcfdf-fece-4eb3-8fdd-f3ae49560a18","type":"message","user":"U03C6TEAZ","text":"接続文字列に `?_sync=FULL` 入れると sync してくれたはず。","ts":"1578992278.130900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"stA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8cf31fbc-0442-4d67-bb1b-e8d77861d820","type":"message","user":"UDDCM376D","text":"そこらへんは、じつはあんまりわかっていなくて、それも含めて調べています","ts":"1578992281.131000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rpWw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d09f95f9-7e9b-481f-b14b-1659c8503218","type":"message","user":"U03C6TEAZ","text":"なるほ。","ts":"1578992288.131400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zn="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4a3cefce-8e55-43f7-9877-3a241d92b5cf","type":"message","user":"UDDCM376D","text":"SQLiteはバッファリングして、まとめてflushする動きになっているんですか？","ts":"1578992310.131900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"C3W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"90c6bbe1-8641-46d6-901d-d256ac9e724b","type":"message","user":"U03C6TEAZ","text":"そうなってると思います。","ts":"1578992345.132200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JEx9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c284ba97-0977-494e-97bf-302cd8a6d59e","type":"message","user":"UDDCM376D","text":"ってことは、複数回flushすることもあるですかね","ts":"1578992381.132800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KcGLP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7a98ecee-546e-4898-bf82-de55eaca98ce","type":"message","user":"UDDCM376D","text":"というか基本そうなる…？","ts":"1578992389.133200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"X3u"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bb5e7a67-0c55-4959-b20e-f758392763ce","type":"message","user":"U06BRP8VD","text":"あーそういうこと知りたいんだと、もうちょっとハイレベルな知識も要りそうだな。","ts":"1578992452.134000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1JuIw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d24118bf-f9ad-422c-8bb2-7e1d0808a388","type":"message","user":"U03C6TEAZ","text":".sqlite ファイルが壊れる可能性でしょうかね。","ts":"1578992478.134700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+OVd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2402948d-1138-411b-a0c5-a6ab76e5aa9a","type":"message","user":"U06BRP8VD","text":"<https://www.sqlite.org/wal.html>","ts":"1578992502.135300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wJelV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"15feffa1-ba76-4e1a-abf5-fdf6c1b31fa4","type":"message","user":"UDDCM376D","text":"ですよね…\n単純に、SQLite書き込み中、タイミングによってはファイルが壊れる可能性があると思っていて、\nそれを回避する方法を知りたいってだけですが、多分ファイルシステム周りのことを知らないと行けないですよね","ts":"1578992540.136600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dkq4G"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"46aa10e8-89d8-40a2-877a-515385f821b8","type":"message","user":"U06BRP8VD","text":"WALの導入で壊れることはほぼなくなった(というか復旧できる)と言って良いと思う。一方でfsync間に合わず書けないと失われる。","ts":"1578992545.136800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BIx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d189ab80-03fa-4f40-9134-7e80cc1abee1","type":"message","user":"UDDCM376D","text":"ありがとうございます\nwalのページ、見てみます","ts":"1578992570.137100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Euz3I"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5611bee0-2e86-456f-8e2c-724c677f7660","type":"message","user":"U06BRP8VD","text":"あーfsync()中に落ちると、どうなるかわからない(システムに依存する)ってのはあるね。","ts":"1578992604.138100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tY=l"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"218a35fc-d25c-491a-820d-5d01057e8e1f","type":"message","user":"UDDCM376D","text":"↑ってファイルシステムに依存するところの話ですよね？","ts":"1578992639.138600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"P/vf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cb6dbb90-dc00-42e6-9d2f-905928a55cfe","type":"message","user":"U06BRP8VD","text":"ええ。そういうこと。","ts":"1578992651.139100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HLBK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"67160ee3-9ebe-4400-9a9e-1fba31d94539","type":"message","user":"U06BRP8VD","text":"# そのあたり僕も過去に通った調査だわw","ts":"1578992663.139900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JG2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6739f26d-a43d-4ece-b3c9-073023512f8e","type":"message","user":"UDDCM376D","text":"どんなファイルシステムを使っているのかを今資料要請中でわからないんですよね…","ts":"1578992697.140600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k2O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bfc2b458-7dea-4cfb-afae-31bd0fc728ab","type":"message","user":"UDDCM376D","text":"なので、そこまでは一旦考えず、SQLiteで回避できる方法（WALとか？）を調べてみます","ts":"1578992736.141700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9i0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9dd85f5e-9868-46ba-920b-7ac960ba22fe","type":"message","user":"U06BRP8VD","text":"あとこれも <https://www.sqlite.org/howtocorrupt.html>","ts":"1578992739.141800","thread_ts":"1578992739.141800","reply_count":1,"replies":[{"user":"U06BRP8VD","ts":"1578992949.146500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3iJh0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9154d09-b67d-4a9a-a90e-af00ce8a8688","type":"message","user":"U06BRP8VD","text":"どうやって壊すかのドキュメント","ts":"1578992747.142000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GhxI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c3c5534e-f2a2-45b1-a527-99c647b62b8e","type":"message","user":"UDDCM376D","text":"すごいｗ","ts":"1578992756.142300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hgON"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"31ce0229-27f7-489c-9254-e195f8e9b0fe","type":"message","user":"UDDCM376D","text":"こんなドキュメントまであるのかｗ","ts":"1578992761.142600","edited":{"user":"UDDCM376D","ts":"1578992763.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Wr+8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b85cb119-6fd0-40b9-8bd6-69e609d2a8f0","type":"message","user":"U06BRP8VD","text":"っていうかいまゴリラさんが気にすることは、SQLite関係者は絶対気にしてるハズなので。","ts":"1578992818.143900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3zgF0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"231a4acc-0bc8-4289-81f0-f592c04e904d","type":"message","user":"UDDCM376D","text":"&gt; File overwrite by a rogue thread or process\nSQLiteはスレッドセーフってどっかのブログに書いてあったけど、あれは嘘情報だったのかな…","ts":"1578992842.144500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"naQPM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ec54a1ac-69c9-423a-a13c-9d7345959829","type":"message","user":"UDDCM376D","text":"&gt; っていうかいまゴリラさんが気にすることは、SQLite関係者は絶対気にしてるハズなので。\nですよねぇ","ts":"1578992850.144900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bey0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ade1b6a8-f011-4386-956f-d16958443295","type":"message","user":"U03C6TEAZ","text":"スレッドセーフはモードによりますね。","ts":"1578992864.145100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BB/83"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"88741408-5564-45d3-b73d-4d25c2ffb8b8","type":"message","user":"U03C6TEAZ","text":"あと sqlite 使ったシステムは Go じゃなくても定期的にバックアップしないと死にますね。","ts":"1578992873.145500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ah2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"854c8e0e-a95c-4242-9cde-0d942a75df7b","type":"message","user":"UDDCM376D","text":"SQLiteってモードあるんですか？","ts":"1578992885.145700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dz97"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ba4a5be2-7f93-46a1-8646-b83051aee75c","type":"message","user":"UDDCM376D","text":"定期的にバックアップ、大事","ts":"1578992893.145900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7NXb7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3fab01de-0da6-47df-b4b6-d6700c61baac","type":"message","user":"U03C6TEAZ","text":"いっぱいあります。モード。","ts":"1578992900.146200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Q/Qhi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"775b9314-5d42-4b1b-9ec4-45c94d38ea74","type":"message","user":"UDDCM376D","text":"知らなかった…","ts":"1578992907.146400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dgA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"64ae680c-7aa7-4b98-9bc7-022245797b25","type":"message","user":"U06BRP8VD","text":"fsync (flush)のはなしは3に書いてあった。","ts":"1578992949.146500","thread_ts":"1578992739.141800","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lyQGh"}],"root":{"client_msg_id":"9dd85f5e-9868-46ba-920b-7ac960ba22fe","type":"message","user":"U06BRP8VD","text":"あとこれも <https://www.sqlite.org/howtocorrupt.html>","ts":"1578992739.141800","thread_ts":"1578992739.141800","reply_count":1,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3iJh0"}]}},{"client_msg_id":"3a9cdeb4-c486-4832-b31b-46e1124757bc","type":"message","user":"U03C6TEAZ","text":"go-sqlite3 は sqlite3 を Go から使える様にした物なので、sqlite3 のデフォルトが go-sqlite3 でもデフォルトになります。","ts":"1578992989.147400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rTZ+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0f3233cc-2aee-4e17-8698-1c16ed8b5127","type":"message","user":"UDDCM376D","text":"んー、どうもファイルシステムについての基礎知識が足りない、まずはその知識を入れるところからだな…","ts":"1578993130.148300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Nn0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25e67b21-97bf-4be5-9232-e31fe200068d","type":"message","user":"U03C6TEAZ","text":"go-sqlite3 はシステムライブラリリンクと embedded ビルドの2つがあってデフォルトは embedded なんですが、その再は thread-safe 付きでビルドしてます。","ts":"1578993208.149200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9HYB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ff15d074-d3af-4fd8-af5d-23a37c2a0ba5","type":"message","user":"U03C6TEAZ","text":"どちらにしろ thread-safe をサポートしてないビルドの場合には go-sqlite3 は sql.Open で死ぬ様にしてあります。","ts":"1578993247.150000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JsyQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"583d4b58-6edc-4fe8-9356-e450ef2a0e8e","type":"message","user":"UDDCM376D","text":"なるほど\nってことはGoでsqliteを使う場合は基本スレッドセーフになっているはずってことか","ts":"1578993282.150600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CB="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd2a8c04-d60b-4823-b393-f396972eba3e","type":"message","user":"U03C6TEAZ","text":"ちなみに sqlite ファイルを複数のプロセスで触る事ってありますか？","ts":"1578993537.151100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0no"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c967fd77-8a28-45d1-95ea-c2ae5caf0b5f","type":"message","user":"U06BRP8VD","text":"組み込みだからなさげだけど…","ts":"1578993565.151800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vDn3+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dced9dd5-075e-4b38-b438-092e8af550e7","type":"message","user":"U06BRP8VD","text":"<@UDDCM376D> SQLite3ってその組み込み機器のファームにもとからあるんです? それとも自前で用意する必要があるの?","ts":"1578993596.152500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MbMWT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"00199371-8816-4e43-8fe3-9a43a548c2c9","type":"message","user":"UDDCM376D","text":"&gt; ちなみに sqlite ファイルを複数のプロセスで触る事ってありますか？\nない想定です（ぼくが聞いた限りでは）","ts":"1578993636.153000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"W1RLI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"503bed3b-00af-4b09-b4fe-b5a1d459ea16","type":"message","user":"UDDCM376D","text":"&gt; SQLite3ってその組み込み機器のファームにもとからあるんです? それとも自前で用意する必要があるの?\n多分自前で用意しないといけないですね（これは確認必要）","ts":"1578993670.153600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HoX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"37627cf4-d02f-4421-91ca-f222df64ae3d","type":"message","user":"U03C6TEAZ","text":"実際にどうなったかが知りたいですね。","ts":"1578993755.154000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"E6v"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd1d673c-a786-4cf6-8ddd-5fdec29f6f93","type":"message","user":"UDDCM376D","text":"&gt; 実際にどうなったかが知りたいですね。\n複数のプロセスからのアクセスですか？","ts":"1578993773.154700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"w3q"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"74fe3125-c469-4975-bae4-2cbe3b9c7807","type":"message","user":"U03C6TEAZ","text":"1. sqlite ファイルが壊れた\n2. DB 更新処理で失敗する様になった","ts":"1578993786.155000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IUY2s"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"783856d8-80e1-45ea-bb07-90c36da88622","type":"message","user":"U03C6TEAZ","text":"後者だと他の要因もあります。","ts":"1578993800.155600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"s+xrv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d80477c-72a1-434a-a8e9-c4e8704aa091","type":"message","user":"U03C6TEAZ","text":"僕が昔経験したやつ(sqlite3使ったCの奴)だと、組み込みのLinuxが何らかの理由でファイルシステムを RO にしちゃったというのはあります。","ts":"1578993891.156600","thread_ts":"1578993891.156600","reply_count":2,"replies":[{"user":"U06BRP8VD","ts":"1578994091.158100"},{"user":"U03C6TEAZ","ts":"1578994113.158300"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"906Z"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"efd58499-ecfd-40b3-b19b-eaeedca635ee","type":"message","user":"UAZ33BKV2","text":"ファイルアクセスでなんか問題あったときにroマウントにフォールバックする、とかでぶつかる系かな\nNAS-CDリッパー(smb mount)でぶつかったことあるなあ","ts":"1578993971.157700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KpiK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"19d3962e-567c-4daa-9ed8-8a5abac7fb3d","type":"message","user":"UDDCM376D","text":"ROにしちゃった ←怖い","ts":"1578994018.158000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0mBKu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2c6800d5-696a-4649-9578-7aed86656307","type":"message","user":"U06BRP8VD","text":"それ、なんか似たような話を見た記憶があるな…w","ts":"1578994091.158100","thread_ts":"1578993891.156600","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Tvjlf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3f96775b-0dc4-46f2-8f9d-726e74905ff5","type":"message","user":"U03C6TEAZ","text":"どこの界隈にもありそうな話w","ts":"1578994113.158300","thread_ts":"1578993891.156600","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rei"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a901ff66-4c0e-45da-9817-027121320eed","type":"message","user":"U06BRP8VD","text":"もし自前で組み込む必要あるなら <https://gitlab.com/cznic/ql> これ導入する手も0ではないかもしれない。","ts":"1578994180.159700","attachments":[{"fallback":"GitLab: cznic / ql","id":1,"title":"cznic / ql","title_link":"https://gitlab.com/cznic/ql","text":"Package ql is a pure Go embedded SQL database.","thumb_url":"https://assets.gitlab-static.net/assets/gitlab_logo-7ae504fe4f68fdebb3c2034e36621930cd36ea87924c11ff65dbcb8ed50dca58.png","blocks":null,"service_name":"GitLab","service_icon":"https://assets.gitlab-static.net/assets/touch-icon-iphone-5a9cee0e8a51212e70b90c87c12f382c428870c0ff67d1eb034d884b78d2dae7.png","thumb_width":128,"thumb_height":128,"from_url":"https://gitlab.com/cznic/ql","original_url":"https://gitlab.com/cznic/ql"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"L2+1a"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fb292966-8ab1-4943-b859-4d6454d7387f","type":"message","user":"UDDCM376D","text":"お","ts":"1578994207.161000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AEW7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ced1a321-827e-47bb-b904-ef0447c7bbf7","type":"message","user":"UDDCM376D","text":"これは","ts":"1578994209.161200","thread_ts":"1578994209.161200","reply_count":4,"replies":[{"user":"U06BRP8VD","ts":"1578994264.162300"},{"user":"UDDCM376D","ts":"1578994289.162800"},{"user":"UDDCM376D","ts":"1578994291.163000"},{"user":"UDDCM376D","ts":"1578994296.163300"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6EC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"93fb207b-ecbd-4bfd-bed4-4eedc2f4641e","type":"message","user":"U03C6TEAZ","text":"負荷試験で1000台の Linux を動かしてそこから1台に同時アクセスする試験をやってた時に、突然数100台がエラーで落ちて、調べてみたら全部 RO になってた事がある。","ts":"1578994209.161300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OeUx"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d204410-4732-407e-b421-1ed1b0215a75","type":"message","user":"U06BRP8VD","text":"ただ、どうやってもgoはminimum要件がでかいのよね。組み込みっていってもLinuxが入るのから、そうでないのまであってLinux入るやつでもメモリが大きい言われまくることがある。","ts":"1578994251.162000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/afZy"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c9eb605-f46f-48e0-af40-5a835c36b887","type":"message","user":"U06BRP8VD","text":"SQLite3をgoにコンバートしたやつ。","ts":"1578994264.162300","thread_ts":"1578994209.161200","parent_user_id":"UDDCM376D","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bTN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"37510281-9c31-4d0b-897d-31016b7c9049","type":"message","user":"UDDCM376D","text":"おおおお\npure GoでSQlite使えるのか","ts":"1578994289.162800","thread_ts":"1578994209.161200","parent_user_id":"UDDCM376D","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NMfmt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bd70a754-5fc0-4010-adf9-c082d5c5a1bf","type":"message","user":"UDDCM376D","text":"ありがとうございます","ts":"1578994291.163000","thread_ts":"1578994209.161200","parent_user_id":"UDDCM376D","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+k2fn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b19cc4a3-9b22-497a-b428-b8b811add105","type":"message","user":"UDDCM376D","text":"検討してみます","ts":"1578994296.163300","thread_ts":"1578994209.161200","parent_user_id":"UDDCM376D","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/7N"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c6be4e8e-391f-4aaf-9c4b-7ed6a26a9eca","type":"message","user":"U03C6TEAZ","text":"ql は SQL 構文がいくらか違います。","ts":"1578994298.163600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qU9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"932a7f52-9d8e-40d1-af6a-cad1890c7737","type":"message","user":"U06BRP8VD","text":"お、そうなんだw","ts":"1578994308.164100","edited":{"user":"U06BRP8VD","ts":"1578994318.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4VZMe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c32031bf-f0a4-4e86-a8fc-27f128e93459","type":"message","user":"U03C6TEAZ","text":"double quote だったりとかw","ts":"1578994309.164200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vonXS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aa406c96-7992-405a-94ea-ef75efaedebf","type":"message","user":"U06BRP8VD","text":"それはちょっときもいw","ts":"1578994322.164500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qD8F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"521bc4ca-8385-4094-9c6c-555883b448cd","type":"message","user":"U06BRP8VD","text":"postgresqlだと \"user\" と 'user' じゃ全然意味違うもんな。","ts":"1578994339.165100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HkjBq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8bd5a8a4-8324-48a0-b52a-fbfb08e15873","type":"message","user":"U03C6TEAZ","text":"cznic 先生はいろいろ面白いものを作ってくれる。","ts":"1578994354.165400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WKrV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"23206446-6b56-446b-b81c-d4637c7cfa64","type":"message","user":"U06BRP8VD","text":"ccがあったよねw","ts":"1578994362.165600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"p6xY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"09aea337-7552-40d8-bca8-4ddeb140f701","type":"message","user":"U03C6TEAZ","text":"<https://godoc.org/modernc.org/99c>","ts":"1578994402.165800","attachments":[{"fallback":"Command 99c","id":1,"title":"Command 99c","title_link":"https://godoc.org/modernc.org/99c","text":"Command 99c is a c99 compiler targeting a virtual machine.","blocks":null,"service_name":"godoc.org","service_icon":"https://godoc.org/favicon.ico","from_url":"https://godoc.org/modernc.org/99c","original_url":"https://godoc.org/modernc.org/99c"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"M6gt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"96ff3620-5535-43eb-8ebb-ccf2e0b1d261","type":"message","user":"U03C6TEAZ","text":"Go で C の IR 作って動かしちゃえ案件","ts":"1578994424.166300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"x=S"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"38daff71-004c-4282-8fe1-e1e96e7f99bd","type":"message","user":"U06BRP8VD","text":"ガチなアドバイスすると、goはメモリ的に組み込み要件からだと、かなり嫌われガチです。","ts":"1578994645.167200","edited":{"user":"U06BRP8VD","ts":"1578994657.000000"},"team":"T03C4RC8V","reactions":[{"name":"thinking_face","count":1,"users":["U03C6TEAZ"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lj6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"67893433-0c74-4c1f-b809-b4775ff3dc76","type":"message","user":"U06BRP8VD","text":"Linux乗ってるから余裕じゃ～んとか言ってると痛い目みることが結構ある。っていうか何度かみた。","ts":"1578994688.167800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rv0p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"279d8e63-0e8b-4ead-83f2-b68b6779fb90","type":"message","user":"U06BRP8VD","text":"goはx86系だとMMX必須で、でもMMX乗ってないPentiumで動かす必要が生じて、泣く泣くアセンブラでランタイムいじったりもしましたね。","ts":"1578994748.168900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZkL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4bca0b25-b98a-4500-94df-d0a369b5a27a","type":"message","user":"UDDCM376D","text":"メモリ、うぅ…（頭痛","ts":"1578994856.170100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vIw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0054074b-d0ae-45b7-a507-bbd625acc8b0","type":"message","user":"U06BRP8VD","text":"起動するだけでいきなりVSZから見て数十MB持ってくんですが、それだけで嫌味(?)言われたりね。","ts":"1578994858.170200","thread_ts":"1578994858.170200","reply_count":1,"replies":[{"user":"U06BRP8VD","ts":"1578994912.170300"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mubk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50f3a031-24ad-4207-ae3f-a6dadd76233b","type":"message","user":"U06BRP8VD","text":"嫌味っていうか、なんとかならないの、っていう問い合わせが何度も来る。","ts":"1578994912.170300","thread_ts":"1578994858.170200","edited":{"user":"U06BRP8VD","ts":"1578994920.000000"},"parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+k56"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"693633e7-e281-48e6-83ed-19281a14ba78","type":"message","user":"U03C6TEAZ","text":"ともあれ「何が起きたか」次第で対応や調べる所が全然違うのでまずは聞き込みですかね。","ts":"1578994949.171100","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0Vab+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e32a4b71-771c-44c4-8be6-ce30ce44f97f","type":"message","user":"UDDCM376D","text":"&gt; ともあれ「何が起きたか」次第で対応や調べる所が全然違うのでまずは聞き込みですかね\n想定している\n\n・電源断\n・OOM\n\nといった書き込み中にアプリまたはOSが落ちた場合ですね\n\nその対策として、何をどうすればいいのか\nを調査しています","ts":"1578995094.172600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"udKDl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5eafb4e2-2ceb-4ace-a82c-a90e767cd926","type":"message","user":"U03C6TEAZ","text":"「起きた」ではなくこれから「起きうる」の話でしょうか？","ts":"1578995172.173100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NSb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a3d2c65e-b383-4356-85e0-e9ab54b60d53","type":"message","user":"UDDCM376D","text":"です！","ts":"1578995208.173400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gdI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3450512d-bfa5-467a-8811-623288fba2e5","type":"message","user":"U03C6TEAZ","text":"であれば WAL、JOURNAL をキーワードに調べると良いですね。","ts":"1578995236.174000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dsV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d6501133-4feb-40dc-9e77-a42ddce36a78","type":"message","user":"UDDCM376D","text":"ありがとうございます\nそのあたりを今調べています","ts":"1578995418.175100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Won"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f8e9195a-2f3b-4616-8655-3dbd994a36bd","type":"message","user":"UDDCM376D","text":"ジャーナルは、ファイルシステムが対応していないとそもそも使えないんですよね？","ts":"1578995434.175800","thread_ts":"1578995434.175800","reply_count":2,"replies":[{"user":"U06BRP8VD","ts":"1578995591.177200"},{"user":"UDDCM376D","ts":"1578995615.177700"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lUe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"87ce288d-99fc-4ddf-98fe-ca39554bb0b0","type":"message","user":"U06BRP8VD","text":"OOMって僕のアレとほぼいっしょやなw Linuxの場合ですが…\n\n* OSによって殺されるときは SIGKILL なのでなにもできん\n* VSZ 制限に引っかかったときには panic 相当で goroutine の一覧が stderr に出せる","ts":"1578995454.176400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Rj5Y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cd6b8f53-529c-4f59-9022-c36f4ac10a58","type":"message","user":"U06BRP8VD","text":"そんなことはないですよ。","ts":"1578995591.177200","thread_ts":"1578995434.175800","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"po0PW"}],"root":{"client_msg_id":"f8e9195a-2f3b-4616-8655-3dbd994a36bd","type":"message","user":"UDDCM376D","text":"ジャーナルは、ファイルシステムが対応していないとそもそも使えないんですよね？","ts":"1578995434.175800","thread_ts":"1578995434.175800","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lUe"}]}},{"client_msg_id":"704c9972-bb98-47be-a78e-35243fe3359a","type":"message","user":"UDDCM376D","text":"なぬ！？","ts":"1578995615.177700","thread_ts":"1578995434.175800","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pZmL"}],"root":{"client_msg_id":"f8e9195a-2f3b-4616-8655-3dbd994a36bd","type":"message","user":"UDDCM376D","text":"ジャーナルは、ファイルシステムが対応していないとそもそも使えないんですよね？","ts":"1578995434.175800","thread_ts":"1578995434.175800","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lUe"}]}},{"client_msg_id":"4ddf7be7-c901-4c7a-a4ce-4e5cde62cf70","type":"message","user":"UDDCM376D","text":"ってことはその仕組みをSQLiteが自前実装している感じですか？","ts":"1578995632.178300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6XGvS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"846d2e63-e709-4248-8c17-52f2e3df75d5","type":"message","user":"U06BRP8VD","text":"ええ。複数自前実装していてモードで選択できるんです。そのうちの一つがWAL。","ts":"1578995660.178800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"f1="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aeb62a12-a3cb-4347-98b7-2a490462d260","type":"message","user":"UDDCM376D","text":"<http://nave-kazu.hatenablog.com/entry/2015/12/18/140634>","ts":"1578995663.179000","attachments":[{"fallback":"なべ’s blog: SQLiteのジャーナルモード - なべ’s blog","id":1,"title":"SQLiteのジャーナルモード - なべ’s blog","title_link":"http://nave-kazu.hatenablog.com/entry/2015/12/18/140634","text":"2つのSQLiteのデータベースファイルがあり、それぞれ更新すると一方は「-journal」ファイルが作成されて、もう一方は「-shm」と「-wal」ファイルが作成されるという違うファイルが作成される理由がわからず調べたら、ジャーナルモードが違ったというお話。 ジャーナルモードの大分 SQLiteのジャーナルモードは大きく分けて「delete」と「wal」がある。 「delete」の時は「-journal」ファイルが作成され、「wal」の時は「-shm」と「-wal」ファイルが作成される。 例えば「foo」というデータベースファイルがあると、ジャーナルモードが「delete」の時は「foo」と…","image_url":"https://ogimage.blog.st-hatena.com/8454420450073000284/6653586347148998298/1474336144","blocks":null,"ts":1450415194,"service_name":"なべ’s blog","service_icon":"https://cdn.blog.st-hatena.com/images/touch-icon-iphone-retina.png","from_url":"http://nave-kazu.hatenablog.com/entry/2015/12/18/140634","original_url":"http://nave-kazu.hatenablog.com/entry/2015/12/18/140634"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mVs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a7a6ec31-7b7b-4ced-bef9-7dceb1d1ba03","type":"message","user":"UDDCM376D","text":"どうや自前実装しているようですね","ts":"1578995676.179600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0Y8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8e89e167-d9aa-4bc8-84f2-a7871eae1c31","type":"message","user":"UDDCM376D","text":"&gt; ええ。複数自前実装していてモードで選択できるんです。そのうちの一つがWAL。\nありがとうございます\nめっちゃ安心しましたｗ","ts":"1578995691.180000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VwtqH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a8b47cb1-3bfa-4fe0-9e94-a9c214f64e74","type":"message","user":"U06BRP8VD","text":"# もちろんファイルシステムにもジャーナル実装されてるものがありますけど、レベルが全然別。","ts":"1578995728.180700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2mYp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"daadf4a9-7a0b-4e61-a077-3814090ad585","type":"message","user":"U06BRP8VD","text":"さっきのflushとかfsyncの話は、そのSQLite3のジャーナルが壊れる可能性を考慮したものです。","ts":"1578995765.182000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ww6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"78eed532-ae09-4b50-a01b-491035e90ed4","type":"message","user":"UDDCM376D","text":"今ファイルシステムを確認中ですが、最悪ファイルシステムベースでサポートされていなくても、SQLiteでそれと同等のことができる\nってわかったんで一旦安心しました","ts":"1578995777.182300","edited":{"user":"UDDCM376D","ts":"1578995784.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"b+5DF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"86d8d4f5-6259-4a79-b578-4fd5855b3a06","type":"message","user":"UDDCM376D","text":"ちょっと一旦頂いた情報を整理します（頭がおっつかない…）","ts":"1578995846.183100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pSL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5ebbb640-79f5-4ab0-adae-3bb8dc4a0542","type":"message","user":"U03C6TEAZ","text":"組み込み機器だとディスクが SD な事が多いんですが、書き込み回数制限があるのでうまく考えないと早死にします。","ts":"1578996836.185000","edited":{"user":"U03C6TEAZ","ts":"1578996877.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qwk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"54ef95e1-02e8-44c3-a3c1-50a098d05650","type":"message","user":"UDDCM376D","text":"SDってなんですか？","ts":"1578996921.185700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"taS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9160cf24-f754-4691-8c11-acbf6a45d1c7","type":"message","user":"U03C6TEAZ","text":"micro SD なんかの SD です。","ts":"1578997138.186400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"07Grr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"41c959f9-ba9e-4159-ba3d-c8bcc2152475","type":"message","user":"UDDCM376D","text":"あーSDカードですね","ts":"1578997173.186900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Hr2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a33f3b5b-8810-45ea-9468-9852fc8ead43","type":"message","user":"U03C6TEAZ","text":"ラズベリーパイなんかがそうです。","ts":"1578997183.187300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qlxgw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3992c863-114a-4a81-9412-670670a0d045","type":"message","user":"UDDCM376D","text":"たしかに","ts":"1578997187.187500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sxFY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61039e2e-b23e-40e6-9072-d210615b4ca4","type":"message","user":"UDDCM376D","text":"書き込み回数はなるべく少なくしようとは考えていますが、優先度はそんなに高くなさそう（これも要確認だな）","ts":"1578997220.188200","edited":{"user":"UDDCM376D","ts":"1578997236.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AaWo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02684064-b35b-4642-afae-8a3469c0522c","type":"message","user":"U03C6TEAZ","text":"あとアーキテクチャ調べておかないと後で go 動かない事が判明すると割りと地獄。","ts":"1578997369.190000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Lroh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"83dc0175-c58c-448a-a243-2e2da8e8746a","type":"message","user":"UDDCM376D","text":"あー、そも必要ですね（これも要確認…）","ts":"1578997451.190300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+JM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"12f5e7bb-7016-437b-8dee-27733f86248f","type":"message","user":"U03C6TEAZ","text":"リッチなメモリが無いのであればターゲット上でビルドするのはほぼ不可で、特に go-sqlite3 みたく cgo だと別の環境でビルドする事になります。その際アーキテクチャが違うとクロスCコンパイラが必要になります。","ts":"1578997803.194500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=00je"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8eb635b5-1128-4d62-91a4-8ab291369886","type":"message","user":"UDDCM376D","text":"そういえば、CバインドのGoライブラリはいつもどおりGOOSとGOARCHを指定すればいいんですか？","ts":"1578998069.195800","edited":{"user":"UDDCM376D","ts":"1578998071.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CXIG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d306332a-5baa-4adb-806f-76fc79a3e551","type":"message","user":"U03C6TEAZ","text":"クロスCコンパイラが要ります。","ts":"1578998352.196400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k/iJU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6aba93c2-9b50-44b2-875b-310306ec84ea","type":"message","user":"U03C6TEAZ","text":"例えば amd64 上で arm ターゲットにするなら arm のバイナリを吐けるCコンパイラが必要。","ts":"1578998413.198200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pXC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"14bb8b9b-ff59-4cf9-86bb-f735cd28c3eb","type":"message","user":"UDDCM376D","text":"なるほど","ts":"1578998413.198300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fqg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7d4a8bd2-fe39-42e8-bb4b-1991e503f4db","type":"message","user":"UDDCM376D","text":"ありがとうございます\n調べてみます","ts":"1578998426.198600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D20"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e14251ef-e138-42b9-92dd-6b0c94111d39","type":"message","user":"U06ECBRTJ","text":"`cpp-5-arm-linux-gnueabi` みたいな名前で、各ディストリにあるはずですね","ts":"1578998589.199300","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":1,"users":["UDDCM376D"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nW8y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c0f669e-7e68-46bd-8322-648624c1785f","type":"message","user":"U03C6TEAZ","text":"これを間違ってるのに「go-sqlite3 ビルトできない」って issue がたつことが多い。","ts":"1578998695.200800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cd/4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"27bb1a99-10c0-4a3f-9717-71255b3b9de4","type":"message","user":"U06BRP8VD","text":"そういや富士通かどこかの携帯が高頻度でflashram書き換えてあっという間に文鎮化したことがありましたねw","ts":"1579000607.202600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QdtFS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7bba4ad7-643a-46e5-a9c2-e0f6fa3faf23","type":"message","user":"U7H4TJEG0","text":"SDといえばSoftware Design","ts":"1579001701.202900","team":"T03C4RC8V","reactions":[{"name":"gorilla","count":2,"users":["UDDCM376D","U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Zpx43"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"649c8c2c-867e-438c-8cd7-901613695dc7","type":"message","user":"U6XP9LZ6V","text":"↑Sore Da","ts":"1579003688.205700","team":"T03C4RC8V","reactions":[{"name":"sorena","count":3,"users":["U03C6TEAZ","U06BRP8VD","U8CC7MDCL"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Botns"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"de2a45d9-b427-40a9-98c0-32243bc06368","type":"message","user":"US90LD360","text":"誰かgoでhot reloadしてる人います？realizeがgo modules環境で動かなかったけどissueで紹介されてた<https://github.com/oxequa/realize/issues/217#issuecomment-450473673> modd 使ってみてます。今の所よさそう。","ts":"1579012614.208800","attachments":[{"fallback":"GitHub: Cannot do `--run` with go1.11 using go mod under windows. · Issue #217 · oxequa/realize","id":1,"title":"Cannot do `--run` with go1.11 using go mod under windows. · Issue #217 · oxequa/realize","title_link":"https://github.com/oxequa/realize/issues/217#issuecomment-450473673","text":"------------ directory: -- main.go -- go.mod main.go: package main import &amp;quot;fmt&amp;quot; func main() { fmt.Println(&amp;quot;hello&amp;quot;) } start realize: realize start --run --nc error shows: [10:54:...","thumb_url":"https://avatars0.githubusercontent.com/u/20284426?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/oxequa/realize/issues/217#issuecomment-450473673","original_url":"https://github.com/oxequa/realize/issues/217#issuecomment-450473673"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Krg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"134678fd-0238-4468-b382-aecdcc801875","type":"message","user":"UAZ33BKV2","text":"SDカードがSecureDigitalの略称(が元?)なの、どれだけ記憶にあるだろうか?","ts":"1579012979.209500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FrlXj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6a5a5e15-6268-4c5f-adfc-f03ccd5826cf","type":"message","user":"UAZ33BKV2","text":"しかし、うー、reviewdogの最新のgo getが失敗する...","ts":"1579013012.210000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EjZQP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"860775d2-e22c-45b9-a7c7-817d4aa06c04","type":"message","user":"UG6DF6W87","text":"go mod で realize つかってますね\nなんか知らないけどその issue にハマってない...","ts":"1579013459.216300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"u9d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a5eb5ce1-b81e-464b-9f5a-2b94a308cd73","type":"message","user":"US90LD360","text":"なんと。このissue windowsみたいですがmacでも動かないんですよね...","ts":"1579013667.218500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3sM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51068033-1cfd-418f-b664-0868dfb35f30","type":"message","user":"UG6DF6W87","text":"realize.yaml 使い回してるので、誰かがその issue に書いてあるワークアラウンドやってくれたんだと思いますが...","ts":"1579013776.220700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jMIEd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c34c5d6e-3d4c-47e2-9923-050b62a40289","type":"message","user":"UG6DF6W87","text":"<https://github.com/goccy/rebirth|https://github.com/goccy/rebirth> mac だとこれが面白そうだなと思ってます\n// 思ってるだけでまだ使ってない","ts":"1579013829.222200","attachments":[{"fallback":"GitHub: goccy/rebirth","id":1,"title":"goccy/rebirth","title_link":"https://github.com/goccy/rebirth","text":"Supports live reloading for Go. Contribute to goccy/rebirth development by creating an account on GitHub.","thumb_url":"https://avatars2.githubusercontent.com/u/209884?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/goccy/rebirth","original_url":"https://github.com/goccy/rebirth"}],"team":"T03C4RC8V","reactions":[{"name":"eyes","count":1,"users":["US90LD360"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MIW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4A980A65-8DC0-44E6-B2D9-2B7034953987","type":"message","user":"UDDCM376D","text":"<https://twitter.com/mattn_jp/status/1216886166382792704?s=21|https://twitter.com/mattn_jp/status/1216886166382792704?s=21>","ts":"1578963695.070400","attachments":[{"fallback":"<https://twitter.com/mattn_jp|@mattn_jp>: defer のフットプリント推移。1.14 ではとてつもない改善が行われる。すごい。 #golang <https://twitter.com/janiszt/status/1215601972281253888>","id":1,"author_name":"mattn","author_subname":"@mattn_jp","author_link":"https://twitter.com/mattn_jp/status/1216886166382792704","author_icon":"https://pbs.twimg.com/profile_images/1022150732634419200/yZg4xLsO_normal.jpg","text":"defer のフットプリント推移。1.14 ではとてつもない改善が行われる。すごい。 #golang <https://twitter.com/janiszt/status/1215601972281253888>","blocks":null,"footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png","ts":1578963245,"service_name":"twitter","from_url":"https://twitter.com/mattn_jp/status/1216886166382792704?s=21","original_url":"https://twitter.com/mattn_jp/status/1216886166382792704?s=21"},{"color":"32BBF3","fallback":"<https://twitter.com/janiszt|@janiszt>: #golang 1.14 will bring massive improvement in defer performance footprint <https://pbs.twimg.com/media/EN6vjLgXsAI7-RJ.jpg>","id":2,"author_name":"janisz","author_subname":"@janiszt","author_link":"https://twitter.com/janiszt/status/1215601972281253888","author_icon":"https://pbs.twimg.com/profile_images/435103048273125376/JqaqiTI6_normal.png","text":"#golang 1.14 will bring massive improvement in defer performance footprint <https://pbs.twimg.com/media/EN6vjLgXsAI7-RJ.jpg>","image_url":"https://pbs.twimg.com/media/EN6vjLgXsAI7-RJ.jpg","blocks":null,"footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png","ts":1578657069,"service_name":"twitter","from_url":"https://twitter.com/janiszt/status/1215601972281253888"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rMc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7586CD7F-FCCF-47C8-9AE5-EA2667CB8DC0","type":"message","user":"UDDCM376D","text":"やばい","ts":"1578963696.070600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"T1R5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"73ac6e4d-b99d-493e-84ea-07d602772868","type":"message","user":"UAZ33BKV2","text":"うえぇ?すごい","ts":"1578964343.070900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eC9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"45829901-79b4-4efa-b72c-03f9cf911615","type":"message","user":"UK7DT8URY","text":"defer無しとほぼ変わらないのか……すげぇ","ts":"1578965059.071400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6W/UM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"18aab693-c488-4e94-890f-497a4abf5948","type":"message","user":"U03C6TEAZ","text":"実際 defer の様で defer でない (ﾃﾞﾝﾃﾞﾝ)","ts":"1578965948.071800","edited":{"user":"U03C6TEAZ","ts":"1578965953.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=QGDz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bd8a525a-30f7-408a-b5e1-9c25ae470287","type":"message","user":"U8CC7MDCL","text":"deferでふぁない?","ts":"1578966068.074300","team":"T03C4RC8V","reactions":[{"name":"fuita","count":2,"users":["UK7DT8URY","U06BRP8VD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"U5Le"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2e288e89-97f3-45fa-9ed4-735dfb46a816","type":"message","user":"U03C6TEAZ","text":"```func foo() error {\n  f, err := os.Open(\"foo\")\n  if err != nil {\n    return err\n  }\n  defer f.Close()\n  err = doSomething(f)\n  if err != nil {\n    return err\n  }\n  ...\n  return nil\n}```\nこうなってるのをインライン化して\n```func foo() error {\n  f, err := os.Open(\"foo\")\n  if err != nil {\n    return err\n  }\n  err = doSomething(f)\n  if err != nil {\n    f.Close()\n    return err\n  }\n  f.Close()\n  ...\n  return nil\n}```\nと自動する様になってる。","ts":"1578966076.074500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xm2Et"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a1042f44-92b8-41c0-836f-6c7b129f0f62","type":"message","user":"UAZ33BKV2","text":"コンパイルの最適化で対応できるようになった的な?","ts":"1578966125.075100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pfG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2273091e-7ddc-4321-a52e-60894efbd6af","type":"message","user":"U03C6TEAZ","text":"ですね。","ts":"1578966138.075300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fQUTe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"153ce788-2596-462d-8499-50311404b750","type":"message","user":"UDDCM376D","text":"インライン化でこんなに変わるなんて…","ts":"1578966162.075600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"junT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4b1db5f2-143a-4822-a174-54b06b9ee467","type":"message","user":"U03C71D7H","text":"バイナリサイズは増える感じかな","ts":"1578966275.075800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jvD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0380cc5c-530f-4c1f-8ad4-95afc27ddf82","type":"message","user":"U03C6TEAZ","text":"ですね。","ts":"1578966698.077100","team":"T03C4RC8V","reactions":[{"name":"tiken","count":2,"users":["UK7DT8URY","U8CC7MDCL"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"jY3A"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"94a81a59-2d6c-408d-b607-95c6186e2bbb","type":"message","user":"UK7DT8URY","text":"ところで今まではどうやってたんだろう……","ts":"1578966804.077900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WilMh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7b38bac9-fe7d-48cf-92f0-eee95f49038a","type":"message","user":"U7H4TJEG0","text":"スタックに積んで最後に順番に呼ぶみたいな感じじゃなかったかな","ts":"1578966828.078400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"m38"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9470c33-43e7-49b4-987a-14cc53fd7cfd","type":"message","user":"U03C6TEAZ","text":"ですね。スタックにステートメントとキャプチャしてる引数を積んでた感じです。","ts":"1578966906.079300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pq5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0b221dae-a1ca-4bfb-9565-cd4e6b95edc8","type":"message","user":"UK7DT8URY","text":"なるほどスタックしてたのか。","ts":"1578966948.080400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6qZhn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a0f64f4a-da5a-44a6-bef5-c243f4716555","type":"message","user":"U03C6TEAZ","text":"```name := \"file1\"\nf, _ := os.Open(name)\ndefer f.Close()\nname = \"file2\"\nf, _ = os.Open(name)\ndefer f.Close()```\nGo だとこれでもキチンと動くので。","ts":"1578966977.080900","edited":{"user":"U03C6TEAZ","ts":"1578966987.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"BLP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"81f38652-add1-4c95-8e20-023900eb1421","type":"message","user":"UK7DT8URY","text":"やばそうなコードだ()","ts":"1578966994.081900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qTC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"67f9e051-193a-4448-9af9-c1a403c8946c","type":"message","user":"UAZ33BKV2","text":"算出して積むまでの処理が重かったのかな...","ts":"1578967001.082300","edited":{"user":"UAZ33BKV2","ts":"1578967039.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FED"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cfd22bb7-8a4f-4ef3-be99-18a840ac96ec","type":"message","user":"U03C6TEAZ","text":"実はやばくない。","ts":"1578967005.082400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Nq9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3e793398-57f6-4254-89ae-55a8296653f1","type":"message","user":"U03C71D7H","text":"バイナリサイズ、1つ1つは些細だし気にする必要はなさそうだけどライブラリたくさん使ってるプロダクトで塵積でどれくらい増えるのかちょっと興味ある","ts":"1578967027.083200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MTUZa"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"888f88b1-9f3f-4e98-90a2-88cff3b072b1","type":"message","user":"U03C6TEAZ","text":"これが、Go の defer と他の言語のナンチャッテ defer の違い。","ts":"1578967032.083300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VttjQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5cb14a84-5ab0-4607-8142-03ab1262afcf","type":"message","user":"U03C71D7H","text":"defer が使える他の言語を知らない…","ts":"1578967070.084400","thread_ts":"1578967070.084400","reply_count":2,"replies":[{"user":"UERCTTT8B","ts":"1578967847.095800"},{"user":"U03C71D7H","ts":"1578967913.096100"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/kVqN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"88eedfc1-896b-44fd-bed9-b8ab2ad6254d","type":"message","user":"UK7DT8URY","text":"あれ、じゃあコレどう解析するんだろうと思ったがこうか。\n```diff\n  name := \"file1\"\n  f, _ := os.Open(name)\n  doSomething(f)\n+ f.Close()\n- defer f.Close()\n  name = \"file2\"\n  f, _ = os.Open(name)\n  doSomething(f)\n+ f.Close()\n- defer f.Close()```","ts":"1578967079.084600","edited":{"user":"UK7DT8URY","ts":"1578967129.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G2CW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2058f834-2aad-45fe-8b83-29903defd41c","type":"message","user":"U03C71D7H","text":"そもそも f ってのはコード上の名前なので、内部的には別の変数にしちゃえば良いだけ","ts":"1578967134.085500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7Hel"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7cfbbd18-ef65-4069-b5d6-a181684185e5","type":"message","user":"U03C6TEAZ","text":"その時点の引数とかレシーバとかキャプチャしてるんですよね。","ts":"1578967141.085900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XPHb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3dc393d9-0d14-4f11-9755-6800aaa6e013","type":"message","user":"UK7DT8URY","text":"&gt; 内部的には別の変数にしちゃえば良いだけ\nあー、そうきたか。確かに","ts":"1578967158.086300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"15R9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a7c7a041-0b10-4f16-bca2-4925b5f1c3df","type":"message","user":"U03C71D7H","text":"```name := \"file1\"\nf, _ := os.Open(name)\nname = \"file2\"\nf2, _ = os.Open(name)\nf2.Close()\nf.Close()```\nたぶんこうかな","ts":"1578967215.086900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PtpaY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8fb3a1d4-6917-4c10-8b9f-0e5d53b82439","type":"message","user":"U7H4TJEG0","text":"```i := 10\ndefer fmt.Println(i)\ni = 20```","ts":"1578967309.087200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7GT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2d991abc-25eb-4200-856e-cf08efbc7155","type":"message","user":"UK7DT8URY","text":"定数にしちゃえば良いからこうか\n```i := 10\ni = 20\nfmt.Println(10)```\nでもコレって変数の時どうするんだろ。","ts":"1578967360.088100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Tz9Bj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"992083c3-7409-402f-94d4-e09d47575c2c","type":"message","user":"UAZ33BKV2","text":"その時点の状態をキャプっておくので、特に問題はないような?","ts":"1578967404.088700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=4FI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"17c35241-a6e8-4578-8e69-69118d72e94e","type":"message","user":"U7H4TJEG0","text":"評価してるだけ","ts":"1578967407.088800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"L/D"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"727488a6-76d3-4499-908a-15db61320603","type":"message","user":"U03C71D7H","text":"```i := 10\ncapture_i := i\ni = 20\nfmt.Println(capture_i)```","ts":"1578967469.090000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9qnHR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e5cb17e4-a85d-4e65-a124-01813da574b7","type":"message","user":"U7H4TJEG0","text":"```func main() {\n\tprintln(\"before\")\n\tdefer fmt.Println(g())\n\tprintln(\"after\")\n}\n\nfunc g() int {\n\tprintln(\"g\")\n\treturn 10\n}```\n```before\ng\nafter\n10```","ts":"1578967476.090300","team":"T03C4RC8V","reactions":[{"name":"parrot","count":2,"users":["UK7DT8URY","U776661HA"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9VC0+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0348c1d3-51d1-44d2-a3e3-3d68cfc2daa0","type":"message","user":"UK7DT8URY","text":"ああこうか\n```i := 10\nwk =: i\ni = 20\nfmt.Println(wk)```","ts":"1578967488.090600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"o2ULJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8038fecc-8343-4c02-b3dc-d61dacea0648","type":"message","user":"U03C71D7H","text":"defer むずかしいな","ts":"1578967550.090800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ow0UR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f2e84824-41ee-4dbe-b923-2ebb879a07fa","type":"message","user":"UK7DT8URY","text":"なるほど？printlnの引数を評価しようとして関数が動くからその時点でg()の中のprintlnが実行されると。","ts":"1578967580.091800","edited":{"user":"UK7DT8URY","ts":"1578967681.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xrgn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0fe56ba6-4be0-433f-977e-e554a834e22c","type":"message","user":"UAZ33BKV2","text":"deferと書くが、先に評価して結果取得しなきゃいけないものは実行される、と。\ndefer(遅延評価と思う人もいるかも?)と真逆に感じる挙動をするところもあると","ts":"1578967704.093600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ms4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d7fffe94-6077-442d-af67-103259b5920f","type":"message","user":"U03C6TEAZ","text":"なのでよく\n```defer func() {\n  err = f.Close()\n}()```\nみたいに書く人がいるんですが、実は結構危ないんですよね。","ts":"1578967766.094300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Dh0B"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"021187c7-c6d2-4fc1-8782-9cd87db484b7","type":"message","user":"U03C6TEAZ","text":"危ないというのは後の修正で簡単に壊せてしまう。","ts":"1578967785.095100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sot"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b4bc1658-35ca-4c5e-9f6d-7efc8be2906c","type":"message","user":"U7H4TJEG0","text":"```for i := 0; i &lt; 10; i++ {\n\tdefer println(i)\n}```\nこういうコードが書けるのもそういう感じ","ts":"1578967791.095400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q=p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4e2fa6ac-f7af-4675-a185-77115e45cf04","type":"message","user":"UERCTTT8B","text":"panic でも呼ばれることを考慮すると単なる最適化ではすまないような気がするけど","ts":"1578967795.095500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1P+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d2d6847f-6b88-4023-aeb1-8d3a78416937","type":"message","user":"UERCTTT8B","text":"どうやっているんだろう","ts":"1578967805.095700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ins"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d415a83-00aa-4ffd-8ce8-10370f686522","type":"message","user":"UERCTTT8B","text":"D があります (scope)","ts":"1578967847.095800","thread_ts":"1578967070.084400","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Grs"}],"root":{"client_msg_id":"5cb14a84-5ab0-4607-8142-03ab1262afcf","type":"message","user":"U03C71D7H","text":"defer が使える他の言語を知らない…","ts":"1578967070.084400","thread_ts":"1578967070.084400","reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/kVqN"}]}},{"client_msg_id":"08b95097-aa20-42a3-acf6-430c4d48a9aa","type":"message","user":"U03C71D7H","text":"お、D はずっと興味がありつつ未開の地でした。なるほど","ts":"1578967913.096100","thread_ts":"1578967070.084400","parent_user_id":"U03C71D7H","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8Nd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"388ea4f3-7ade-4f62-ba6a-b483f5110110","type":"message","user":"U03C6TEAZ","text":"for のブロックで呼ばれる defer ほしい","ts":"1578968590.096800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"anXs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68afcd3d-44e7-457c-924d-c5a5ecd6f84f","type":"message","user":"U7H4TJEG0","text":"deferもgoもループ内で書きたくなったら関数に分ける","ts":"1578968933.097500","team":"T03C4RC8V","reactions":[{"name":"sorena","count":3,"users":["U03C6TEAZ","U06BRP8VD","UA4RVLHK7"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oHZU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9e6f05b8-6ac9-404c-8580-701da3e1f748","type":"message","user":"U03C6TEAZ","text":"雑に1分でコード書きたいみたいなシーンで葛藤が起きる。","ts":"1578969276.098200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CPB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9c8c5436-2467-4af8-b653-99d750277df5","type":"message","user":"U03C6TEAZ","text":"for の中身を引数とかイイカンジに関数に抜き出すみたいなツールがあった気がするけど忘れた。","ts":"1578969397.098800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hIT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"USA4VV8H5","text":"<@USA4VV8H5> has joined the channel","ts":"1578969914.099000","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"deb5ee24-4729-4601-b5ba-771f6c9109a3","type":"message","user":"U03C6TEAZ","text":"余談だけど、最近の Go だと *os.File は nil チェックが入ってるので\n```f, err := os.Open(\"aaa\")\nf.Close()\nif err != nil {\n}```\nでも落ちはしない。","ts":"1578972218.100500","team":"T03C4RC8V","reactions":[{"name":"naruhodo","count":2,"users":["UEACRCY0Z","UDDCM376D"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Z/="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9aab83eb-bbaa-429d-be17-fecf7cbc67f9","type":"message","user":"U03C6TEAZ","text":"ただし行儀は良くない。","ts":"1578972234.100800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lhgRh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9337b5cc-dc34-4c32-8013-dd79250805f4","type":"message","user":"U03C6TEAZ","text":"<https://twitter.com/kawaz/status/1216950834342137858>","ts":"1578978813.101300","attachments":[{"fallback":"<https://twitter.com/kawaz|@kawaz>: パッと見置き換えて問題なさそうだったけど以下の2点で既存スクリプトがコケたので jq -&gt; gojq はヤリ過ぎだったようだ…。\n\n・引数に json ファイル渡せない（パイプ or --from-file=)\n・--arg や --argjson 系のオプションが無い（代替手段なし？）","id":1,"author_name":"Yoshiaki Kawazu🐸ずん","author_subname":"@kawaz","author_link":"https://twitter.com/kawaz/status/1216950834342137858","author_icon":"https://pbs.twimg.com/profile_images/829319660030025729/Iv7nIGF6_normal.jpg","text":"パッと見置き換えて問題なさそうだったけど以下の2点で既存スクリプトがコケたので jq -&gt; gojq はヤリ過ぎだったようだ…。\n\n・引数に json ファイル渡せない（パイプ or --from-file=)\n・--arg や --argjson 系のオプションが無い（代替手段なし？）","blocks":null,"footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png","ts":1578978663,"service_name":"twitter","from_url":"https://twitter.com/kawaz/status/1216950834342137858","original_url":"https://twitter.com/kawaz/status/1216950834342137858"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iBQm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ce7918db-7ef0-4b58-b932-1180daa222e3","type":"message","user":"U06ECBRTJ","text":"手習いで、壁紙にカレンダーを入れるGUIアプリを作りたい…\nできればクロスプラットフォーム対応で…","ts":"1578980888.102200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"J+w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2a41d905-db3c-444e-8506-4e0e8bf012fa","type":"message","user":"U06ECBRTJ","text":"go で 文字を画像に入れ込むのって、なんかいいライブラリありますかね？\nやっぱり imagemagick かな…？","ts":"1578981172.103000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=U/nO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"80c18aed-a7be-4b49-85d4-31de9092eb52","type":"message","user":"U03C6TEAZ","text":"<https://github.com/golang/freetype>","ts":"1578981222.103200","attachments":[{"fallback":"GitHub: golang/freetype","id":1,"title":"golang/freetype","title_link":"https://github.com/golang/freetype","text":"The Freetype font rasterizer in the Go programming language. - golang/freetype","thumb_url":"https://avatars3.githubusercontent.com/u/4314092?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/golang/freetype","original_url":"https://github.com/golang/freetype"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3Nmw8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7066d801-67ba-4d28-83e5-56b20f178ac7","type":"message","user":"U06ECBRTJ","text":"なるほど、font.Drawer を使って、DrawString する感じですね","ts":"1578981285.103800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F2W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6e3ddfc5-5450-4f37-80cf-faeb4bf36ce9","type":"message","user":"U06BRP8VD","text":"なるほど。goはOSのヒープを8K単位のspanにわけて使うのね。その用途にはgoroutineのstackも含まれる。だからstackの最小サイズが8Kなのか。","ts":"1578983532.105700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9AC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9cf52a3b-bf0e-4e4b-b920-cc2034b3c23c","type":"message","user":"U06BRP8VD","text":"あれ? よく4KBって書かれてない?","ts":"1578983911.106100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2y2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50b568a9-162d-4738-8c88-a7f6d5832893","type":"message","user":"UDDCM376D","text":"<https://golang.org/doc/go1.4#runtime>\nからは 8kb -&gt; 2kb になったようです","ts":"1578984568.107000","attachments":[{"fallback":"Go 1.4 Release Notes - The Go Programming Language","id":1,"title":"Go 1.4 Release Notes - The Go Programming Language","title_link":"https://golang.org/doc/go1.4#runtime","text":"Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.","blocks":null,"service_name":"golang.org","service_icon":"https://golang.org/favicon.ico","from_url":"https://golang.org/doc/go1.4#runtime","original_url":"https://golang.org/doc/go1.4#runtime"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dXQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9760b8c6-4492-4b62-a02d-71d2cbbff23f","type":"message","user":"UDDCM376D","text":"<https://golang.org/src/runtime/stack.go> #71行目","ts":"1578984721.107500","attachments":[{"fallback":"src/runtime/stack.go - The Go Programming Language","id":1,"title":"src/runtime/stack.go - The Go Programming Language","title_link":"https://golang.org/src/runtime/stack.go","text":"Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.","blocks":null,"service_name":"golang.org","service_icon":"https://golang.org/favicon.ico","from_url":"https://golang.org/src/runtime/stack.go","original_url":"https://golang.org/src/runtime/stack.go"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KpKV8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dd4c2470-48b7-415c-9625-847cb9278ed8","type":"message","user":"U06BRP8VD","text":"んーそれは表面的な話っぽい。実際に確保される際には少なくとも4KBのページにはなってるね。","ts":"1578985555.108200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0AdUX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"29ba49c5-daeb-4e77-8b73-4ec30e3d5f58","type":"message","user":"UDDCM376D","text":"え","ts":"1578985720.109000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0T3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d66fa43a-4f04-4113-89a4-d49f446cbe7d","type":"message","user":"UDDCM376D","text":"マジすか","ts":"1578985723.109200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N75p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1b530821-fec0-4bae-8d6a-621cb5e6cc15","type":"message","user":"UDDCM376D","text":"論理上は2kbってことですか？","ts":"1578985749.109600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zC7n"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3bf2b80a-5107-4d2f-ad59-ce101884af40","type":"message","user":"U06BRP8VD","text":"ええ。だいたいそんなかんじ。","ts":"1578985782.110000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mIg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d54cc15-2524-4c4b-88d5-43e9ce0a921a","type":"message","user":"U06BRP8VD","text":"ややこしい説明になりますが、goのstackは最終的にOSからメモリが確保されるんです。でOS的には4096バイト毎のページ単位でしか確保できない。","ts":"1578985847.111400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GCqf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"afc29df8-612d-4a53-9180-ce4da763af66","type":"message","user":"U06BRP8VD","text":"あとは `runtime.MemStats` の説明がどう関わってくるのかが気になるな。","ts":"1578985872.112000","edited":{"user":"U06BRP8VD","ts":"1578985916.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jx4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a5255587-a75e-45e7-a1e5-ee4d1eaed6a4","type":"message","user":"U06BRP8VD","text":"<https://golang.org/src/runtime/mstats.go?#L185>","ts":"1578986063.112300","files":[{"id":"FS8C87LBC","created":1578986063,"timestamp":1578986063,"name":"Untitled","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":844,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FS8C87LBC/untitled","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FS8C87LBC/download/untitled","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FS8C87LBC/untitled","permalink_public":"https://slack-files.com/T03C4RC8V-FS8C87LBC-f205f86f48","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FS8C87LBC/untitled/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6Yk5S"}]},{"client_msg_id":"91a47216-efea-4203-a845-4f2f3e93291b","type":"message","user":"U06BRP8VD","text":"雑に要約するとこうなる。\n\n* golangはヒープを8k以上のサイズのスパンに分けて使うよ\n* スパンには3種類あるよ\n* そのうちの一つは goroutine の stack だよ","ts":"1578986130.113400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Kwfe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"14279b1f-9c68-4be4-9510-52d720b550a6","type":"message","user":"U06BRP8VD","text":"あー小さいstackは別の場所から持ってくるんか。","ts":"1578986253.113800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yoDb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"deb0f5ed-5cd0-488e-9bf1-7258fde4ff34","type":"message","user":"U06BRP8VD","text":"ん。最低4KBになるのはefenceとか使ってるときだった。","ts":"1578986682.114200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hb+d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"91a44a67-d1d2-452e-9b1f-93d35a7e4cf1","type":"message","user":"U06BRP8VD","text":"stacklog2、効率悪いけど、32KBを超えるスタックってそうそうないから使われてない感じかねえ","ts":"1578986823.114800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1EKd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"12ec5ea7-9433-48ef-ae21-f537a278c092","type":"message","user":"U06BRP8VD","text":"あるぇ? windows/64 だとやっぱ8KBなのかな","ts":"1578986964.115200","thread_ts":"1578986964.115200","reply_count":1,"replies":[{"user":"U06BRP8VD","ts":"1578988015.116500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pB+w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ddf6a9f0-6236-40c4-820f-a1cd975473b1","type":"message","user":"U06BRP8VD","text":"まぁいまはLinux系みてるから良いや。","ts":"1578986975.115600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D0ED"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"84246293-b173-4c35-95a9-ef147568cb59","type":"message","user":"U06BRP8VD","text":"このテクニックは卑怯だw `_StackSystem = 0x80000000000` になると破綻するけど、まぁ動くよねw","ts":"1578987859.115800","files":[{"id":"FS8CXQX8S","created":1578987858,"timestamp":1578987858,"name":"Untitled","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":462,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FS8CXQX8S/untitled","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FS8CXQX8S/download/untitled","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FS8CXQX8S/untitled","permalink_public":"https://slack-files.com/T03C4RC8V-FS8CXQX8S-b943cb0452","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FS8CXQX8S/untitled/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"C4I1"}]},{"client_msg_id":"6612d980-ccd9-416a-8eea-6c5b3fb58202","type":"message","user":"U06BRP8VD","text":"これWindowsが512*ポインタサイズのシステム領域をstackに確保するために、64ビットだと4096B必要で、さらにstackはpower of 2 のサイズじゃなきゃいけないので 6144 が8KBにまでなってるとのこと。\n\n32ビットだと2048で、Goのと合わせて4KB。","ts":"1578988015.116500","thread_ts":"1578986964.115200","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xjt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
