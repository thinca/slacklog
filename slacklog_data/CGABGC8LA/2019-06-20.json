[{"client_msg_id":"a0f00543-9060-48de-9d20-d107a855cb4e","type":"message","user":"UGXMRNBUM","text":"gRPCは良いですねー。\nエコシステムがRESTに比べるとまだ弱いけど、最近は困らない感じになってきたし。","ts":"1561014077.096400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c51bf44-9010-4fee-8f55-1b01520570cf","type":"message","user":"U06BRP8VD","text":"gRPC、ロードバランシングで、何か進歩はあるのかしら。最近、そっち方面は調べてない。","ts":"1561014522.097800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61d7a156-6565-4ae7-a509-c1c04a0cb9b0","type":"message","user":"U06BRP8VD","text":"grpc-lbみたいな規格が提案されたことにちょっと調べて、そんときはDNSのマルチIP返すLBでひとまず手を売ったんですが。","ts":"1561014564.098700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c85fd533-0988-4057-a421-d27e0777fe28","type":"message","user":"UGXMRNBUM","text":"確かにそのへん最近みてないな…","ts":"1561015736.099500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"029c384f-1490-43c9-b7f2-531cf9c58220","type":"message","user":"U06BRP8VD","text":"lib/pq が time.Time を timestamp without zone にencodeするときに timezone を無視して保存する。で decode するときには timezone を考慮しない=UTC相当で読み込む。この動作によりencode時にJSTだった時刻は、decode時に+9:00として解釈されてる。\n(00:00 JST が 00:00 UTC になるから 09:00 JST 相当)\n\nある意味で正しいとは思うんだけど、なんか釈然としないや。クライアント側のシステムのタイムゾーンつけてくれればしっくり来るんだけど。","ts":"1561017684.103400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9816c83b-710b-4e67-b24f-bb04e3d80ce2","type":"message","user":"U06BRP8VD","text":"lib/pq に引き渡す timestamp without zone の time.Time はUTCにtimezoneを変換して渡す。使うときは必要な timezone に変換するってのがベストプラクティスかねぇ。","ts":"1561017846.104600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fd3484fc-d707-4ae3-8d4c-1ecc0e5b13a0","type":"message","user":"U06BRP8VD","text":"timestamp w/ zone を使うって選択肢は、なんか違うって気がする。","ts":"1561017854.104800","edited":{"user":"U06BRP8VD","ts":"1561017871.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f271652e-679b-442c-9691-ee49f92d2861","type":"message","user":"U06BRP8VD","text":"(別の罠を踏みそう的な)","ts":"1561017888.105200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"28384b17-ef5f-4662-86b9-4a208824ad11","type":"message","user":"U03C6TEAZ","text":"僕は without で使ってます。","ts":"1561017925.105500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a0e67b8a-6d2e-491b-a580-41fc0bd69f9d","type":"message","user":"U06BRP8VD","text":"time.Time のほうの timezone どうしてます? 取り出すときに timezone が落ちちゃう問題。","ts":"1561018111.105900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"13360ddf-8908-4acd-8f41-16c9355d9bf2","type":"message","user":"U06BRP8VD","text":"# lib/pq じゃないの使ってる可能性もあるか","ts":"1561018128.106300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"176176bc-6ec0-4cda-8277-1105794af804","type":"message","user":"U06BRP8VD","text":"lib/pq のコード読んでると、w/ zone で使った場合、それはそれで混乱した値が出てきそうな予感がある。","ts":"1561018261.107000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3abc4687-2c9d-4313-bc19-523e47fcd723","type":"message","user":"U06BRP8VD","text":"encodeは常に tz 付き。w/ zone の場合、decodeは データに含まれた tz を考慮したあとに、postgresが動いてるサーバの tz に変換してそう…","ts":"1561018446.109000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b5d461af-e3a8-49f5-979b-e58195d76df0","type":"message","user":"U06BRP8VD","text":"まじかー","ts":"1561018468.109200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"692b9505-e2cb-4bd5-8366-2076ef24e1c0","type":"message","user":"U06BRP8VD","text":"JSTでデータ入っててもpostgresがUTCで動いてたら、UTCに補正されて出てくる。まぁ、時刻がズレない点は評価できるけれど…なんだこれw","ts":"1561018521.110100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bc90fe19-e518-4a50-ad90-b0dbd43875d8","type":"message","user":"U03C6TEAZ","text":"time.Time の方は local のままです。","ts":"1561019318.110500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ccd680c3-d4f1-4003-9820-ae7f709cda4b","type":"message","user":"U03C6TEAZ","text":"もともとカラムも without なので","ts":"1561019351.110900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2e4b6ec4-eb64-4037-b214-4874f30ee685","type":"message","user":"U06BRP8VD","text":"そーすると lib/pq が取り出すとき、timezoneをつけない=JSTで保存された文字列をUTCとしてパースするはずなんですが、問題になってないですか?","ts":"1561019473.111700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"34d2f873-6118-4000-a84c-a75a3a2e9968","type":"message","user":"U03C6TEAZ","text":"現在のタイムスタンプで取り出してませんでしたっけ。","ts":"1561019972.112000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c3055425-f5da-4888-b543-755616ad3419","type":"message","user":"U03C6TEAZ","text":"なので、入れる OS の timezone と出す OS の timezone が違ってれば問題になるんですが、同じ OS だしいいかーと割り切ってます。","ts":"1561020036.113400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bcdaa750-a19c-4d9b-93ba-9c39ce42f2c4","type":"message","user":"U06BRP8VD","text":"同じでも問題になるんじゃないかってのが僕の疑問\n<https://github.com/lib/pq/blob/2ff3cb3adc01768e0a552b3a02575a6df38a9bea/encode.go#L443-L445>","ts":"1561020080.114200","attachments":[{"fallback":"GitHub: lib/pq","id":1,"title":"lib/pq","title_link":"https://github.com/lib/pq/blob/2ff3cb3adc01768e0a552b3a02575a6df38a9bea/encode.go#L443-L445","text":"Pure Go Postgres driver for database/sql. Contribute to lib/pq development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/3791026?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/bfaba/img/unfurl_icons/github.png","thumb_width":420,"thumb_height":420,"from_url":"https://github.com/lib/pq/blob/2ff3cb3adc01768e0a552b3a02575a6df38a9bea/encode.go#L443-L445","original_url":"https://github.com/lib/pq/blob/2ff3cb3adc01768e0a552b3a02575a6df38a9bea/encode.go#L443-L445"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2fd5b2ba-c29f-48e0-8cc7-b9b1b647bc40","type":"message","user":"U06BRP8VD","text":"↑ tzOff は postgres から出てくる値に tz がない場合は常に 0 になっちゃうんです。","ts":"1561020123.115100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"479a2910-21c6-47ef-8925-3958f9e5f10a","type":"message","user":"U06BRP8VD","text":"ちょっとちゃんと実験してみるべ。","ts":"1561020234.115500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a185b5cb-544d-46b4-b836-6b93a479059f","type":"message","user":"U06BRP8VD","text":"readのほうだけ実験してみた。やっぱおかしいかもしれない。","ts":"1561021450.115900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","text":"前提としてDB側はこんな感じ。","ts":"1561021559.116000","files":[{"id":"FKQE4K1KN","created":1561021559,"timestamp":1561021559,"name":"Untitled.txt","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":1571,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKQE4K1KN/Untitled.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKQE4K1KN/download/Untitled.txt","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKQE4K1KN/Untitled.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FKQE4K1KN-e995217833","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKQE4K1KN/Untitled.txt/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"11e7bec1-2363-493e-9f01-22902c3588a1","type":"message","user":"U06BRP8VD","text":"ちなみにvbox内のdockerでpostgres動いてる","ts":"1561021597.116900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","text":"動かしたgoのプログラムがこれ","ts":"1561021660.117000","thread_ts":"1561021660.117000","reply_count":1,"replies":[{"user":"U06BRP8VD","ts":"1561021701.117400"}],"files":[{"id":"FKQU5UD88","created":1561021659,"timestamp":1561021659,"name":"pgtime_go.go","title":"pgtime.go","mimetype":"text/plain","image_exif_rotation":0,"filetype":"go","pretty_type":"Go","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":650,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKQU5UD88/pgtime_go.go","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKQU5UD88/download/pgtime_go.go","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKQU5UD88/pgtime_go.go","permalink_public":"https://slack-files.com/T03C4RC8V-FKQU5UD88-d2d48eb7ab","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKQU5UD88/pgtime_go.go/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"04d9e449-9838-42c7-8134-fb9ec720d83e","type":"message","user":"U06BRP8VD","text":"なんでrsにdefer Closeしなかったのか謎だけど、ほっとこ","ts":"1561021701.117400","thread_ts":"1561021660.117000","parent_user_id":"U06BRP8VD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","text":"出力結果はこう","ts":"1561021734.117700","files":[{"id":"FKDFX2LFL","created":1561021734,"timestamp":1561021734,"name":"-.txt","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":58,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKDFX2LFL/-.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKDFX2LFL/download/-.txt","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKDFX2LFL/-.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FKDFX2LFL-dd41182d10","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKDFX2LFL/-.txt/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"6dc24145-5c28-4d86-b821-391509a0013c","type":"message","user":"U06BRP8VD","text":"`go run` を実行した環境、はvboxの外のWindowsなんでJST","ts":"1561021787.118400","edited":{"user":"U06BRP8VD","ts":"1561021798.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","ts":"1561021867.118900","files":[{"id":"FKT2Y8N94","created":1561021867,"timestamp":1561021867,"name":"-.txt","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":120,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKT2Y8N94/-.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKT2Y8N94/download/-.txt","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKT2Y8N94/-.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FKT2Y8N94-60e15b7ca0","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKT2Y8N94/-.txt/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"b2866716-8d97-48ab-9723-2abf0b065aa3","type":"message","user":"U06BRP8VD","text":"main の頭に `fmt.Printf(\"now: %v\\n\", time.Now())` を追加して再実行するとこうなる。","ts":"1561021872.119200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9949478b-bda2-472c-958d-ac6851fd4431","type":"message","user":"U06BRP8VD","text":"あとpostgresをUTC以外で動かすのも、検証したほうが良いのか?","ts":"1561021931.120100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25c252e6-ed53-47e3-80a6-7d82d82d7fa3","type":"message","user":"U06BRP8VD","text":"うむ。書き込む方を先にやってみっか。","ts":"1561022034.120600","edited":{"user":"U06BRP8VD","ts":"1561022043.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U06BRP8VD","text":"現在時刻を timestamp w/o tz に書いて、読み出すだけのシンプルなやつ","ts":"1561022561.120800","files":[{"id":"FKSQ1MKQX","created":1561022561,"timestamp":1561022561,"name":"pgtime2_go.go","title":"pgtime2.go","mimetype":"text/plain","image_exif_rotation":0,"filetype":"go","pretty_type":"Go","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":1010,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKSQ1MKQX/pgtime2_go.go","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKSQ1MKQX/download/pgtime2_go.go","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKSQ1MKQX/pgtime2_go.go","permalink_public":"https://slack-files.com/T03C4RC8V-FKSQ1MKQX-b0cd83ccf4","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKSQ1MKQX/pgtime2_go.go/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"type":"message","user":"U06BRP8VD","text":"その実行結果","ts":"1561022589.121100","files":[{"id":"FKQUQ3SHK","created":1561022589,"timestamp":1561022589,"name":"-.txt","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":132,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKQUQ3SHK/-.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKQUQ3SHK/download/-.txt","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKQUQ3SHK/-.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FKQUQ3SHK-42b53449c7","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKQUQ3SHK/-.txt/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"type":"message","user":"U06BRP8VD","text":"実行後のDBの中身","ts":"1561022622.121400","files":[{"id":"FKDG9PBL2","created":1561022622,"timestamp":1561022622,"name":"-.txt","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"text","pretty_type":"Plain Text","user":"U06BRP8VD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":160,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FKDG9PBL2/-.txt","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FKDG9PBL2/download/-.txt","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U06BRP8VD/FKDG9PBL2/-.txt","permalink_public":"https://slack-files.com/T03C4RC8V-FKDG9PBL2-ec2b3017ab","edit_link":"https://vim-jp.slack.com/files/U06BRP8VD/FKDG9PBL2/-.txt/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"e6a24319-9a61-4bfd-b383-4f701eb0fe8e","type":"message","user":"U06BRP8VD","text":"やっぱ tz をケアしないの、まずいのでは?","ts":"1561022649.122000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e1a0d658-8733-4c1f-bd83-7048677807ad","type":"message","user":"U06BRP8VD","text":"1. lib/pqはtz付きでpostgresに送る\n2. postgresはtzを落として保存する\n3. postgresはtzなしで返答する\n4. lib/pqはtzなし=UTCとして解釈する\n\nこうなってる。","ts":"1561022963.123600","thread_ts":"1561022963.123600","edited":{"user":"U06BRP8VD","ts":"1561022972.000000"},"reply_count":24,"replies":[{"user":"U03C6TEAZ","ts":"1561083342.131400"},{"user":"U06BRP8VD","ts":"1561083568.131600"},{"user":"U03C6TEAZ","ts":"1561086661.187300"},{"user":"U06BRP8VD","ts":"1561087053.189000"},{"user":"U06BRP8VD","ts":"1561087090.189200"},{"user":"U03C6TEAZ","ts":"1561087982.189400"},{"user":"U03C6TEAZ","ts":"1561087995.189600"},{"user":"U06BRP8VD","ts":"1561088231.189800"},{"user":"U03C6TEAZ","ts":"1561088361.190000"},{"user":"U03C6TEAZ","ts":"1561088400.190200"},{"user":"U06BRP8VD","ts":"1561088428.190400"},{"user":"U03C6TEAZ","ts":"1561088456.190600"},{"user":"U06BRP8VD","ts":"1561088705.190800"},{"user":"U06BRP8VD","ts":"1561088761.191000"},{"user":"U06BRP8VD","ts":"1561088909.191300"},{"user":"U03C6TEAZ","ts":"1561089004.192800"},{"user":"U06BRP8VD","ts":"1561089120.193000"},{"user":"U03C6TEAZ","ts":"1561089391.193200"},{"user":"U06BRP8VD","ts":"1561089395.193400"},{"user":"U03C6TEAZ","ts":"1561089431.193600"},{"user":"U03C6TEAZ","ts":"1561089596.193800"},{"user":"U03C6TEAZ","ts":"1561089611.194000"},{"user":"U03C6TEAZ","ts":"1561089629.194200"},{"user":"U06BRP8VD","ts":"1561096617.214300"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"21bee886-5a36-4330-8e36-eedc466b1a3d","type":"message","user":"U06BRP8VD","text":"`ALTER DATABASE pg SET timezone TO 'Japan';` `SELECT pg_reload_conf();` してからやっても結果いっしょだな。そりゃw/o tzでやってるから当然か","ts":"1561023256.124600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c2424824-8aa9-4c82-ac91-607e26187eb5","type":"message","user":"U06BRP8VD","text":"少し前に、GO111MODULE=on した状態で goimports 実行するとえらく遅かったんだけど、いまも変わらないんかなぁ?","ts":"1561007417.080700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8df6e12f-1338-4f30-af6b-6365127cc501","type":"message","user":"U06BRP8VD","text":"遅いまんまだ…","ts":"1561007548.080900","team":"T03C4RC8V","reactions":[{"name":"disappointed","count":2,"users":["U03C6TEAZ","UGHTAV3DF"]}],"replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1f19fd38-9fb5-4f08-9493-e916cd01a7b8","type":"message","user":"U06BRP8VD","text":"正確には go-swagger の出力がめちゃくちゃ遅くなる。go-swaggerはファイルを書き出すときに最後にgoimportsかけるようになってるんですね。で、そこが詰まる。","ts":"1561007799.081800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9fddfeb0-0213-46d4-8495-9d0c662198af","type":"message","user":"U06BRP8VD","text":"いまgo-swaggerを更新して、再実験中","ts":"1561007815.082100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c7ab4fc4-26d3-48ab-bace-b260e6df43d5","type":"message","user":"U06BRP8VD","text":"お、速くなった。なにがあったんだ?","ts":"1561007849.082400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"afd6ef9d-a2da-4ed8-9f2e-a14fcb18f58b","type":"message","user":"U06BRP8VD","text":"とおもったら、普通に起動した goimports がめっちゃ遅いな…","ts":"1561007914.082800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"75390081-6ef0-41b1-a807-45284958c281","type":"message","user":"UGXMRNBUM","text":"go-swagger 使っている仲間がこんなところに…","ts":"1561008112.083100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a1a14bc0-44ba-4884-a41d-4b3e96da4f18","type":"message","user":"U06BRP8VD","text":"ヘビーユーザーあとちょこっとコントリビュートしてる","ts":"1561008129.083400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9474b31e-8797-45e7-acfc-3fe81dd0c6be","type":"message","user":"UGXMRNBUM","text":"ウチも使ってたんですが、ある日ついていけなくなって分岐、\n割と負の遺産化している…","ts":"1561008250.083900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ad1be8a7-d772-4461-8c91-582bea11b1cf","type":"message","user":"U03C6TEAZ","text":"<https://github.com/go-swagger/go-swagger/graphs/contributors>","ts":"1561008279.084100","attachments":[{"fallback":"GitHub: go-swagger/go-swagger","id":1,"title":"go-swagger/go-swagger","title_link":"https://github.com/go-swagger/go-swagger/graphs/contributors","text":"Swagger 2.0 implementation for go. Contribute to go-swagger/go-swagger development by creating an account on GitHub.","thumb_url":"https://avatars3.githubusercontent.com/u/10362650?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/bfaba/img/unfurl_icons/github.png","thumb_width":315,"thumb_height":315,"from_url":"https://github.com/go-swagger/go-swagger/graphs/contributors","original_url":"https://github.com/go-swagger/go-swagger/graphs/contributors"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02a315b1-573b-48c8-b289-399d884bba70","type":"message","user":"U06BRP8VD","text":"あれはぶんきしちゃあかん… テンプレートが魔境なんですよね。","ts":"1561009164.084600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"82bad8cf-d881-4df9-891a-dc994f0da972","type":"message","user":"U06BRP8VD","text":"とはいえ気持ちはわかる。","ts":"1561009221.084800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9633f20f-ccd4-4091-91a6-6f49cc3a3ddc","type":"message","user":"U06BRP8VD","text":"っていうかなんでOpenAPI 3.0のツールがgoにはないんやろな。go-swaggerがやらないからかな…","ts":"1561009394.085300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"424d65da-6964-4705-94dd-44aa7f807abe","type":"message","user":"UGXMRNBUM","text":"このまえ、ふと思いついて小さいツールのopenapi3.0対応やろうとしたんですが、\nそもそもserverコードの生成って筋が悪いんじゃないかという結論に達しつつあります","ts":"1561010698.086100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"997b7b47-1055-4031-8d59-f6d0a2f312ec","type":"message","user":"UGXMRNBUM","text":"openapi-generatorも、go-serverのコードがメンテナンス前提になってなくて\n（生成部分と記述部分が分離できてない）、\n世の中的にも見捨てられてる感がある","ts":"1561010758.087100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cc1e8fd9-f30e-4d43-8de8-1af6b47f8550","type":"message","user":"U06BRP8VD","text":"んーつまりコードからswaggerを生成する?","ts":"1561011383.087400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3d32f6ca-7396-4d76-9780-bc58433c3b5d","type":"message","user":"U06BRP8VD","text":"swagger的なSとCで予め握る仕組みってのは、必要な箇所はあると思うんですよね。どの程度真面目に握るかっていう程度も議論の余地がありますけど。","ts":"1561011493.088600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bd9ac949-5a7a-4cd5-b6bd-85b130e7db3f","type":"message","user":"UGXMRNBUM","text":"swagger自体は良いものだと思うんですけどね。\nswagger -&gt; codeっていう営みがあんまり良いものではないのでは？？という感覚ですね…","ts":"1561013446.090200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"221571f1-1d63-4aa3-9b44-34c61953c188","type":"message","user":"U06BRP8VD","text":"<http://github.com/grpc-ecosystem/grpc-gateway|github.com/grpc-ecosystem/grpc-gateway> が v1.9.1 → v1.9.2 のアップデートで、既存関数の引数の数を変えてた…可変引数の追加だから問題は大きくないんだけど…なんかもにょる。","ts":"1561013727.090900","edited":{"user":"U06BRP8VD","ts":"1561013744.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1119516e-387b-44a7-8608-c2155df51e4e","type":"message","user":"U06BRP8VD","text":"生成されたコードが要求するランタイムのバージョン、みたいな制御はどうしたらええんやろね。バージョン固定はgo.modに書けば良いんだけど、それを書き換えるのは誰か&amp;情報源はどこにするべきか","ts":"1561013822.092200","edited":{"user":"U06BRP8VD","ts":"1561013838.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02c3bb62-9088-4b61-b3e3-78889ada765c","type":"message","user":"U06BRP8VD","text":"コード生成って意味では gRPC の proto 書いて、そっから swagger.yml 生成してクライアント側とドキュメントっていうのもやってるんですよ。","ts":"1561013897.093300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c9fad63-94ea-438c-9d4c-2784a8040110","type":"message","user":"U06BRP8VD","text":"サーバー側はgrpc-gateway使って薄く、みたいな?","ts":"1561013938.094100","edited":{"user":"U06BRP8VD","ts":"1561013946.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
