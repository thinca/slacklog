[{"client_msg_id":"28115467-61bc-40fe-b9d9-69f92fe3c2ae","type":"message","user":"UEA8SS1RN","text":"すいません。質問です。\n1. サーバーアプリ(gRPC)です。\n2. 並列度は0-1です。\n3. 並列度が1の時に入って来たRequestはerrorで返してかまいません。\nというのはどう実装すれば良いですか?\ngoroutineと context.WithCancel(ctx) あたりかなと思ってるんですけど、今goroutineが走ってるかどうかの判定が良くわかりません。\nだれかアドバイスお願いします。","ts":"1586510265.267900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"G9X"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e5081c2f-c429-40b9-8664-6c6578807714","type":"message","user":"UEA8SS1RN","text":"static変数あれば、そこで通過した数を増減させてコントロール出来るのかな。。。","ts":"1586512140.268700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"f9H"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3B52C183-0054-4638-A053-EF30327E148C","type":"message","user":"UDDCM376D","text":"waitgroupってカウント取れないんかな\n取れたら行けそうな雰囲気","ts":"1586512311.269400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tIb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"DCB48983-026C-477B-9C34-06160BAC8354","type":"message","user":"UDDCM376D","text":"<https://golang.org/pkg/sync/#WaitGroup|https://golang.org/pkg/sync/#WaitGroup>","ts":"1586512409.269900","attachments":[{"fallback":"sync - The Go Programming Language","id":1,"title":"sync - The Go Programming Language","title_link":"https://golang.org/pkg/sync/#WaitGroup","text":"Go is an open source programming language that makes it easy to build simple, reliable, and efficient software.","blocks":null,"service_name":"golang.org","service_icon":"https://golang.org/favicon.ico","from_url":"https://golang.org/pkg/sync/#WaitGroup","original_url":"https://golang.org/pkg/sync/#WaitGroup"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oNP3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7B97284D-FBD3-4BBE-9AD5-E1417DF01DC8","type":"message","user":"UDDCM376D","text":"なかった","ts":"1586512413.270200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uBP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"16f3bb66-fe54-4cf5-ba9f-6da5f8884be7","type":"message","user":"U9S4G0LJW","text":"こんなやつ？ <https://oohira.github.io/gobyexample-jp/atomic-counters.html|https://oohira.github.io/gobyexample-jp/atomic-counters.html>","ts":"1586512458.270700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8AY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"02F17239-98D3-4B97-A762-F21713FFD256","type":"message","user":"UDDCM376D","text":"お","ts":"1586512490.270900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sv7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"AD232674-D541-46B1-9107-F5C24148EED4","type":"message","user":"UDDCM376D","text":"なるほど","ts":"1586512492.271000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Du/W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"E645FFB4-F1C0-4530-8AE3-5CFCA2651C5F","type":"message","user":"UDDCM376D","text":"それで行けそうな雰囲気","ts":"1586512498.271300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1Xh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3067f7d1-6cd7-4970-a2e3-4275c04d21f2","type":"message","user":"UEA8SS1RN","text":"確かに行けそうですね。実験してみます。ありがとうございます。","ts":"1586513038.271700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cLwYZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e41bf9ad-e282-494f-a73a-c712bb8a7207","type":"message","user":"U03C6TEAZ","text":"気軽にやるなら chan だけでできます。","ts":"1586514586.272000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FGSi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"879b32ef-bec0-47b4-9628-c80517d4a73a","type":"message","user":"U03C6TEAZ","text":"<https://mattn.kaoriya.net/software/lang/go/20171221111857.htm>","ts":"1586514613.272200","attachments":[{"fallback":"Big Sky: Big Sky :: 簡単に goroutine の実行個数を制限する方法","id":1,"title":"Big Sky :: 簡単に goroutine の実行個数を制限する方法","title_link":"https://mattn.kaoriya.net/software/lang/go/20171221111857.htm","text":"システム開発屋がひっそり語るぼやき","thumb_url":"https://mattn.kaoriya.net/images/logo.png","blocks":null,"service_name":"Big Sky","service_icon":"https://mattn.kaoriya.net/favicon.ico","thumb_width":113,"thumb_height":113,"from_url":"https://mattn.kaoriya.net/software/lang/go/20171221111857.htm","original_url":"https://mattn.kaoriya.net/software/lang/go/20171221111857.htm"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2HKj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"001caf8e-1103-492c-aef4-56c6eaee61a9","type":"message","user":"UEA8SS1RN","text":"goroutine自体使ってなかったので、ようやく真髄ですね。ありがとうございます。","ts":"1586515336.273100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7LU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3bf2a01a-21f5-43c5-8ddc-2a55544db5c8","type":"message","user":"UEA8SS1RN","text":"やばい、なにが書いてあるのかさっぱりわからん。goroutine読んでくる。","ts":"1586516119.275200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"icfQK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"08c93ed3-61b2-4730-881e-aa0967581500","type":"message","user":"UEA8SS1RN","text":"あ、tourでなんかわかるかも。","ts":"1586516294.277000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pAsr/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f0fe8354-f57f-480d-af44-abcb328e3123","type":"message","user":"U03C6TEAZ","text":"Go は goroutine というスレッドとも言えないコルーチンとも言えない仕組みを持っています。その goroutine 間でデータを通信できる仕組み channel を持っています。channel を使うと数値や文字列や struct を受け渡せるのですが、この channel にはバッファ数という物があります。バッファ数を設定すると、送る側はバッファ数を超えて送れません。受信する側が抜き取るまでブロックします。逆に受信する側は送信する物が何も送ってこなければブロックします。いわば FIFO です。","ts":"1586516349.278200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PwyUq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d4962b43-b638-426d-8da0-ed5e7f89a79f","type":"message","user":"U03C6TEAZ","text":"で、このバッファ数を利用して、例えば 1 こまでしか入らない channel を作り、goroutine の処理の開始時に突っ込み、処理が終わったら抜き取る。そうするとバッファ数しか処理できなくなるわけです。","ts":"1586516408.279400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SD7wn"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7383ab88-9677-4e36-82e9-c5c627d73a93","type":"message","user":"UEA8SS1RN","text":"1個までしか入らないchannelの場合、2個目が来たらqueueに入るんですか ?","ts":"1586516471.280600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5ss"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5f93fee8-fd11-4893-8e94-cefa1832b4d9","type":"message","user":"U03C6TEAZ","text":"入らないのでブロックされます。","ts":"1586516486.280900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XVXNv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"098b8eed-c6cf-4a2c-aaf5-c8cc0142bc68","type":"message","user":"UEA8SS1RN","text":"ブロックされるというのはqueueとは別?","ts":"1586516519.281400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tNqb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9bc09fb8-83b1-4b96-8a93-d9eb322f5b75","type":"message","user":"U03C6TEAZ","text":"誰かが抜き取るまで処理が止まります。","ts":"1586516554.282400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"t6cq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5d78353f-6c30-4233-bba4-3b5bd35a6552","type":"message","user":"UAZ33BKV2","text":"マルチスレッドの動きが脳内にできるとブロックはわかりやすいけど、やっかいさもあるか","ts":"1586516599.283500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tfdQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4db57b6e-44e0-48e3-87a6-2a7c8d60ccdf","type":"message","user":"U03C6TEAZ","text":"よく勘違いする人がいるんですが、goroutine/channel を使ったから完全に受信側と送信側が並行処理してる様に思われる方がいますが、実はそうじゃないんです。","ts":"1586516665.285100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PkUp0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ecd6e826-5d05-4cc4-a2d3-93a11d817f0a","type":"message","user":"U03C6TEAZ","text":"バッファ数が１の場合、この channel 通信の間は同期します。","ts":"1586516700.286200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mm6m"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"689fafa8-001e-4438-95fe-6e78bc1cb228","type":"message","user":"U03C6TEAZ","text":"バッファ数を増やせば完全に並列になりえます。","ts":"1586516724.287100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QhTr="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"52f8f4a5-b92c-4fd1-a40e-155a30c54015","type":"message","user":"U03C6TEAZ","text":"いうなれば、リレーのバトンタッチと思って下さい。","ts":"1586516747.287800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"VeX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"538fddb2-36f9-4b68-80b1-4f6465ec6457","type":"message","user":"UEA8SS1RN","text":"なるほど。これを、1個走っている間に2個目のthread的なの来たら、returnするのは出来ないですか? 結構長い処理を行なうんですけど、並列では動かしたく無いので、api呼ばれたら1処理目が動いている間は即returnしたいんです。","ts":"1586516752.288000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kuE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5563a399-4a27-4cf3-bc20-fad11ff1053d","type":"message","user":"UAZ33BKV2","text":"1コ入るまで動いてるgoroutineないし、goroutine動いてる間は次の1コを詰めれないし、...のはず","ts":"1586516769.288600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D496h"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4d86ffff-ec58-42b2-8bcd-74918bcf262f","type":"message","user":"U03C6TEAZ","text":"詰まってるかどうかは `len(ch) == cap(ch)` で確認できます。","ts":"1586516784.288900","team":"T03C4RC8V","reactions":[{"name":"tiken","count":2,"users":["U9S4G0LJW","UEA8SS1RN"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KpKr9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"236970f0-a288-473d-9631-25905c948112","type":"message","user":"UEA8SS1RN","text":"あー、なるほど。それで、returnすれば良いか。","ts":"1586516803.289200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AjEC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b47d5cf1-bfe4-410d-bbb0-307c92717afc","type":"message","user":"UEA8SS1RN","text":"ありがとうございます。","ts":"1586516810.289500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3fo0F"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b6c6382f-8456-45e8-b005-c3d990ed154f","type":"message","user":"U03C6TEAZ","text":"例えば、カメラから画像を取り込み、その画像から解析する様なプログラムを書いた場合、カメラからの取り込みの方が速い場合があるんです。","ts":"1586516859.290800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"g9+Y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2730a127-0994-4faa-87c9-3f1a942f501c","type":"message","user":"U03C6TEAZ","text":"で、そうするとガクガクする様な動作になるんですが、カメラからの取り込み部分でこのチェックをして送るのをやめると、なめらかになるというテクニックが使えます。","ts":"1586516889.291800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eAw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"935e065e-a0a3-49e0-97c3-88e3510a50e2","type":"message","user":"UEA8SS1RN","text":"ほー","ts":"1586516900.292000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DDm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"86e4a804-0507-41d7-bc22-4569ee5ed5f4","type":"message","user":"UAZ33BKV2","text":"受信リミッター的な","ts":"1586516946.292400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fh7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6e0c08dd-9128-46de-8a7a-fe014dc02d3e","type":"message","user":"UEA8SS1RN","text":"とうとうgoroutineに手を出した。golangのgoはgoroutineのgo?","ts":"1586517026.293000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MUARY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2f0a097-599b-4111-b3ac-046f1d4813bf","type":"message","user":"U03C6TEAZ","text":"どうなんでしょうね。最初から goroutine あったのでそうかもですね。","ts":"1586517055.293600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9XaaG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f198cdc1-9fa8-4aa9-b4ad-f18dc647dcd7","type":"message","user":"UKHUVMBJR","text":"Goは碁からって聞いた覚えが。","ts":"1586517067.294200","thread_ts":"1586517067.294200","reply_count":1,"replies":[{"user":"UKHUVMBJR","ts":"1586517715.305600"}],"team":"T03C4RC8V","reactions":[{"name":"hee","count":1,"users":["U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PNR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4eaa26d4-9990-47cc-a163-b34449c76449","type":"message","user":"U9S4G0LJW","text":"golangのcoroutineからgoroutineになったんだと思ってた","ts":"1586517077.294800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N4wKe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"67510466-1ad7-4b63-b11f-db9b20191a67","type":"message","user":"UKHUVMBJR","text":"go文やgoroutineはそれに掛けた造語かな。","ts":"1586517084.295100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fFj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3913691f-7a6b-4f02-99ec-099ea72c3502","type":"message","user":"UEA8SS1RN","text":"goroutineって、cpu分散します?","ts":"1586517103.295700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"iTS6n"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"36cfd853-19d6-4555-8f0c-5a2dad4f42a4","type":"message","user":"U9S4G0LJW","text":"するかもしれないししないかもしれない","ts":"1586517117.295900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SZwmb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"565ae766-3e65-4574-bf41-6555f5e5d5fd","type":"message","user":"U03C6TEAZ","text":"この方式、実際に使っていて go-tflite という TensorFlow Lite の binding でカメラからの画像で物体を検出するサンプルで使っています。","ts":"1586517128.296400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"LL6KB"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b358d05f-7b6e-4024-aa9c-5c95fec924d4","type":"message","user":"U9S4G0LJW","text":"ランタイムがいい感じに判断してやってくれるはず","ts":"1586517129.296600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"i3id"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ee958135-cb4f-4656-b634-ea7a0a25911e","type":"message","user":"U03C6TEAZ","text":"<https://github.com/mattn/go-tflite/blob/master/_example/ssd/main.go#L79-L93>","ts":"1586517129.296700","attachments":[{"fallback":"GitHub: mattn/go-tflite","id":1,"title":"mattn/go-tflite","title_link":"https://github.com/mattn/go-tflite/blob/master/_example/ssd/main.go#L79-L93","text":"Go binding for TensorFlow Lite. Contribute to mattn/go-tflite development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/go-tflite/blob/master/_example/ssd/main.go#L79-L93","original_url":"https://github.com/mattn/go-tflite/blob/master/_example/ssd/main.go#L79-L93"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RP/="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c325c496-a16d-42a0-8ad7-c43553f2add0","type":"message","user":"U03C6TEAZ","text":"goroutine は CPU で分散しますし、さらにいうと CPU に固定されません。","ts":"1586517153.297200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SEPh6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4e7b8e54-5545-41d4-9be9-56a4da836634","type":"message","user":"U03C6TEAZ","text":"例えば GOMAXPROCS という変数で 2 を設定し、2 つの goroutine が動いている時、どちらもシステムコールなどでブロックすると内部的に新しい gorutine が起きます。","ts":"1586517224.298800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eNWGF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ebc49ee1-1742-4d82-9c4b-9f5dd2947cd9","type":"message","user":"U03C6TEAZ","text":"とてもインテリジェントなランタイムになってます。","ts":"1586517258.299400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KfkY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68753dc1-a96e-441b-aaab-f95b45e819ff","type":"message","user":"UEA8SS1RN","text":"ランタイムあたま良い。","ts":"1586517261.299600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mLCyD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aad49416-69b6-4fa1-ac6e-af05894bb933","type":"message","user":"UAZ33BKV2","text":"その動きはcoroutineとthreadpoolのあいのこっぽいですねえ","ts":"1586517333.300100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kytAE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"60b5d24f-77cf-4adb-a941-2b1359536bfc","type":"message","user":"U03C6TEAZ","text":"はい。なので goroutine はコルーチンでもないしスレッドでもないけど、コルーチンでありスレッドでもあります。","ts":"1586517358.300600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N5f+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4b1df715-0ebe-4202-835f-94ff34d87393","type":"message","user":"U03C6TEAZ","text":"な　に　を　言　っ　て　い　る　ん　だ","ts":"1586517374.301000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XPA+/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1640fb01-7415-4305-b2c2-40246bd2de10","type":"message","user":"U03C6TEAZ","text":"<https://blogimg.goo.ne.jp/user_image/41/fb/f4d3dcaa14af715b32cb212610f08da0.jpg>","ts":"1586517397.301200","attachments":[{"fallback":"1920x1440px image","id":1,"image_url":"https://blogimg.goo.ne.jp/user_image/41/fb/f4d3dcaa14af715b32cb212610f08da0.jpg","blocks":null,"from_url":"https://blogimg.goo.ne.jp/user_image/41/fb/f4d3dcaa14af715b32cb212610f08da0.jpg","original_url":"https://blogimg.goo.ne.jp/user_image/41/fb/f4d3dcaa14af715b32cb212610f08da0.jpg"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xqr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"82eb9940-48fe-4576-bb0e-c136240d16c4","type":"message","user":"UAZ33BKV2","text":"ただ、うっかりlimitかけたりがないと、ioブロックでたくさん(想定以上に)goroutineにデータつっこんだりはおきそうですね(MAXのほうは都合おおきくしないといけない、などのとき)","ts":"1586517472.302800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ui2j"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"877b1cd0-454a-40f4-84a2-2e088ef5d909","type":"message","user":"U03C6TEAZ","text":"まぁつまり何を言っているのかというと、気にせず湯水の様に goroutine を使って下さいという話。","ts":"1586517472.302900","team":"T03C4RC8V","reactions":[{"name":"sorena","count":3,"users":["UKHUVMBJR","U9S4G0LJW","U010WB2E7J6"]},{"name":"wakaru","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OoEke"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"661083ec-8e82-4ce2-be07-15dd1e7693e8","type":"message","user":"U03C6TEAZ","text":"goroutine と channel、たった2つなんですがいろんなパターンが実装できます。面白いので試してみるといいかも。","ts":"1586517662.303800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ecj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7563dab6-4234-4805-aee5-de098f41466d","type":"message","user":"U03C6TEAZ","text":"<https://mattn.kaoriya.net/software/lang/go/20160706165757.htm>","ts":"1586517675.304100","attachments":[{"fallback":"Big Sky: Big Sky :: golang の channel を使ったテクニックあれこれ","id":1,"title":"Big Sky :: golang の channel を使ったテクニックあれこれ","title_link":"https://mattn.kaoriya.net/software/lang/go/20160706165757.htm","text":"システム開発屋がひっそり語るぼやき","thumb_url":"https://mattn.kaoriya.net/images/logo.png","blocks":null,"service_name":"Big Sky","service_icon":"https://mattn.kaoriya.net/favicon.ico","thumb_width":113,"thumb_height":113,"from_url":"https://mattn.kaoriya.net/software/lang/go/20160706165757.htm","original_url":"https://mattn.kaoriya.net/software/lang/go/20160706165757.htm"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"taID7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9ec2964f-7572-457e-ae3f-581dc03dc7b8","type":"message","user":"U03C6TEAZ","text":"ここと","ts":"1586517683.304500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EIm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6bc9269e-c852-45ee-8c90-5834b154bf0f","type":"message","user":"U03C6TEAZ","text":"<https://mattn.kaoriya.net/software/lang/go/20180531104907.htm>","ts":"1586517684.304700","attachments":[{"fallback":"Big Sky: Big Sky :: Go 言語の非同期パターン","id":1,"title":"Big Sky :: Go 言語の非同期パターン","title_link":"https://mattn.kaoriya.net/software/lang/go/20180531104907.htm","text":"システム開発屋がひっそり語るぼやき","thumb_url":"https://mattn.kaoriya.net/images/logo.png","blocks":null,"service_name":"Big Sky","service_icon":"https://mattn.kaoriya.net/favicon.ico","thumb_width":113,"thumb_height":113,"from_url":"https://mattn.kaoriya.net/software/lang/go/20180531104907.htm","original_url":"https://mattn.kaoriya.net/software/lang/go/20180531104907.htm"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NFau"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e8d6f6ed-70c2-49a2-aad5-649213ca8ce9","type":"message","user":"U03C6TEAZ","text":"ここ。","ts":"1586517691.305000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PmQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dfdbb594-0630-4575-b181-e99f89d28ca8","type":"message","user":"UKHUVMBJR","text":"ちゃんとしたソースが見当たらなかったのでデマかも…。","ts":"1586517715.305600","thread_ts":"1586517067.294200","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"IxRq"}],"root":{"client_msg_id":"f198cdc1-9fa8-4aa9-b4ad-f18dc647dcd7","type":"message","user":"UKHUVMBJR","text":"Goは碁からって聞いた覚えが。","ts":"1586517067.294200","thread_ts":"1586517067.294200","reply_count":1,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PNR"}]}},{"client_msg_id":"e46a8190-257f-4276-8612-51668878a1e7","type":"message","user":"U03C6TEAZ","text":"どちらも古典的なんですが、今でも普通に使えるテクニックです。最近は context という概念が入っていてキャンセルの仕組みをいれるのが流行りですが。","ts":"1586517719.306000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vKC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b7c47215-ca8f-4b42-b37b-ff83f9ffa739","type":"message","user":"U03C6TEAZ","text":"たぶん Ruby やってた人に分かりやすくいうなら、ブロックされない Fiber と考えるといいのかも。","ts":"1586517808.306700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9Ps5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ccabc522-119b-4d11-a2e8-f98bf8039b62","type":"message","user":"U03C6TEAZ","text":"yeild したあとも動き続ける。","ts":"1586517846.307100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CF/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9e133dfd-557f-4157-9e2c-c2163a4e43c8","type":"message","user":"U9S4G0LJW","text":":goodpoem:  <https://stand.fm/episodes/5e7a0d804c2d3f405df1a0fb>","ts":"1586518008.307400","attachments":[{"fallback":"stand.fm: go routine を自作してみた - DQNEO fm | stand.fm","id":1,"title":"go routine を自作してみた - DQNEO fm | stand.fm","title_link":"https://stand.fm/episodes/5e7a0d804c2d3f405df1a0fb","text":"超原始的な go routine が動いた / マルチスレッドの仕組み / 公式Goの中身 / go routineの言語仕様","image_url":"https://cdn.stand.fm/episodeOGPImages/01E46C9RRGJY4PX6F1MJ6F5SMY.png","blocks":null,"service_name":"stand.fm","service_icon":"https://cdn.stand.fm/assets/apple-touch-icon-180x180.png","from_url":"https://stand.fm/episodes/5e7a0d804c2d3f405df1a0fb","original_url":"https://stand.fm/episodes/5e7a0d804c2d3f405df1a0fb"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"svoS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d68d837e-b22a-401b-aaa4-33a09fc47e39","type":"message","user":"U03C6TEAZ","text":"thread だとそうなりますね。","ts":"1586518120.307800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tVbY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2df74b67-d8fa-4abe-9708-8e5263e2064b","type":"message","user":"U03C6TEAZ","text":"goroutine はその1スレッドの中で goroutine がスイッチしたりします。","ts":"1586518144.308300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HsD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e262b7a8-3b40-474d-bfd6-98cca399565f","type":"message","user":"UEA8SS1RN","text":"とりあえずなんかすげー","ts":"1586518181.308700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KIggN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2083c6d8-10bc-4177-9b62-40b4d6020515","type":"message","user":"U03C6TEAZ","text":"勝手にやるので気にしなくてもいいですが。","ts":"1586518195.309100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"kfJc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a20b455a-1011-42e1-bb8f-fe257f4fb2b2","type":"message","user":"U03C6TEAZ","text":"Cでスレッドプール書いた事かある人には信じられんくらい便利な仕組みなのです。","ts":"1586518303.310500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Lte9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"718f9e97-d48f-4183-8f20-b33fc921715c","type":"message","user":"U06BRP8VD","text":"gRPCってprotocのあれで生成したサーバー使ってんのかな?","ts":"1586518373.311000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ML4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bfb67582-0002-49e6-9333-c64ad0ed0941","type":"message","user":"U06BRP8VD","text":"まぁロジックレイヤで取り合えばよいのか…","ts":"1586518402.311400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/1lf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a023ac05-8af4-45d3-b293-7ed7ef5a0cff","type":"message","user":"U06BRP8VD","text":"僕なら入り口側でふさぎたくなるけど。","ts":"1586518413.311700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wix"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3dc3af01-9c1d-4831-96cd-3987e038a0d5","type":"message","user":"U06BRP8VD","text":"っていうかなんで1つしか受け付けたくないんだ? トランザクショナルな振る舞いにしたいのかしら?","ts":"1586518438.312200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pFb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"69978d3b-b820-425a-8ee5-ab4041a5f30c","type":"message","user":"UNJ2DANJC","text":"単順な排他ロックならmutexでもいい","ts":"1586522284.313900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"E54"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d10f41e8-8dfa-458f-a129-65fa567ba2bd","type":"message","user":"UNJ2DANJC","text":"Cでも最近はlibuvとか使えばだいぶマシだなあと","ts":"1586522488.315200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6IGZl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2e28e9bf-d693-43fa-a843-d191f0286829","type":"message","user":"UNJ2DANJC","text":"最近、Printfとか**f系の関数に渡してる引数のパターンから型かっちりの関数のシグネチャを生成できないかとよく思う。\n単体テストで担保してもいいけど、コンパイル時かそれより前に気づけると良いなあと","ts":"1586523244.320800","edited":{"user":"UNJ2DANJC","ts":"1586523315.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5+K"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"32eb90c7-a00b-4ab5-b050-b70999b59428","type":"message","user":"UAZ33BKV2","text":"gcc/clangとか、それなりにパースしてwarningしてくれますねえ、goもできるとうれしそう。","ts":"1586523440.321700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6IUZL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"772fb03c-3d35-43ee-94ed-de2e253bab8d","type":"message","user":"UNJ2DANJC","text":"goplsは結構怒ってくれますね","ts":"1586523562.322200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ibo=O"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0f6b1037-dfbd-4be8-ab03-a9fbc27ebd7c","type":"message","user":"U06BRP8VD","text":"あれ? go test すると Printf の型とか数とかチェックしてくれませんでしたっけ?","ts":"1586525142.323000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"A6RS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f6035550-899b-49ce-9b77-f8e801571c9f","type":"message","user":"UGXMRNBUM","text":"ログを標準出力に出したがる勢がいることを初めて知った","ts":"1586467041.250300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ynpgC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"55d3fef9-f858-48e8-96b8-5bfc2541e7d5","type":"message","user":"UKHUVMBJR","text":"webならどっちでもいいですからね。なおcgi","ts":"1586473460.251100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qPS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4b021fdf-ffe0-4e35-86fe-6b5105459e15","type":"message","user":"UAZ33BKV2","text":"ユーザー操作くらいまではstdout/stderrがマナーなのと良いプラクティスなのは体感でもあるしわかるけど、もう1段上の業務系はもっとしっかりしたロギング機能がないとなにやるにしても辛いかな、という気がしないでもない...","ts":"1586473902.252500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ncsk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"838F0D07-424C-4941-8845-ADCD66155207","type":"message","user":"UKY76JNAW","text":"Go の標準出力、バッファリングされないんですよね、そういえば。若手に標準出力/標準エラー出力の説明をしてて、サンプルを Go で書いたら期待通りにならなくて気づいた。","ts":"1586474187.255800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Xk2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"971c3f6c-dff6-45ac-a9eb-8c55d3900ae0","type":"message","user":"U0M7GCBPD","text":"golang の log パッケージに関しては標準出力に出したいというより\n・stderr に出すとエラー出力とかと区別が付かないのでロギングはロギングで区別したい\n・設定で変更可能になっている状態にしたい\nとかが大きいんじゃないですかね。まぁ log だとロギングとしては貧弱なのでちゃんとやるなら logrus とか使うんだろうけど","ts":"1586476576.258400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"vKY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56d390ae-8c51-4ee6-990c-2c2eaa73bc46","type":"message","user":"U8CC7MDCL","text":"標準 *エラー* 出力に出すの？logってエラーなの？\nみたいにもにょるのもまぁ分かる","ts":"1586477225.259200","edited":{"user":"U8CC7MDCL","ts":"1586477241.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sQgF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f52f4611-074f-4b62-8b81-4ed7070de901","type":"message","user":"U03C6TEAZ","text":"どの issue か忘れたけど、昔 Go の issues にも同じことを書いた人がいて、それに対してコアメンバ(だったかは忘れた)が言ったのは「Go の log は diagnostics の出力を想定している」って話だったな。なので標準エラーだからエラーを吐くという想定ではないという事。","ts":"1586477337.260800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"GelI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c7bc0aae-979a-41ef-99ee-819645776bbb","type":"message","user":"UGXMRNBUM","text":"stdout/stderrじゃなくて、mainstream/sidestreamなんて名前になってたらそんなに揉めないんだろうか…意味のない想定ですけど。","ts":"1586479291.263800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mx2Rc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U8F2QH8GG","text":"<@U8F2QH8GG> has joined the channel","ts":"1586489418.265100","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null}]
