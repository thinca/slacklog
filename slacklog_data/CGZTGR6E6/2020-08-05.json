[{"client_msg_id":"808627F2-539F-4C68-B5D5-BFED9902E246","type":"message","user":"UFHQ7TNT0","text":"lodash 使ったことないなー。MDN先生で十分事足りる気がする","ts":"1596553939.138400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OsKt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"94e9289c-2891-4f10-8e0a-f7d05b4857cd","type":"message","user":"U03C71D7H","text":"defineProperty で作られたプロパティを mock したい場合は結局どうするのがいいんだろう","ts":"1596554204.139000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zLH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6a78221e-4313-499c-9de9-062a0af30c47","type":"message","user":"UP6PA1UBE","text":"ライブラリパスを丸ごと置き換えるとか","ts":"1596554472.140200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oBKo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50f3c692-f44e-497f-a498-c60d418742d5","type":"message","user":"U78A6ESHM","text":"ググったらこんなんが出てきました。\n```Object.defineProperty(myObj, 'prop', {\n  get: jest.fn(() =&gt; 'bar'),\n  set: jest.fn()\n});```\n","ts":"1596554564.140700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Zsl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"96f596ae-684e-49d4-9d8c-41101f3cb401","type":"message","user":"U8996GYBF","text":"TSでプラグイン書くのにちょくちょく使ってしまってる","ts":"1596554605.141200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Hp2Ns"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e124b763-0762-4d94-9a95-01a33fee7e80","type":"message","user":"U03C71D7H","text":"前も貼ったのだけど、 <https://unpkg.com/browse/vimhelp@3.0.0/lib/index.js> これの `VimHelp` とかを mock したい (正確にはコンストラクタの引数を spy で見たい)","ts":"1596555686.141900","attachments":[{"fallback":"UNPKG - vimhelp","id":1,"title":"UNPKG - vimhelp","title_link":"https://unpkg.com/browse/vimhelp@3.0.0/lib/index.js","text":"The CDN for vimhelp","blocks":null,"service_name":"unpkg.com","from_url":"https://unpkg.com/browse/vimhelp@3.0.0/lib/index.js","original_url":"https://unpkg.com/browse/vimhelp@3.0.0/lib/index.js"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xz5y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f5bbc1c7-59b3-43e7-933b-062190b9337b","type":"message","user":"U03C71D7H","text":"`require(\"vimhelp/lib/vimhelp\")` の `VimHelp` を直接 mock することはたまたま可能だったので(こっちは `defineProperty` が使われていなかった <https://unpkg.com/browse/vimhelp@3.0.0/lib/vimhelp.js> )、ひとまずはこれでお茶を濁そうかなーと思っているのだけど、\n根本的な解決にはなってないし、実際のところどうするのがいいんだろう (そもそも可能なのか) という感じ","ts":"1596555829.144200","attachments":[{"fallback":"UNPKG - vimhelp","id":1,"title":"UNPKG - vimhelp","title_link":"https://unpkg.com/browse/vimhelp@3.0.0/lib/vimhelp.js","text":"The CDN for vimhelp","blocks":null,"service_name":"unpkg.com","from_url":"https://unpkg.com/browse/vimhelp@3.0.0/lib/vimhelp.js","original_url":"https://unpkg.com/browse/vimhelp@3.0.0/lib/vimhelp.js"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RAw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"U8996GYBF","ts":"1596556358.144400","files":[{"id":"F0188TD7X9Q","created":1596556354,"timestamp":1596556354,"name":"diff.patch","title":"diff.patch","mimetype":"text/plain","image_exif_rotation":0,"filetype":"diff","pretty_type":"Diff","user":"U8996GYBF","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":1666,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F0188TD7X9Q/diff.patch","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F0188TD7X9Q/download/diff.patch","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U8996GYBF/F0188TD7X9Q/diff.patch","permalink_public":"https://slack-files.com/T03C4RC8V-F0188TD7X9Q-57cb484588","edit_link":"https://vim-jp.slack.com/files/U8996GYBF/F0188TD7X9Q/diff.patch/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"3c720965-8fdd-4363-be5a-4567a7d58afc","type":"message","user":"U8996GYBF","text":"<@U03C71D7H> あれな解決方だけどこれでいけるかも","ts":"1596556368.144900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qBk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"da89a7ea-8a71-47b7-935b-f0237a361c83","type":"message","user":"U8996GYBF","text":"あー、どうだろう\n実際試さないと微妙だこれ","ts":"1596556422.145500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EVfX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"31d883ba-a58e-4bac-96f8-bb24762c3744","type":"message","user":"U03C71D7H","text":"テスト実行する時っていちいち webpack するものですかね…?","ts":"1596556443.145900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"hZ4gK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c63376b5-d1ea-44ad-a81b-52d57183247a","type":"message","user":"U8996GYBF","text":"ん、VimHelp側で提供するindex.jsをこれでビルドした結果にするのっておかしいですかね？","ts":"1596556477.146700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Tt6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d327e128-5222-4fc0-a5c0-97f0b8d57aa2","type":"message","user":"U03C71D7H","text":"(webpack あんまり使ったことがないのでその辺りよくしらない)","ts":"1596556483.146900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YP22c"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59f4a45b-e57b-4443-abaa-e8f9a3f6b37c","type":"message","user":"U8996GYBF","text":"あー、これvimhelpパッケージ側の変更です","ts":"1596556497.147400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Ap1Ap"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f21ff131-f546-487d-b965-e3871870eb14","type":"message","user":"U03C71D7H","text":"今回はたまたま vimhelp は自作パッケージですけど、他の人が作ってた場合はダメじゃないです?","ts":"1596556510.147700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N1Fh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"921c28d3-64cd-473b-8991-92595055c4c1","type":"message","user":"U8996GYBF","ts":"1596556517.147800","files":[{"id":"F017U5S7DTR","created":1596556516,"timestamp":1596556516,"name":"無題","title":"無題","mimetype":"text/plain","image_exif_rotation":0,"filetype":"javascript","pretty_type":"JavaScript/JSON","user":"U8996GYBF","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":1713,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-F017U5S7DTR/______","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-F017U5S7DTR/download/______","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U8996GYBF/F017U5S7DTR/______","permalink_public":"https://slack-files.com/T03C4RC8V-F017U5S7DTR-8262101a87","edit_link":"https://vim-jp.slack.com/files/U8996GYBF/F017U5S7DTR/______/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"2a364673-4f43-4e8e-af67-c0c58604e85f","type":"message","user":"U8996GYBF","text":"こんな感じのコードになってる、他の人が提供してた場合ダメそうですね","ts":"1596556532.148300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7R9W"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"46b33547-8f9f-48a3-9eb9-ce84a7fcd5ef","type":"message","user":"U03C71D7H","text":"今回のケースだけに限って言えば `vimhelp/lib/vimhelp` をモックすればいけそうです。一般的にはどうするのがいいのかなぁ、と","ts":"1596556611.149800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8VVj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2b37814b-1da1-429c-86d1-058003ebf466","type":"message","user":"U8996GYBF","text":"なるほど、それはちょっと知識不足だ・・・","ts":"1596556637.150300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pPC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"da78c084-74eb-43b2-9af2-0ec7ed54388a","type":"message","user":"U03C71D7H","text":"そもそもテストの仕方が間違ってる説もあって、今は `hubot-vimhelp` 内で `new VimHelp({args})` を呼び出していて、この引数がちゃんと期待した値を渡せているかをテストしようとしているのだけど、そもそもそれが間違ってる…とか","ts":"1596556697.151400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"K6x2f"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"50286c04-a83f-4b15-82f5-18495de297d6","type":"message","user":"U03C71D7H","text":"hubot なので環境変数からオプションを組み立てて `new VimHelp()` の引数部分を構築しています","ts":"1596556734.152200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yYA"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dda5f99d-5b06-4aea-8df6-eb063d70374e","type":"message","user":"U03C71D7H","text":"(構築と言うか環境変数をそのまんま渡してたw)","ts":"1596556801.152900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ZoC1k"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cd7d2744-ab8e-4465-aa3d-8095b8dc6656","type":"message","user":"U8996GYBF","text":"JSってclassオブジェクトを外から引数として渡すみたいなのできましたっけ","ts":"1596556905.153900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DXnmD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d3bce8d3-a5a9-4e1a-8824-c7916e936425","type":"message","user":"U8996GYBF","text":"なんかDIっぽくやるくらいしか思いつかない","ts":"1596556921.154200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FKK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"17314491-08c6-4d8c-b85d-e54b599b329b","type":"message","user":"U03C71D7H","text":"テストむずかしい…","ts":"1596556933.154400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"t/3cX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e2a7151e-8188-44db-8d27-1994b127aac7","type":"message","user":"U03C71D7H","text":"そもそもテスト対象が hubot script って時点で難易度が上がっている…","ts":"1596556967.155400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Jgq"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a890f05-5c7d-4201-9452-08470b9df88c","type":"message","user":"U8996GYBF","text":"hubotのテストがあまり一般的ではないと考えて適当にimportをmockできるのを使えばいいという話はありそう","ts":"1596556971.155500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"I9l"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c496e7a-6044-4b8d-bf38-0b3859fcef50","type":"message","user":"U03C71D7H","text":"hubot-test-helper とか言うまんま hubot script テスト用のモジュールがあって、これを使っている","ts":"1596557011.156000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YXDc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ff55cc68-9a71-4d83-86fe-27e1b7b8577d","type":"message","user":"U8996GYBF","text":"そっち側のベストプラクティスってないんですかね？\nそれかやろうとしてる内容はhubot-test-helperを使わず単体でテストしちゃった方がいいとか","ts":"1596557048.156800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"c31N"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cb9abc83-f97b-4c04-a211-d858b1d7a08e","type":"message","user":"U8996GYBF","text":"hubotとして結合した上で絶対テストが必要ってなると難しそう・・・","ts":"1596557072.157500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nqgip"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1e46752b-f98f-414f-a7b5-e733400b14ad","type":"message","user":"U03C71D7H","text":"```const Helper = require(\"hubot-test-helper\");\nconst helper = new Helper(\"../scripts/vimhelp.js\");```\nヘルパーさんには hubot script のパスを渡す。テスト毎に hubot の環境を構築した上でスクリプトを load してくれる","ts":"1596557101.157900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"KeQK"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1daa7043-3369-4107-851e-8c51de9748a7","type":"message","user":"U03C71D7H","text":"load はヘルパーさんがやるので import/require を別ので差し替える感じの mock が使えない… (`proxyquire` みたいな)","ts":"1596557160.158800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"k6cs/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"62bbd7f8-8837-4c3e-be3c-ea5692aea368","type":"message","user":"U8996GYBF","text":"パラメータを組み立ててVimHelpクラスをnewする部分を切り出してテストする、とかだと目的とずれる感じですよねぇ","ts":"1596557205.159500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"x3+1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"54010a98-2264-4a98-9ac7-540c4b676c06","type":"message","user":"U03C71D7H","text":"それも考えましたね…しかしテストのために処理がどんどん無駄に複雑になっていくなぁ…と","ts":"1596557270.160100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"14/nV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9983b4e-70d8-42b5-9ea3-4ce50b90bb3a","type":"message","user":"U03C71D7H","text":"testable  なコードむずかしい","ts":"1596557278.160300","team":"T03C4RC8V","reactions":[{"name":"sorena","count":1,"users":["UGHD6GP16"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ewts"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f2250b69-a366-43e7-8b6e-729538ecac74","type":"message","user":"UDDCM376D","text":"tsって keyof を使って obje[k] 記法ができると思ったんですが、\n```const obj = {name: \"gorilla\"}\n\nObject.keys(obj).forEach((k: keyof obj) =&gt; {\n  console.log(obj[k])\n})```\n↑だと↓エラーが出ていて？？の状態です\n```../../../../../../../../private/var/folders/pb/r7kfzkbj3k18bkmd_ntd6c4w0000gn/T/vqnOh28/27.ts(3,36): error TS2749: 'obj' refers to a value, but is being used as a type here.\n../../../../../../../../private/var/folders/pb/r7kfzkbj3k18bkmd_ntd6c4w0000gn/T/vqnOh28/27.ts(4,15): error TS7053: Element implicitly has an 'any' type because expression of type 'string | number | symbol' can't be used to index type '{ name: string; }'.\n  No index signature with a parameter of type 'string' was found on type '{ name: string; }'.```","ts":"1596610938.161600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"74c/w"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bbdd0485-04a0-44e3-97b2-a4fe14eed541","type":"message","user":"UDDCM376D","text":"keyof は 型情報が無いと使えないんでしょうか？","ts":"1596610968.162100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1QZqf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"51be2fde-439e-4551-8d73-ccd88b68315e","type":"message","user":"UDDCM376D","text":"```const obj = {name: \"gorilla\"}\n\nObject.keys(obj).forEach((k) =&gt; {\n  const key: keyof object = k\n  console.log(obj[key])\n})```\nこう書いてみたけどだめだった…\n```a.ts|4 col 9| typescript:Error:2322:Type 'string' is not assignable to type 'never'.```","ts":"1596611104.162700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"M/lkd"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cf3befdc-f8f5-4bad-8ebf-c9c8812c6f43","type":"message","user":"U8996GYBF","text":"```const obj = { name: \"gorilla\" } as const\nObject.keys(obj).forEach((k: keyof typeof obj) =&gt; {\n  console.log(obj[k])\n})```","ts":"1596611413.162900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9uI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0e377019-1213-4ab3-b0c7-65b5103718be","type":"message","user":"U8996GYBF","text":"こう？","ts":"1596611415.163100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Rzu/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"65bd5823-52d4-480e-8cd8-6d3bb0a4c685","type":"message","user":"U8996GYBF","text":"これで `(parameter) k: \"name\"` って推論されてます","ts":"1596611440.163400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"t4fUD"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d8b2c990-6d71-4e17-a5f5-e5a043c1ce58","type":"message","user":"UDDCM376D","text":"なぬ","ts":"1596611445.163600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uvIJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"efb29923-be5a-4ff8-8742-8faeb767f435","type":"message","user":"UDDCM376D","text":"```as const```\nこれってどういう意味ですか？","ts":"1596611455.163900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"oLXX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2f8be4eb-10ef-4f95-8970-4a3c080e6ac4","type":"message","user":"U8996GYBF","text":"const assertionですね","ts":"1596611479.164100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"li6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"604224a7-a32a-4278-8e52-0fbb1a994bf3","type":"message","user":"U8996GYBF","text":"<https://qiita.com/Takepepe/items/f39c249ed31e546ecb7c>","ts":"1596611497.164300","attachments":[{"fallback":"Qiita: TypeScript3.4 の const assertion - Qiita","id":1,"title":"TypeScript3.4 の const assertion - Qiita","title_link":"https://qiita.com/Takepepe/items/f39c249ed31e546ecb7c","text":"const assertion は TypeScript3.4 の新機能です。Const contexts for literal expressions すでに master に入っているので、nightly build で挙動を確...","image_url":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2&w=1200&mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DTypeScript3.4%2520%25E3%2581%25AE%2520const%2520assertion%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3D51396c1a7c257be24d2eafb00db8446a&mark-align=center%2Cmiddle&blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540Takepepe%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3D8dc637542455e67d5b3bac3327c590fa&blend-align=center%2Cmiddle&blend-mode=normal&s=496dfe11b392bab31a764969aa3755f2","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png","from_url":"https://qiita.com/Takepepe/items/f39c249ed31e546ecb7c","original_url":"https://qiita.com/Takepepe/items/f39c249ed31e546ecb7c"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"r7e/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0372cd41-c145-445d-adb6-3ff874bc23ac","type":"message","user":"UDDCM376D","text":"↑で動かなかったスネ","ts":"1596611539.164600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"PJksE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b92611cd-5779-4343-8e9c-099bb1201c89","type":"message","user":"UDDCM376D","text":"```../../../../../../../../private/var/folders/pb/r7kfzkbj3k18bkmd_ntd6c4w0000gn/T/vqnOh28/47.ts(2,26): error TS2345: Argument of type '(k: \"name\") =&gt; void' is not assignable to parameter of type '(value: string, index: number, array: string[]) =&gt; void'.\n  Types of parameters 'k' and 'value' are incompatible.\n    Type 'string' is not assignable to type '\"name\"'.```","ts":"1596611542.164900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WDf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d1b60e5d-8bb9-49c8-9dec-2be67c001ed8","type":"message","user":"UDDCM376D","text":"objectのままだった\n```const obj = { name: \"gorilla\" } as const\nconsole.log(typeof obj)```","ts":"1596611592.165400","edited":{"user":"UDDCM376D","ts":"1596611601.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cyv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"14424521-5380-4e82-a558-336129a63a91","type":"message","user":"U8996GYBF","text":"これforeachのcallbackが取る引数的に面倒そう","ts":"1596611766.166000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FpS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bece6b82-5e44-49a9-b77b-e450faded905","type":"message","user":"UDDCM376D","text":"やりたいことは\n単純にobjectのフィールドを全部空文字でクリアしたいだけなんすよね","ts":"1596611801.166600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/dm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5a36dc3a-2e61-41b2-b732-c6b3b6bee03a","type":"message","user":"U8996GYBF","text":"```const obj = { name: \"gorilla\" } as const\nObject.keys(obj).forEach((k: string) =&gt; {\n  return {...obj, ...{[k]: \"\"}}\n})```","ts":"1596612023.167400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XQQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d355015f-e619-4829-8d06-0c8a3d11deb9","type":"message","user":"U8996GYBF","text":"forEachでreturnしてるのおかしいけど、流れとしてはこんなのでいける気がする","ts":"1596612043.168100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AIWjh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b74a772f-a1fb-49d3-bbbc-056401547007","type":"message","user":"U8996GYBF","text":"reduceになるかな","ts":"1596612086.168600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0XgwL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a80467ae-76fe-4cd6-95a3-62badd8f98d3","type":"message","user":"UP6PA1UBE","text":"`<http://Object.xxx|Object.xxx>(obj)` の types が引数の `obj` を展開しないのは、そもそも js の実装で引数が実際に持ってるキーと推論したキーが合致するとはかぎらないからです","ts":"1596612174.170200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"TyI7/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bc11d99a-ff1c-47ff-ab40-faf94273e32d","type":"message","user":"U8996GYBF","text":"```const obj = { name: \"gorilla\" } as const\nObject.keys(obj).reduce((acc, cur) =&gt; {\n  return { ...acc, ...{ [cur]: \"\" } }\n}, {})```\nこれで（やりたい事の動作として）動きはしそうだけど","ts":"1596612180.170400","edited":{"user":"U8996GYBF","ts":"1596612214.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"UnNic"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25da494a-2a13-4154-a317-59998814a649","type":"message","user":"U8996GYBF","text":"objの型失われますよねぇ","ts":"1596612267.171000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"R8gw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"098c79b1-309d-4d42-bb71-6393697920af","type":"message","user":"UP6PA1UBE","text":"だいたい forEach 使いたくなる場面は実装が Bad ですよ。無理に1行で書こうとしてる。","ts":"1596612324.171700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"QTWxf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"03b2b366-0d39-4b4e-942f-2945516a4cfa","type":"message","user":"U8996GYBF","text":"```type Obj = { name: string }\nconst obj = { name: \"gorilla\" }\n\nconst foo_obj = Object.keys(obj).reduce((acc, cur) =&gt; {\n  return { ...acc, ...{ [cur]: \"\" } }\n}, {}) as Obj```\n自分がやるとしたらこうかなぁ","ts":"1596612552.172100","edited":{"user":"U8996GYBF","ts":"1596612560.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rPbgL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"37ab623f-d2d8-461e-b523-c10813d7841c","type":"message","user":"U8996GYBF","text":"lodashのmapValue使いたくなっちゃうんだけど、どう書くのがベストなんだろう","ts":"1596613010.172600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Mefm"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6728c802-92aa-487c-9ef6-3a9df62b1376","type":"message","user":"UP6PA1UBE","text":"まず↑のエラーはそれ以前の問題で `keyof obj`  じゃなくて `keyof typeof obj` ですよ <@UDDCM376D>","ts":"1596613094.174100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Zta"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f03b4e56-b5a4-478a-966f-77296ed645d4","type":"message","user":"UP6PA1UBE","text":"文法: `keyof TYPE`","ts":"1596613162.175400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JFLw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61aeb2bf-08c6-4bbb-8419-f1254839054c","type":"message","user":"UDDCM376D","text":"ぬ？","ts":"1596613162.175500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"b=r"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"874f3c7c-6159-470a-8f01-1f1da21182e2","type":"message","user":"U8996GYBF","text":"自分も貼り付けましたけど、keyofに指定できるのはtypeですね","ts":"1596613180.176200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"syhSa"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2d03f771-7b41-4466-9f04-831bb0418cfb","type":"message","user":"U776661HA","text":"as 使っていいなら\n\n```const obj = { name: 'gorilla' };\nconst newObj = Object.fromEntries(\n  Object.entries(obj).map(([k]) =&gt; [k, '']),\n) as typeof obj;```","ts":"1596613210.176500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lJivV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8c1fd08d-b305-4360-9bd3-e2d41efc3369","type":"message","user":"U776661HA","text":"でよいのでは","ts":"1596613213.176700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Tvi"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9366c396-ea6b-49cd-9673-ffe58d6cfcc0","type":"message","user":"U8996GYBF","text":"`fromEntries` 使ったことなかった（標準関数知らなすぎ問題）","ts":"1596613258.177200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"St3k"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7f99b539-6368-40d2-99a5-b4fcaf15fe19","type":"message","user":"UDDCM376D","text":"なんか、色々やり方あるんだな","ts":"1596613320.177900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5CeUQ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a47be435-2e9a-4934-850b-7730199c4eb2","type":"message","user":"UP6PA1UBE","text":"`Object.fromEntries` とか `Array.from` を気楽に書けるので Typescript 良い(変換されるし","ts":"1596613341.179000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7tv"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"921cfb78-4490-47f4-9f34-2a33fe4223bf","type":"message","user":"U8996GYBF","text":"`mapValues&lt;T extends object, TResult&gt;(obj: T | null | undefined, callback: ObjectIterator&lt;T, TResult&gt;): { [P in keyof T]: TResult };` 型的にはasよりこっちが安全？","ts":"1596613356.179500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RmpGb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c0a9fb5-bcbb-42eb-b12f-f16dd70107a7","type":"message","user":"U776661HA","text":"`as` 使って良いという時点で「どうやって中身空っぽのオブジェクト作るか？」ってなってるのでいろいろあります","ts":"1596613367.179700","edited":{"user":"U776661HA","ts":"1596613379.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"upQmp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"392ec116-0857-492b-8d6c-f82dd056c483","type":"message","user":"UDDCM376D","text":"あれ、as使わなくても動いた\n```const obj = { name: \"gorilla\" }\nObject.keys(obj).forEach((k: keyof typeof obj) =&gt; {\n  console.log(obj[k])\n})```","ts":"1596613394.180600","thread_ts":"1596613394.180600","edited":{"user":"UDDCM376D","ts":"1596613397.000000"},"reply_count":2,"replies":[{"user":"UP6PA1UBE","ts":"1596614415.183700"},{"user":"UDDCM376D","ts":"1596614646.185500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"agb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8a98b8ff-c6a1-45d5-a4b8-0dd9ed3f6f8f","type":"message","user":"U8996GYBF","text":"as使わないとそのあと変数とかに入れて扱う時に推論が効かなくなるから付けてるやつですね","ts":"1596613410.181300","edited":{"user":"U8996GYBF","ts":"1596613423.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"C1rLj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e49a4435-af60-4df3-83c0-95cd0f45c630","type":"message","user":"UDDCM376D","text":"なるほど","ts":"1596613423.181700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AHioF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1de2a59d-d29d-4670-8123-5c405360b8ff","type":"message","user":"UP6PA1UBE","text":"obj が本当にそのキーを持ってる、それ以外のキーを持っていないことをプログラマが保証できるなら mapValues で推論は自動にできます。","ts":"1596613425.182000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"7d4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7be25a9b-9a0d-4282-8c61-bb4102408668","type":"message","user":"UP6PA1UBE","text":"「標準関数の `Object.keys` が型推論つけてくれないのなんでや」って100万回くらい言われてるらしいですよ\n<https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-263132208>","ts":"1596614234.183500","attachments":[{"fallback":"GitHub: Object.keys() types refinement, and Object.entries() types bugfix by ethanresnick · Pull Request #12253 · microsoft/TypeScript","id":1,"title":"Object.keys() types refinement, and Object.entries() types bugfix by ethanresnick · Pull Request #12253 · microsoft/TypeScript","title_link":"https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-263132208","text":"Per @mhegazy&amp;#39;s suggestion in #12207, this pr applies the logic from that PR to Object.keys. It also fixes a bug in that PR (namely, supporting Object.entries([/* some array */])) and adds a tes...","thumb_url":"https://avatars2.githubusercontent.com/u/6154722?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-263132208","original_url":"https://github.com/Microsoft/TypeScript/pull/12253#issuecomment-263132208"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sfnW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d92e96c7-b1b5-42ff-8956-b5adc7ace492","type":"message","user":"UP6PA1UBE","text":"as で書くとこうなります\n```const obj = { name: \"gorilla\" };\n(Object.keys(obj) as (keyof typeof obj)[]).forEach(k =&gt; {\n  console.log(obj[k])\n});```","ts":"1596614415.183700","thread_ts":"1596613394.180600","subtype":"thread_broadcast","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Plui"}],"root":{"client_msg_id":"392ec116-0857-492b-8d6c-f82dd056c483","type":"message","user":"UDDCM376D","text":"あれ、as使わなくても動いた\n```const obj = { name: \"gorilla\" }\nObject.keys(obj).forEach((k: keyof typeof obj) =&gt; {\n  console.log(obj[k])\n})```","ts":"1596613394.180600","thread_ts":"1596613394.180600","edited":{"user":"UDDCM376D","ts":"1596613397.000000"},"reply_count":2,"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"agb"}]}},{"client_msg_id":"b830ebd1-f529-4efd-a874-dd347fc2cb3a","type":"message","user":"UDDCM376D","text":"なるほど","ts":"1596614626.185200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"DAG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"672044ea-03ca-47e3-a48a-5f518e6ead35","type":"message","user":"UDDCM376D","text":"型難しいな…","ts":"1596614632.185400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HEllj"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2b72e6a-1ea3-4fdd-95f9-9a8af8d518cb","type":"message","user":"UDDCM376D","text":"あー、なるほど\nその書き方もありなのか","ts":"1596614646.185500","thread_ts":"1596613394.180600","parent_user_id":"UDDCM376D","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JC8"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"77cc968f-bddf-41d9-ac09-f549b05144c8","type":"message","user":"UP6PA1UBE","text":"`Object.keys` の返り値が確実に obj のキーになることを保証する方法として、定義部分で一括で書いて定数にしておくというのもできます。\n```// 定義ブロック\nconst Obj = { name: \"gorilla\" } as const;\ntype ObjKey = keyof typeof Obj;\nconst ObjKeys = Object.keys(Obj) as readonly ObjKey[];\n\n// 実装\nObjKeys.forEach(k =&gt; {\n  console.log(obj[k])\n});```","ts":"1596614732.186100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1Tb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"44e6f20c-12d1-416c-aef6-1452634de89c","type":"message","user":"U06ECBRTJ","text":"~型にはまった生き方は良くないですね！型破りで行きましょう！~","ts":"1596614747.186500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RaRy+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4334c3b8-8db9-42a4-89b3-1fca86e9469f","type":"message","user":"UP6PA1UBE","text":"定義ブロック中に書いた `as` はプログラマが保証する。","ts":"1596614778.187300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tvgcT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2eb04ef2-814a-48b4-b33e-2df7d263a980","type":"message","user":"UP6PA1UBE","text":"というか `as` はすべてプログラマが保証しないといけないので、なるべく人間を信用できる範囲でだけ書くべき","ts":"1596614867.188000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WReJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c5ada7d-361e-4ed1-84a4-9549f1779bfc","type":"message","user":"UDDCM376D","text":"なるほど","ts":"1596616861.188200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"F+s"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
