[{"client_msg_id":"40baf161-6d84-4ac6-8abf-fa6cb3f67f15","type":"message","user":"U0M7GCBPD","text":"マサカリ期待\n<https://twitter.com/>_tyru_/status/1202581916303679488","ts":"1575554445.229700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"wFN"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"303a9c08-da63-4890-b4fc-afcda6ec1774","type":"message","user":"U78A6ESHM","text":"`<https://twitter.com/_tyru_/status/1202581916303679488>`","ts":"1575554513.231100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RhQp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5da3ade8-9523-42db-8bde-dbc0a82ddcf7","type":"message","user":"U0M7GCBPD","text":"ありがとうございます…","ts":"1575554550.231900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=DOP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e1c4991c-f480-42c8-a6f1-855eafcd219d","type":"message","user":"U0M7GCBPD","text":"Slack が URL の `_tyru_` を斜体にする…","ts":"1575554551.232100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"78Ht0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f9d460eb-c1aa-4f40-9371-75f249e1cdef","type":"message","user":"U78A6ESHM","text":"w","ts":"1575554558.232400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cYFp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d2486db4-a9de-4768-958b-6ac888c0780e","type":"message","user":"U0M7GCBPD","text":"先日の WYSIWYG のオプションを有効にしたことによるバグかな（あとで報告する）","ts":"1575554578.232800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"mm0o"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3f38c6de-7b4d-4709-8741-c1e3fd9170c1","type":"message","user":"U0M7GCBPD","text":"引用すると\n```HTML を JS でエスケープする方法ってこれが最適解なんかな\n\n    const dummy = document.createElement('div');\n    const text = document.createTextNode(html);\n    dummy.appendChild(text);\n    return dummy.innerHTML;```","ts":"1575554599.233000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"f5l"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"30eeb826-00eb-4275-aedc-505f93dfdd59","type":"message","user":"U0M7GCBPD","text":"これ実際にｷﾞｮｰﾑで書いてるコードなので XSS あったらシャレにならんということで訊いてる次第です","ts":"1575554624.233600","edited":{"user":"U0M7GCBPD","ts":"1575554640.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"zhh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"767f4d96-a145-4128-8a62-33c414b9c805","type":"message","user":"U78A6ESHM","text":"`html` には何が入ってるんですか？","ts":"1575554771.234100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6/R3/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b5e60cb6-64a3-424f-8d12-d1ea8e4e66df","type":"message","user":"U0M7GCBPD","text":"こうした方がわかりやすかったですね。","ts":"1575554937.234400","files":[{"id":"FRB7KNB08","created":1575554937,"timestamp":1575554937,"name":"Untitled.js","title":"Untitled","mimetype":"text/plain","image_exif_rotation":0,"filetype":"javascript","pretty_type":"JavaScript/JSON","user":"U0M7GCBPD","mode":"snippet","editable":true,"is_external":false,"external_type":"","size":286,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FRB7KNB08/Untitled.js","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FRB7KNB08/download/Untitled.js","original_h":0,"original_w":0,"thumb_64":"","thumb_80":"","thumb_160":"","thumb_360":"","thumb_360_gif":"","thumb_360_w":0,"thumb_360_h":0,"thumb_480":"","thumb_480_w":0,"thumb_480_h":0,"thumb_720":"","thumb_720_w":0,"thumb_720_h":0,"thumb_960":"","thumb_960_w":0,"thumb_960_h":0,"thumb_1024":"","thumb_1024_w":0,"thumb_1024_h":0,"permalink":"https://vim-jp.slack.com/files/U0M7GCBPD/FRB7KNB08/Untitled.js","permalink_public":"https://slack-files.com/T03C4RC8V-FRB7KNB08-25c3493c24","edit_link":"https://vim-jp.slack.com/files/U0M7GCBPD/FRB7KNB08/Untitled.js/edit","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"username":""}],"upload":true,"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Z5s"}]},{"client_msg_id":"4c183e06-8514-447e-b24a-e56e74bb548e","type":"message","user":"U0M7GCBPD","text":"html = `\"&lt;script&gt;alert(\"hello\");&lt;/script&gt;\"` です。","ts":"1575554958.235000","edited":{"user":"U0M7GCBPD","ts":"1575555261.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9tN7"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c227f9a-6c86-450c-acae-fb5da9e45345","type":"message","user":"U0M7GCBPD","text":"ん？また色々エスケープされてる","ts":"1575554978.235300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=Noc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b929b139-54b3-4a8c-80e5-403af08c7a9d","type":"message","user":"U03C71D7H","text":"WYSIWYG 無効にすると便利かもしれない","ts":"1575555025.236000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"E8i41"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d6b38152-11b9-4feb-9357-9dcec3f24ac0","type":"message","user":"U8R597E9H","text":"ダミーの DOM でエスケープ解除は割とやる手段なので大丈夫と思います。\nlodash.escape も使うなあ。","ts":"1575555208.236800","team":"T03C4RC8V","reactions":[{"name":"pray","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"qos"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"46d6b354-3f59-4783-bb46-614160c3d1fb","type":"message","user":"U78A6ESHM","text":"dom-based xss かー。","ts":"1575555222.237100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q0L"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"eee050b5-2941-42b0-b4ba-a3e49b217fd9","type":"message","user":"U0M7GCBPD","text":"slack のせいじゃなかった。コピペ元の弊社 slack に投稿したポストが間違ってた","ts":"1575555302.237900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2iks"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7fdacfb8-7b34-471a-8650-bcf667633369","type":"message","user":"U78A6ESHM","text":"w","ts":"1575555311.238100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"X7="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ad805d0f-416d-4ce3-899c-7b8d0bb4152b","type":"message","user":"U78A6ESHM","text":"雑に escape かますと安心度が上がるかもですね。","ts":"1575555422.238600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tqEK6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8962f9dd-de2d-4611-a0af-69ccb6705a57","type":"message","user":"U0M7GCBPD","text":"どんな感じでしょう？","ts":"1575555511.238900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"js/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cfe3f771-ddb8-41de-9254-d0cae56f547d","type":"message","user":"U8R597E9H","text":"ちょっと軽く調べて見ときます。（少しあとで。。。）","ts":"1575555539.239700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4vaT"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"923c692e-6788-4e25-ae5e-d36539f9e32c","type":"message","user":"U0M7GCBPD","text":"おお…ありがとうございます。助かります。","ts":"1575555710.240300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fjayk"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"dfe5353d-bc68-43c0-a8e4-e69f3d68910b","type":"message","user":"U78A6ESHM","text":"<http://blog.tojiru.net/article/207321786.html>\n```document.body.appendChild(document.createTextNode(location.href));```\nやってること同じですね！ちなみに私はこの手法知りませんでしたw","ts":"1575556135.241300","attachments":[{"fallback":"Architect Note: DOM APIとinnerHTMLは等価ではない","id":1,"title":"DOM APIとinnerHTMLは等価ではない","title_link":"http://blog.tojiru.net/article/207321786.html","text":"最近、徳丸本をじわじわ読んでいるのですが、DOM based XSSの話が書いてあったので、少し言及しておこうと思います。 徳丸本から引用 DOM based XSSと呼ばれるXSSがあります。これは、JavaScriptによりクライアント側で表示処理する箇所があり、そこに脆弱性がある場合のXSSです…","thumb_url":"https://blog.seesaa.jp/img/ogp_logo.png","blocks":null,"service_name":"Architect Note","service_icon":"https://blog.seesaa.jp/img/iphone/apple-touch-icon.png","thumb_width":200,"thumb_height":200,"from_url":"http://blog.tojiru.net/article/207321786.html","original_url":"http://blog.tojiru.net/article/207321786.html"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"H5C"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59a0b3c9-3e3c-4ae2-a8b4-7f71a86b5c7f","type":"message","user":"U8R597E9H","text":"やっぱり node.textContent に好きなものぶっこんで innerHTML で取るで大丈夫そうですね。node.textContent に何か突っ込んで XSS になる時点ではあ？って感じですしいいと思う！","ts":"1575556452.242500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+tfZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9b8ecd62-3603-4f11-8a63-8065c63bda7d","type":"message","user":"U8R597E9H","text":"パフォーマンス気になる時以外はこれ使いたいですね。安心感がある。","ts":"1575556474.243000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OJXt"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c8f03f45-824e-4414-ab84-d1935a492113","type":"message","user":"U8R597E9H","text":"おそらく textContent に突っ込むのも document.createTextNode に突っ込むのも意味論は変わらないと思うので、最初の例でいいと思います。","ts":"1575556522.243600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"WaEwF"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59b61211-8916-4a20-b447-0a3b6993c648","type":"message","user":"U8R597E9H","text":"_というか、createTextNode 知らなかったので勉強になりました。。。_","ts":"1575556537.244000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aXJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
