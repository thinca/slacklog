[{"client_msg_id":"b775ddba-e519-4cd3-b153-754818ad0122","type":"message","user":"UDDCM376D","text":"<https://github.com/kennethjiang/js-file-download/blob/cab17e35a0051c687fe4fb0efc86920be269547a/file-download.js#L12-L16>\n\nこのやり方で `Accept-Ranges: bytes` のデータってダウンロードできなかったのですが、\n他のやり方ってありますか？","ts":"1569895627.032700","attachments":[{"fallback":"GitHub: kennethjiang/js-file-download","id":1,"title":"kennethjiang/js-file-download","title_link":"https://github.com/kennethjiang/js-file-download/blob/cab17e35a0051c687fe4fb0efc86920be269547a/file-download.js#L12-L16","text":"Contribute to kennethjiang/js-file-download development by creating an account on GitHub.","thumb_url":"https://avatars2.githubusercontent.com/u/779786?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":165,"thumb_height":165,"from_url":"https://github.com/kennethjiang/js-file-download/blob/cab17e35a0051c687fe4fb0efc86920be269547a/file-download.js#L12-L16","original_url":"https://github.com/kennethjiang/js-file-download/blob/cab17e35a0051c687fe4fb0efc86920be269547a/file-download.js#L12-L16"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1347a83a-f955-4f1f-a4b9-fe4b91d361f8","type":"message","user":"U03C6TEAZ","text":"「ダウンロードできなかったので」\n良い質問の内容ではないですねw","ts":"1569895958.033300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"F69DA382-347B-46B1-BB24-A9E6122F525F","type":"message","user":"UDDCM376D","text":"すいません\nいまいち理由がわかってなくて、\n厳密にいうとダウンロードは出来たのですが壊れてるってエラーになります","ts":"1569896232.034500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9b5b309f-8000-4528-96c8-4a412f2d6f87","type":"message","user":"U03C6TEAZ","text":"いえいえ。ただ何をやろうとして、こうやったら、どうなった(こうだと思うけどそうならない)、くらいが分からないと答えられないかもです。","ts":"1569896353.035600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"76fcbe5c-49be-48da-9851-74e9ee89a32c","type":"message","user":"UDDCM376D","text":"すいません、余裕がなかったので雑な質問をしてしまいました…","ts":"1569896363.035800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ef523f89-04a0-4c30-8f4f-0acbe04fef15","type":"message","user":"UDDCM376D","text":"・やりたいこと\nS3にある画像をダウンロードしたい（pre singed url なので一定時間だれでもアクセス可能）\n\n・やってみたこと\n↑axiosでresponseを取得して、↑js-file-downloadを使ってファイルを保存するところまではできた\n\n・困っていること\nダウンロードしたファイルを開くとファイルが壊れているか、認識できないフォーマットっていうメッセージが出る\n\n・考えられること\nファイルの拡張子が違う→content-typeの通りに拡張子を設定したのでその線はない\nデータが壊れている→urlを直で叩くとちゃんと画像が表示されるのでそれもなし\n\n・不思議なこと\nURL直で画像を表示して右クリックでダウンロードすると3MB\naxiosでダウンロードすると5MB\nという感じで、サイズが大きくなる（なぞすぎる・・）\n\n・質問について\nURLを直叩くときのレスポンスにaccept-ranges: bytesってのがあったので、ファイルのダウンロードがちゃんと最後までできていない可能性がある？\nとなったら、このやり方ではダメなら他に思いつかないので、質問しました。","ts":"1569896942.043700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"56744f45-1534-492b-893e-a23584d603da","type":"message","user":"U03C6TEAZ","text":"クライアントからの Range 指定は axios 任せですか？それとも自分で指定ですか？","ts":"1569897145.044200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c7064874-8b27-4545-bc47-ad9682df9329","type":"message","user":"UNM8AVCB0","text":"S3URLがあればaxiosでfetchせず、そのURLを直接に使う方がいいではないかとおもいますが。","ts":"1569897328.045800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1e860fb7-707d-44cc-a64e-c3bd9d8c941e","type":"message","user":"UDDCM376D","text":"&gt;クライアントからの Range 指定は axios 任せですか？それとも自分で指定ですか？\nとくに指定していないですね\n`axios.get(url).then(response =&gt; {}).catch(error =&gt; {})` ってやっているだけです","ts":"1569897390.046600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1cd2eef0-d05a-4945-97b0-ea18241b94ab","type":"message","user":"UDDCM376D","text":"&gt;S3URLがあればaxiosでfetchせず、そのURLを直接に使う方がいいではないかとおもいますが。\njsで `&lt;a href=\"/images/myw3schoolsimage.jpg\" download&gt;` ってのを作ってクリックするイメージでしょうか？","ts":"1569897459.047400","edited":{"user":"UDDCM376D","ts":"1569899865.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8d31e13b-1ac6-41d6-ac15-02d0649fcba1","type":"message","user":"UNM8AVCB0","text":"そうです。だめですか。:blob_thinking:","ts":"1569897567.048000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"420172b4-abeb-433f-b690-006f5ea8786b","type":"message","user":"UDDCM376D","text":"いえ\n試してみます","ts":"1569897600.048200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bbfba799-f38e-4974-8afd-acdbef2292dc","type":"message","user":"U06BRP8VD","text":"DevToolsのnetworkタブで、axios でDLしたときと普通にDLしたときのリクエストの違いをみてみたら?","ts":"1569897785.049000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0f66adcd-699b-4c74-bd26-5e549250119a","type":"message","user":"U8R597E9H","text":"本件、このような記事を見つけました。\n<http://var.blog.jp/archives/71618647.html>","ts":"1569899176.049600","attachments":[{"fallback":"(*x).b=z-&gt;a+y/c: DataURI が 2MB までしか使えなくて Canvas 画像の保存に困る : (*x).b=z-&gt;a+y/c","id":1,"title":"DataURI が 2MB までしか使えなくて Canvas 画像の保存に困る : (*x).b=z-&gt;a+y/c","title_link":"http://var.blog.jp/archives/71618647.html","text":"◆ DataURI 自体は 2MB 以上にもできるけど URL として開くときは 2MB まで  ◆ a タグで開いて保存しようとするとエラーになる◆ copy() で DataURI の文字列でクリップボードに保存して Node.js でファイルとして保存できる◆ URL.createObjectURL だと 200MB 超えても保","image_url":"https://parts.blog.livedoor.jp/img/usr/cmn/ogp_image/livedoor.png","blocks":null,"service_name":"(*x).b=z-&gt;a+y/c","service_icon":"http://livedoor.blogimg.jp/netomemo-techpc/imgs/5/a/favicon.ico","from_url":"http://var.blog.jp/archives/71618647.html","original_url":"http://var.blog.jp/archives/71618647.html"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d9e3c21c-6134-45c6-b24d-8f3445149b2d","type":"message","user":"U03C6TEAZ","text":"URL は RFC でも 2k と決まってるので、data uri もそうでしょうね。","ts":"1569899255.051900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"80b02531-68ce-4821-b5ce-2357e6fd0ed3","type":"message","user":"U03C6TEAZ","text":"Range の指定を特にしてないのに Range の話が出てきてるのはなんでだろう。","ts":"1569899303.053900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"510abc14-9d08-4e02-876f-277e021e8296","type":"message","user":"U8R597E9H","text":"なるほど。仕様にあるのですね。知らなかったです。\nA タグ経由の　data uri にかかってるのなら、url 直接入れればいけそうな雰囲気。","ts":"1569899326.054500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a6715a15-4acf-497b-b3aa-f8f8567f59b5","type":"message","user":"U06BRP8VD","text":"ああdata uriでダウンロードしてんのか…でも5Mってのがわかんないなbase64で4/3で4MBくらいならわかるけど","ts":"1569899375.055300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6c39eacb-7f4e-440e-bcbf-98e75d89afbb","type":"message","user":"U03C6TEAZ","text":"5/3 ってところをエスパーすると、もしかして base64 されたサイズ？","ts":"1569899492.055800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ae4e3f51-6929-44c2-b6ac-7baf4f07372a","type":"message","user":"U03C6TEAZ","text":"１行上で同じ事を言ってるの見つけて恥ずかしい奴。","ts":"1569899531.056300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"bd218a09-e94d-4044-9762-057e49f46d63","type":"message","user":"UDDCM376D","text":"`&lt;a href=\"<https://xxx.xxx>\" download&gt;` だとダイアログではなく、画面遷移してしまうなぁ…","ts":"1569899621.057100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"68025d72-e989-44e3-a345-5bb1730803e6","type":"message","user":"UDDCM376D","text":"諦めて、サーバー側でsdkを使ってダウンロードして返すようにした方が楽が気がしてきた","ts":"1569899664.057700","edited":{"user":"UDDCM376D","ts":"1569899686.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"efe7ef64-88d3-4ee9-944d-40cf8c59b7c0","type":"message","user":"U8R597E9H","text":"同一オリジン限定らしいですね。data-uri を経由する正当性もあったといえばあったということか。\n<https://developer.mozilla.org/ja/docs/Web/HTML/Element/a#Attributes>","ts":"1569899738.058400","attachments":[{"fallback":"MDN Web Docs: : アンカー要素","id":1,"title":": アンカー要素","title_link":"https://developer.mozilla.org/ja/docs/Web/HTML/Element/a#Attributes","text":"HTML の a 要素 (アンカー要素) は、 href 属性を利用して、別のウェブページ、ファイル、同一ページ内の場所、電子メールアドレス、または他の URL へのハイパーリンクを作成します。","thumb_url":"https://developer.mozilla.org/static/img/opengraph-logo.72382e605ce3.png","blocks":null,"service_name":"MDN Web Docs","service_icon":"https://developer.mozilla.org/static/img/favicon144.e7e21ca263ca.png","thumb_width":600,"thumb_height":600,"from_url":"https://developer.mozilla.org/ja/docs/Web/HTML/Element/a#Attributes","original_url":"https://developer.mozilla.org/ja/docs/Web/HTML/Element/a#Attributes"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c13c8df-ddb9-41ba-867e-86d11d69a8fc","type":"message","user":"U03C6TEAZ","text":"前に nginx がいるなら proxy_pass とかで s3 を直指定しつつ content-type 変えてやればいけそうだけど。","ts":"1569900106.059900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"799083e9-0001-4839-8152-dd8d1bfd4ff7","type":"message","user":"U8R597E9H","text":"_download 属性 + proxy_pass は自分も美しい気がします。_","ts":"1569900192.060400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7b2ffb29-190c-4a36-85c0-5bfaf14a4591","type":"message","user":"U03C6TEAZ","text":"あ、そうか rev proxy になった時点で download 属性付けれるから content-type 変更要らないですね。","ts":"1569900643.061200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"96a43696-9783-4e6a-bc35-ff1803489e6d","type":"message","user":"U03C6TEAZ","text":"古いブラウザ相手にするなら別だけど。。","ts":"1569900649.061400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"53957aa8-c0cd-4f52-b793-25c2ab02ea7a","type":"message","user":"UDDCM376D","text":"画像ダウンロードのAPIを作って、そこを叩くようしてやりたいことは実現できました","ts":"1569903549.062300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d67c43c1-342e-4fb1-855c-68d1d253508b","type":"message","user":"UDDCM376D","text":"みなさん、アドバイスありがとうございますm(_ _)m","ts":"1569903565.062700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"66a8702a-820d-4711-ae3d-f3fd2176b607","type":"message","user":"UDDCM376D","text":"半日潰してしまった、自分の無力さに打ちひしがれる\nがんばろ","ts":"1569904176.063400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":null,"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
