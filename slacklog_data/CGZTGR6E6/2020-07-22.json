[{"client_msg_id":"ab1a6d20-ceff-4ae8-9385-5b6a4cb890a0","type":"message","user":"U03C71D7H","text":"TypeScript でテストを書いていたプロジェクトがあって、以前は動いていたと思うのだけど、いつの間にか `SyntaxError: Cannot use import statement outside a module` でテストが失敗するようになってしまった…\nググってるのだけどこれって情報が出てこない…","ts":"1595402454.468000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"X3azV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e6aff20b-f35e-48cf-abea-a4c366417632","type":"message","user":"U06ECBRTJ","text":"jest ですかね？","ts":"1595402603.468500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XLuQo"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4b24ead6-dd16-4bd8-ac2a-8d4362798261","type":"message","user":"U06ECBRTJ","text":"<https://nektn.hatenablog.com/entry/2019/12/24/190054>","ts":"1595402645.468800","attachments":[{"fallback":"漂泳区分帯: jestのテストファイルでimport構文を使いたいとき -  漂泳区分帯","id":1,"title":"jestのテストファイルでimport構文を使いたいとき -  漂泳区分帯","title_link":"https://nektn.hatenablog.com/entry/2019/12/24/190054","text":"例えば、Reactのプロジェクトで透過な関数に切り出せる部分をソースコード中から発見したとする。 この場合、もちろん別ファイルに切り出してmoduleにする。 では、jestを使ってテストコードを導入してやっていこう...と思った時に、import構文が使えない。 これは、 // func.js export default (value) =&gt; { return value * 2 } という関数に対して、以下のテストコードを実行してみるとわかる。 // func.test.js import func from './func' test('func(1)で、2を得る', () =&gt; { …","image_url":"https://ogimage.blog.st-hatena.com/26006613485968935/26006613488495695/1577344117","blocks":null,"ts":1577181654,"service_name":"漂泳区分帯","service_icon":"https://cdn.blog.st-hatena.com/images/touch-icon-iphone-retina.png","from_url":"https://nektn.hatenablog.com/entry/2019/12/24/190054","original_url":"https://nektn.hatenablog.com/entry/2019/12/24/190054"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"P=9fs"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0b62dfd0-4fb3-4401-90f4-3b79f2c94c0d","type":"message","user":"U06ECBRTJ","text":"この辺が","ts":"1595402650.469100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"B57"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"00900d43-33fd-429a-936d-fa9231c533e4","type":"message","user":"UAZ33BKV2","text":"<https://github.com/TypeStrong/ts-node/issues/922#issuecomment-560973799>\nこういうこと?","ts":"1595402651.469200","attachments":[{"fallback":"GitHub: SyntaxError: Cannot use import statement outside a module · Issue #922 · TypeStrong/ts-node","id":1,"title":"SyntaxError: Cannot use import statement outside a module · Issue #922 · TypeStrong/ts-node","title_link":"https://github.com/TypeStrong/ts-node/issues/922#issuecomment-560973799","text":"I use nextjs import koa from &amp;#39;koa&amp;#39; import next from &amp;#39;next&amp;#39; import clear from &amp;#39;clear&amp;#39; import body from &amp;#39;koa-bodyparser&amp;#39; import cors from &amp;#39;koa-cors&amp;#39; import log...","thumb_url":"https://avatars3.githubusercontent.com/u/6759814?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/TypeStrong/ts-node/issues/922#issuecomment-560973799","original_url":"https://github.com/TypeStrong/ts-node/issues/922#issuecomment-560973799"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fvM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4f908b65-9781-4773-9e9f-81d0fed9e05b","type":"message","user":"UAZ33BKV2","text":"&gt; You’re trying to execute use it as an ES2015 module, but node.js currently understands CommonJS.\nいろいろあるっぽいのがw\n<https://qiita.com/kzee/items/dacbdd552bf8fe49f423>","ts":"1595402695.469800","attachments":[{"fallback":"Qiita: TypeScriptでモジュールのimport/exportやrequire - Qiita","id":1,"title":"TypeScriptでモジュールのimport/exportやrequire - Qiita","title_link":"https://qiita.com/kzee/items/dacbdd552bf8fe49f423","text":"TypeScriptを書いていて、たまにimport出来なかったりして、そしたらrequireしたりとか、モジュールのインポートはふんいきでやっていたんですが、TypeScriptで古いJSのライブラリの型定義を書いていて気持ち悪かっ...","image_url":"https://qiita-user-contents.imgix.net/https%3A%2F%2Fcdn.qiita.com%2Fassets%2Fpublic%2Farticle-ogp-background-1150d8b18a7c15795b701a55ae908f94.png?ixlib=rb-1.2.2&w=1200&mark=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D380%26txt%3DTypeScript%25E3%2581%25A7%25E3%2583%25A2%25E3%2582%25B8%25E3%2583%25A5%25E3%2583%25BC%25E3%2583%25AB%25E3%2581%25AEimport%252Fexport%25E3%2582%2584require%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D54%26txt-clip%3Dellipsis%26txt-align%3Dcenter%252Cmiddle%26s%3Daac3826f5f7eba78e69f78f3ad92f17f&mark-align=center%2Cmiddle&blend=https%3A%2F%2Fqiita-user-contents.imgix.net%2F~text%3Fixlib%3Drb-1.2.2%26w%3D840%26h%3D500%26txt%3D%2540kzee%26txt-color%3D%2523333%26txt-font%3DAvenir-Black%26txt-size%3D45%26txt-align%3Dright%252Cbottom%26s%3Df1dcae91aad2c27fa72aa751837dbe84&blend-align=center%2Cmiddle&blend-mode=normal&s=0868d23e8ddab2bd1233fd8b827d28c9","blocks":null,"service_name":"Qiita","service_icon":"https://cdn.qiita.com/assets/favicons/public/apple-touch-icon-ec5ba42a24ae923f16825592efdc356f.png","from_url":"https://qiita.com/kzee/items/dacbdd552bf8fe49f423","original_url":"https://qiita.com/kzee/items/dacbdd552bf8fe49f423"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"6hh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7528febe-d895-4678-8f8b-7bfbe839a46b","type":"message","user":"U06ECBRTJ","text":"plugin 周りが変わったんじゃないか疑惑","ts":"1595402720.470500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"=eI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3c0f92b0-9be5-49ab-b8a2-6e10fef3ceba","type":"message","user":"UAZ33BKV2","text":"なんか周辺のじょじょのverupでついにサポートされなくなった感","ts":"1595402741.470900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0uG2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d9d979b9-e312-4063-9536-71081b72d68b","type":"message","user":"U03C71D7H","text":"jest じゃないんですよね。mocha 使ってます","ts":"1595402757.471200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fO0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e5428fd3-87f2-452f-bf90-99d18cc8391a","type":"message","user":"U03C71D7H","text":"エラーメッセージ的にはどうもテストファイルがモジュールとして認識されてなさそうなのだけど、それが意味するところがよくわからない","ts":"1595402928.471800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"C+SV"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"40eaba98-3b42-4e65-bd10-9076937e151d","type":"message","user":"U06ECBRTJ","text":"業務な感じがするので、社内の詳しい人に聞くくらいしか無いんじゃないですかね…\nもう少し情報が無いと、エスパーも難しそう","ts":"1595403054.472800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"nKg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"959db31d-f26d-4a18-b2be-a083697e97da","type":"message","user":"U03C71D7H","text":"あ、これは業務ではないですw","ts":"1595403079.473000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"gYl"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9eeafde-f06c-4908-a4ea-fcb236705038","type":"message","user":"U03C71D7H","text":"具体的に言うとこの Slack でも動いている Vim script を実行するhubot-vimexec さんです (ただしまだ publish できていないので見てもらえない)","ts":"1595403135.474100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rQTT+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b9f383bb-f32e-4729-9945-d65dcdddca18","type":"message","user":"U03C71D7H","text":"適当に publish してしまうのが速い気もする","ts":"1595403148.474400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"O=6T"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2bc7e2e3-eb0b-4bfa-8ba3-25109b2271e7","type":"message","user":"U06ECBRTJ","text":"速度","ts":"1595403154.474600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Vth"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b0c16289-5b86-426c-8f40-18e8b9b93cf1","type":"message","user":"U03C71D7H","text":"しかし不思議なのは以前は動いていたはずなんだよな…","ts":"1595403205.474900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"s+Cu="}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4230f44f-f391-459a-afe1-cdeb464f7d0d","type":"message","user":"U06ECBRTJ","text":"node/typescript のバージョン上げたりとかは…？","ts":"1595403239.475300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uGdI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"144f35da-8d0e-4d78-bd99-70f54a8b677f","type":"message","user":"U03C71D7H","text":"とくにしてないはず…と言いたいところだけど自信がないw","ts":"1595403369.475700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"0B320"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d8fafa6f-9236-4618-b952-7207327d0e2d","type":"message","user":"U03C71D7H","text":"動かないってことは何かしらを変えてしまったのだよな","ts":"1595403389.476000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YZB90"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3eaeda1c-a136-44a4-8ef3-b25265f9f79b","type":"message","user":"U06ECBRTJ","text":"バージョンを固定したい… そんなときは Docker ですよ！","ts":"1595403413.476700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Uv4"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"47f026cc-be53-446e-8d2e-5736911dc4de","type":"message","user":"U8996GYBF","text":"あ、多分同じエラー前業務で出たやつ","ts":"1595403502.477500","team":"T03C4RC8V","reactions":[{"name":"joy","count":1,"users":["U06ECBRTJ"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"J6ReE"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2389f988-c017-44b0-926f-38f68a6ab386","type":"message","user":"U8996GYBF","text":"webpackとかでimport解決できてもjestが解決してくれないやつですね","ts":"1595403527.478100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JX3+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b89686e0-5043-44fa-9648-376c7ec9b2e5","type":"message","user":"U8996GYBF","text":"多段npmプロジェクト構成になってる場合とかにあり得る","ts":"1595403541.478400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"RA+4h"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1e9d90a1-320c-4993-b3fe-9a72194a8794","type":"message","user":"U8996GYBF","text":"```- package.json\n- src\n  - foo.ts\n  - dir\n    - package.json\n    - bar.ts```\nこうなってたら `bar.ts` からwebpackとかのレベルでは `import foo` できるんですけど、jestで落ちたってのがありました","ts":"1595403638.480200","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SKND"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"b811fb87-95db-4299-83c4-724eb08e9a2f","type":"message","user":"U8996GYBF","text":"jestじゃなくてmochaって見てなかった・・・\nでもこの辺パス解決がテストフレームワークにロックインされてる可能性がありそうです","ts":"1595403687.480700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"rrML"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92da5a05-e902-440c-9654-45759f5332a7","type":"message","user":"U8996GYBF","text":"package.jsonの他に何見てたっけな・・・\nでもそのときはnpmパッケージって自動で判定されそうな怪しいファイル群消せばひとまず動くようにはなりました","ts":"1595403751.481400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bPka6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f4d23e86-5f6c-4484-8fae-1543ef893573","type":"message","user":"U03C71D7H","text":"多段にはしてないんですよねぇ…うーむ","ts":"1595403838.481800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"o0LId"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a2722f4a-66f6-4b13-b5b7-5b5ab1fdad2b","type":"message","user":"U03C71D7H","text":"あと、モジュールが見つからないのではなくてそもそも import が使えない状態ですね","ts":"1595403860.482300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"McX"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aea85468-ebc5-47f6-bf26-7cc90f2189bc","type":"message","user":"U8996GYBF","text":"`Cannot use import statement outside a module` なんで、多分何らかの場所でmodule外のファイルをimportしようとしてるって解釈されてる予感はします","ts":"1595403889.482800","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fJqU"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1fde7061-4f1c-4c2e-a6cf-3dda7312d69d","type":"message","user":"U8996GYBF","text":"ログを見てたら当時は（多段構成になっていたせいで） <https://github.com/babel/babel/blob/2c31587aa1cd4ca9dc699b8c2b24d6e54e568301/packages/babel-core/src/config/files/package.js#L22-L25> で.babelrcが適切に読まれなくなって死んでいたらしい","ts":"1595403976.483300","edited":{"user":"U8996GYBF","ts":"1595403991.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"aofun"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"72ae7826-4f04-4b78-984c-995ea02200ee","type":"message","user":"U03C71D7H","text":"import しようとしているのは `chai` ですね。そして SyntaxError なのでそもそも構文的に import が許可されていない雰囲気を感じます","ts":"1595404076.484400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"tv2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"66a8a386-a1b0-4a3a-9a75-f4dd9ae13d5a","type":"message","user":"U8996GYBF","text":"いや、 importが使える場所（というかbabelの設定ファイル名をリネームしただけで解決した問題）でも `SyntaxError: Cannot use import statement outside a module` が起きてたみたいです\n当時それで `.babelrc` -&gt; `babel.config.json` にリネームしたら解決してる\n<https://babeljs.io/docs/en/config-files>","ts":"1595404223.485900","edited":{"user":"U8996GYBF","ts":"1595404287.000000"},"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"46aS"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"aa24a7da-ae13-45bc-8c10-69dd94d171d5","type":"message","user":"U8R597E9H","text":"mocha のバージョンが上がって mocha.opts が使えなくなったりはしたみたいですけど、急に動かなくなる理由はわからないですね。。。","ts":"1595404224.486100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HC+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e8040f3a-ad94-4ec9-b535-685f54454151","type":"message","user":"U8996GYBF","text":"自分も急に動かなくなった理由は分からないですけど、一応jestで全く同じエラーが起きたときにbabelの設定ファイルをプロジェクト全体に適用するようリネームしたら解決したって記録だけは・・・","ts":"1595404382.487300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"noo8z"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1d7e8ae4-1d74-4041-8e96-42a6935f62b4","type":"message","user":"U8996GYBF","text":"chaiのimportが動かないってのは確かに違うかもしれないですね、当時内側のnpm moduleから外を相対パスで読もうとして死んでた問題だったので","ts":"1595404544.488100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Sbw"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7B2FFBA6-4704-43E8-A64E-0C91E205CC69","type":"message","user":"U776661HA","text":"tsconfigみたい","ts":"1595406468.488600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"5XB6f"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"28b64c76-133b-4671-aa63-2113d2fbb5fe","type":"message","user":"U78A6ESHM","text":"```compilerOptions: {\n  ...\n  \"types\": [\"mocha\", \"node\"],\n}```\nとかかな？(jasmine2 で前なった)","ts":"1595406593.489900","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Pe+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"793f9e79-ec80-4874-b1cd-2dd16e87831d","type":"message","user":"U03C71D7H","text":"お仕事終わったらリポジトリ作って仮ブランチにコード上げます！","ts":"1595407434.490400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yX1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f6bef151-fbbd-46e9-9056-9102b4992008","type":"message","user":"U8996GYBF","text":"すみません、最高の発想だと思ったんですけど要件次第での詰みが発生しました・・・\n`--bind` に `reload` を渡した場合にどうあがいてもコンテキストを引き回すことができない（外部コマンドを動的に実行してfzfのソースとして使うので情報が消える）","ts":"1595414418.490500","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EZPi5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f491808a-a5bf-4f2c-86b7-a36fbd8e344a","type":"message","user":"U8R597E9H","text":"そもそもコンテキストを引き継ぐため、というよりは「各アイテムに filter 文字列以上の情報を渡しておいて、取り回しやすくする」というニュアンスだったので、あまり把握できていません。。。","ts":"1595415707.490700","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yy9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"3630aceb-de0d-4ef2-9c4b-00d698e20ac6","type":"message","user":"U8R597E9H","text":"コンテキストを引き継ぐ件については `reload` 実行時の処理は fzf-preview 側に責務があると思っていたので「さっきまで実行していた fzf のセッション情報」から引き継いだり履歴管理したりできるのかなーと。漠然と思いました。\n\nただ、@ycino さんのほうが詳しいので、厳しいようでしたらすいません。","ts":"1595415780.490900","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Bfj3"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e3f99312-7a0c-441b-bd38-083ec97ade68","type":"message","user":"U8996GYBF","text":"なんか細かい話振っちゃってすみません\nreloadを使いたい場合にJSONを付与できなくなるってことですね\n例えば\n```C-b: branch\nC-r: reflog\nC-c: commit```\nで表示を切り替えるような使い方をしたい場合って、キーにそれぞれに対応した外部コマンドを設定するしかできなくて、vimプラグインのコンテキストで扱うことができないって感じです","ts":"1595415874.491100","thread_ts":"1595337594.461800","edited":{"user":"U8996GYBF","ts":"1595415901.000000"},"parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"+LPJY"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"42c81a85-fc86-4dd4-8224-9996da783263","type":"message","user":"U8R597E9H","text":"reload を使いたい時に JSON を付与できなくなる。というのがよくわかっていません。。。ごめんなさい。\nもう少し、全体について説明してもらったほうがスムーズかもしれません。（もしくは、@ycino さんの中で結論でているようだったら、このままでも大丈夫です。）","ts":"1595416095.491500","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"drM"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0b0ac648-92cb-49ed-a69f-44a21c8d6e51","type":"message","user":"U8996GYBF","text":"`ls -1 | fzf --bind=\"ctrl-a:reload(git status --short),ctrl-b:reload(ls -1)\"`\nこんな感じのコマンドを実行したら分かりやすいかもなんですけど、（例えばfzfの実行中にcommit一覧とbranch一覧を切り替えるとかやりたいときに）キーにreloadってのを設定することができて、この場合C-aで `git status` C-bで `ls` なんですけど\nこれって外部コマンドの指定をすることしかできなくて、初回にVimプラグインからfzfを実行するときに渡した情報は全てリセットされて新しく外部コマンド実行結果を流し込むんですよね・・・","ts":"1595416803.491700","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"q/K"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"4c9fc3c8-34e2-450e-9102-64e4e08cbe66","type":"message","user":"U8996GYBF","text":"なので、reloadを使いたい場合はTSの世界ではなくて、（仮に無理矢理実装するとしたら）何らかの実行可能な外部コマンドにJSONを付与する機能を付ける必要が出てきてしまいそうです\nちょっと回避方法色々考えてはいるんですけど","ts":"1595416964.491900","thread_ts":"1595337594.461800","edited":{"user":"U8996GYBF","ts":"1595416994.000000"},"parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OR3d"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ba3509dc-ea4d-4211-b218-c12e821ce049","type":"message","user":"U8R597E9H","text":"そうですね。`コマンドパイプで候補を出力する系` と `fzf-preview が自ら候補を生成して渡す系` があるのだと思います。","ts":"1595417030.492200","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"t+atg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"d4651ede-97bd-4838-8e0f-578691772f59","type":"message","user":"U8R597E9H","text":"前者はどうあがいてもカスタム不能なので、後者に関する話にはなりそうです。","ts":"1595417049.492400","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"u84J5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"25393cee-a234-4499-8425-9ec45b2f0568","type":"message","user":"U8996GYBF","text":"ですね\nなのでreloadを含めると一概にJSONでの扱いは不可で、Resourceの定義をUnion型で分けて受け取った側でパターンを分けてどうにかするとか、なんか無理矢理な感じのことをやらないといけない感じです\nfzfでgitを便利に扱う場合はUX的にreloadを扱いたかったので厳しいなと、もうこれは愚痴に近いんですけど・・・","ts":"1595417199.492600","thread_ts":"1595337594.461800","edited":{"user":"U8996GYBF","ts":"1595417219.000000"},"parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"cMXJ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a50bfc7b-dd22-46d1-ba25-16ceae9fe8c8","type":"message","user":"U8R597E9H","text":"あ、reload ってもしかして fzf の機能なんでしょうか…。\n再度、fzf-preview がコマンドをやり直すのかと思っていました…(その場合はまた fzf-preview 始まりなので、json つけたり加工できるのかなと)","ts":"1595422863.492900","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EEFe5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"144f91b5-600d-40f8-9db0-ef3506d2b1a6","type":"message","user":"U8996GYBF","text":"あ、CLIのfzfのオプションですね","ts":"1595423580.493100","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"xXW"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e0277e6e-1433-4f1f-87ef-cfc872b97f48","type":"message","user":"U8996GYBF","text":"確かにreload使わず全てfzf-previewを経由して再起動するようにしたらどうにかできそうですね\nもうちょい考えよう・・・","ts":"1595423618.493300","thread_ts":"1595337594.461800","parent_user_id":"U8996GYBF","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"v9r"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
