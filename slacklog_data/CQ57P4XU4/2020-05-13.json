[{"client_msg_id":"790cf4ef-5195-411f-888c-627dded15bf1","type":"message","user":"US5UW1UNB","text":"すみません。\n\n- vim-lsp\n- efm-langserver\n- vim-efm-langserver-settings\n\nという構成で使ってるんですが、eslint が ファイルによっては 行0 でエラーを出すので\nefm-langserverが -1 を渡している、と思っています。これによって、 vim-lsp では負の行数が与えられることが想定されていないようで、`nvim_buf_add_highlight()` などでエラーが出ます。\nvim-efm-langserver-settings は eslint にファイル名を渡しているので、\nefm-langserver の README.md での設定例との差が出ているのだと思っています。\n(.eslintrc.js とかを特別な設定なしで読むと再現すると思います)\n\n最初、vim-lsp 側に負の行数を使う直前に0 にするようにしてみたんですが、LSPの仕様的には efm-langserver 側で対応したほうがいいのかなと思いました。\n( zero-based が 0以上 であることを要求してるのか それとも type が number だから OK なのかちょっと判断できませんでした )\n\nvim-efm-langserver-settings の設定はこのままでいいと思っています\n\nあまりLSPの仕様を読めていなくて、 go もあまり読めず、解釈が正しいかわかりません…\nvim-lsp を修正して対応するのは、efm-langserver側で0以上にするのに比べて、LspDocumentDiagnostic の quickfix での見た目が `.eslintrc.js||...` と、行番号が無設定になって、本来のlinterの出力に近くなるので嬉しいかなと思いました。\n\nどこなおすのが良さそうですかね…","ts":"1589301842.158100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"S1O4Q"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5ddddeb6-2c2e-4e57-8c0b-bb50296adc02","type":"message","user":"U03C6TEAZ","text":"<https://github.com/mattn/efm-langserver/blob/master/langserver/handler.go#L268>","ts":"1589301951.158300","attachments":[{"fallback":"GitHub: mattn/efm-langserver","id":1,"title":"mattn/efm-langserver","title_link":"https://github.com/mattn/efm-langserver/blob/master/langserver/handler.go#L268","text":"General purpose Language Server. Contribute to mattn/efm-langserver development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/efm-langserver/blob/master/langserver/handler.go#L268","original_url":"https://github.com/mattn/efm-langserver/blob/master/langserver/handler.go#L268"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OiO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1d7495be-9747-4f57-9281-c76618f9fb72","type":"message","user":"U03C6TEAZ","text":"このあたり。","ts":"1589301955.158600","thread_ts":"1589301955.158600","reply_count":2,"replies":[{"user":"US5UW1UNB","ts":"1589302183.158700"},{"user":"U03C6TEAZ","ts":"1589302555.158900"}],"team":"T03C4RC8V","reactions":[{"name":"eyes","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"D+gu"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"69d163c2-f13e-4840-b855-0db9bf77f92f","type":"message","user":"US5UW1UNB","text":"ありがとうございます！\n`Line: , Character:` を (0, 0) 以上にすればいけそうですかね…\nefm-langserver としてはそれはありなんですかね…?","ts":"1589302183.158700","thread_ts":"1589301955.158600","parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"pVr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c36cdef8-46eb-4115-ae9b-62bcace7d4fe","type":"message","user":"U03C6TEAZ","text":"たぶんこの変更で入ったと思うんですよね。 <https://github.com/mattn/efm-langserver/commit/37fa969f0560ca7d59bd04ebed249e48aeae1178>","ts":"1589302555.158900","thread_ts":"1589301955.158600","attachments":[{"fallback":"GitHub: Support multiline errorformat with errorformat.Scanner · mattn/efm-langserver@37fa969","id":1,"title":"Support multiline errorformat with errorformat.Scanner · mattn/efm-langserver@37fa969","title_link":"https://github.com/mattn/efm-langserver/commit/37fa969f0560ca7d59bd04ebed249e48aeae1178","text":"General purpose Language Server. Contribute to mattn/efm-langserver development by creating an account on GitHub.","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":250,"thumb_height":250,"from_url":"https://github.com/mattn/efm-langserver/commit/37fa969f0560ca7d59bd04ebed249e48aeae1178","original_url":"https://github.com/mattn/efm-langserver/commit/37fa969f0560ca7d59bd04ebed249e48aeae1178"}],"parent_user_id":"U03C6TEAZ","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HfK0"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
