[{"client_msg_id":"3ada7061-3c85-4dbc-a3ab-8e9a701976c3","type":"message","user":"UG6DF6W87","text":"Firefox extension を書くために manifest.json を書いてると\n```  \"icons\": {\n    \"48\": \"resources/icon_48x48.png\",\n    \"96\": \"resources/icon_96x96.png\"\n  },```\nこれで `icons` は array にしろ、と怒られます\n多分 <https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/web-manifest.json> こっちの schema が使われてしまってそうで、\n<https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/chrome-manifest.json> こっちを読んで欲しいんですが、\nこういう同名のファイルって json-langserver にどうやって教えてやればいいんでしょう??","ts":"1587186342.478800","attachments":[{"fallback":"GitHub: SchemaStore/schemastore","id":1,"title":"SchemaStore/schemastore","title_link":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/web-manifest.json","text":"A collection of JSON schema files including full API - SchemaStore/schemastore","thumb_url":"https://avatars1.githubusercontent.com/u/9812707?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/web-manifest.json","original_url":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/web-manifest.json"},{"fallback":"GitHub: SchemaStore/schemastore","id":2,"title":"SchemaStore/schemastore","title_link":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/chrome-manifest.json","text":"A collection of JSON schema files including full API - SchemaStore/schemastore","thumb_url":"https://avatars1.githubusercontent.com/u/9812707?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/chrome-manifest.json","original_url":"https://github.com/SchemaStore/schemastore/blob/master/src/schemas/json/chrome-manifest.json"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YhDzg"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"816814a7-71a4-4397-9e85-ae0a50edbda1","type":"message","user":"UG6DF6W87","text":"あ、でもそもそも manifest.json しかない状態で、どういうコンテキストの manifest.json かどうかなんて自動で判定できる訳はないですね\npackage.json を書けばいいのかな...?","ts":"1587186536.480100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"e=6"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e5ed4b23-d61d-45ed-a05b-e5d6a46bc173","type":"message","user":"UG6DF6W87","text":"んー、<https://docs.npmjs.com/files/package.json> みても何向けのプロジェクトである、みたいな宣言はできなそう","ts":"1587187336.482000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"N60"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a065602b-7e4e-41ec-85b4-fddb2a771b32","type":"message","user":"UG6DF6W87","text":"json-langserver 的には workspace/didChangeConfiguration 投げてくれってことっぽいな\n<https://github.com/vscode-langservers/vscode-json-languageserver#settings>","ts":"1587187745.483100","attachments":[{"fallback":"GitHub: vscode-langservers/vscode-json-languageserver","id":1,"title":"vscode-langservers/vscode-json-languageserver","title_link":"https://github.com/vscode-langservers/vscode-json-languageserver#settings","text":"Extracted from vscode tree. See <https://github.com/vscode-langservers/vscode-json-languageserver-bin> for Binary version - vscode-langservers/vscode-json-languageserver","thumb_url":"https://avatars1.githubusercontent.com/u/30978142?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":256,"thumb_height":256,"from_url":"https://github.com/vscode-langservers/vscode-json-languageserver#settings","original_url":"https://github.com/vscode-langservers/vscode-json-languageserver#settings"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"bb1"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"88d7c47b-e5ed-4326-9359-f0b2de5635e6","type":"message","user":"UG6DF6W87","text":"あ、そこで <https://github.com/mattn/vim-lsp-settings/pull/217> か!","ts":"1587188685.483800","attachments":[{"fallback":"GitHub: Load extra schemas by mattn · Pull Request #217 · mattn/vim-lsp-settings","id":1,"title":"Load extra schemas by mattn · Pull Request #217 · mattn/vim-lsp-settings","title_link":"https://github.com/mattn/vim-lsp-settings/pull/217","text":"If you want to add extra schemas for yaml-language-server or json-language-server, do :LspSettingsLocalEdit or :LspSettingsGlobalEdit and put schemas property like below: { &amp;quot;yaml-language-...","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-lsp-settings/pull/217","original_url":"https://github.com/mattn/vim-lsp-settings/pull/217"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3NL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"da237eec-7799-4f23-986c-a9251bb44910","type":"message","user":"UG6DF6W87","text":"<https://github.com/mattn/vim-lsp-settings/pull/219>\nGit 管理下じゃなくても手動でプロジェクトルートを指定できるようにする PR 投げてみた","ts":"1587194699.486700","attachments":[{"fallback":"GitHub: Can specify the project root directry by tennashi · Pull Request #219 · mattn/vim-lsp-settings","id":1,"title":"Can specify the project root directry by tennashi · Pull Request #219 · mattn/vim-lsp-settings","title_link":"https://github.com/mattn/vim-lsp-settings/pull/219","text":":LspSettingsLocalEdit will automatically find the project root if the project is under the control of VCS. However, if my project is not under the control of VCS, I want to specify the project root...","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-lsp-settings/pull/219","original_url":"https://github.com/mattn/vim-lsp-settings/pull/219"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"HSiM/"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"867c4280-a810-41ac-b627-bfcbc59140d1","type":"message","user":"UG6DF6W87","text":":LspSettingsLocalEdit で上書いてもだめだな...\nどうすりゃいいんだろ...","ts":"1587198210.488100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9IW6Y"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"176f6c31-50a9-43de-9447-714745f2c87c","type":"message","user":"UAZ33BKV2","text":"あれ、効きませんか?","ts":"1587198240.488300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"piaOc"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"e0bbbb50-1506-4b72-bdd4-80a7f2e228a9","type":"message","user":"UG6DF6W87","text":"```[\n  {\n    \"url\": \"<http://json.schemastore.org/foxx-manifest>\",\n    \"description\": \"ArangoDB Foxx service manifest file\",\n    \"name\": \"Foxx Manifest\",\n    \"fileMatch\": [\n      \"manifest.json\"\n    ]\n  },\n  {\n    \"url\": \"<http://json.schemastore.org/webextension>\",\n    \"description\": \"JSON schema for WebExtension manifest files\",\n    \"name\": \"WebExtensions\",\n    \"fileMatch\": [\n      \"manifest.json\"\n    ]\n  },\n  {\n    \"url\": \"<http://json.schemastore.org/web-manifest>\",\n    \"description\": \"Web Application manifest file\",\n    \"name\": \"Web Manifest\",\n    \"fileMatch\": [\n      \"manifest.json\",\n      \"*.webmanifest\"\n    ]\n  },\n  {\n    \"url\": \"<http://json.schemastore.org/chrome-manifest>\",\n    \"fileMatch\": [\n      \"manifest.json\"\n    ]\n  }\n]```\n`manifest.json` が `fileMatch` でマッチするやつがこれだけあるのは vim-lsp のデバッグログから分かっていて\nこの状態で `icons` フィールドは array にしろ、と怒られ続けてます","ts":"1587198513.490000","thread_ts":"1587198513.490000","reply_count":1,"replies":[{"user":"UG6DF6W87","ts":"1587199040.493500"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OtH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"55a31db0-95a1-4883-9f06-eb56cd939e76","type":"message","user":"UG6DF6W87","text":"どういう優先順位が json-languageserver で付けられてるのか分からないんですが、この中で `icons` を持っていてかつそれが array であると定義されてるのは `web-manifest` だけなので、それが読まれているっぽいです","ts":"1587198656.491300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"j3qI"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6229e429-485b-4343-8384-81a916406473","type":"message","user":"UG6DF6W87","text":"これを例えば .vim-lsp-settings/settings.json で fileMatch を `hoge.json` とかにして url を `<http://json.schemastore.org/chrome-manifest>` にすると、ちゃんと hoge.json というファイルは chrome-manifest のスキーマが反映される(補完が出来ることからそう判断)ようです","ts":"1587198811.493400","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"ANcO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"a6ff56af-f4bb-4e98-9231-9b6538050c93","type":"message","user":"UG6DF6W87","text":"一番下のやつが .vim-lsp-settings/settings.json で指定したやつです","ts":"1587199040.493500","thread_ts":"1587198513.490000","parent_user_id":"UG6DF6W87","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"alO9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"61a68d15-3e85-4b01-85c6-b8f7ca322ceb","type":"message","user":"UAZ33BKV2","text":"`'schemas': lsp_settings#utils#load_schemas('json-language-server') + [{'fileMatch':['/.vim-lsp-settings/settings.json']` となってて、結合させてるから、かなあ?\nこれ、他のみたいに、ローカルのがあればそれだけ、ないならデフォルト値、みたいな取得パターンにしないとじゃないかという気が、あるいは結合順を変える","ts":"1587199606.495000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"8om3h"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fa9800b6-44f4-48d5-aab4-59f677144782","type":"message","user":"UAZ33BKV2","text":"<https://github.com/mattn/vim-lsp-settings/blob/2d9b59c0111e7b167330064c0d3040ee146e20a9/settings/json-languageserver.vim#L11>","ts":"1587199658.495200","attachments":[{"fallback":"GitHub: mattn/vim-lsp-settings","id":1,"title":"mattn/vim-lsp-settings","title_link":"https://github.com/mattn/vim-lsp-settings/blob/2d9b59c0111e7b167330064c0d3040ee146e20a9/settings/json-languageserver.vim#L11","text":"Auto configurations for Language Server for vim-lsp - mattn/vim-lsp-settings","thumb_url":"https://avatars1.githubusercontent.com/u/10111?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/mattn/vim-lsp-settings/blob/2d9b59c0111e7b167330064c0d3040ee146e20a9/settings/json-languageserver.vim#L11","original_url":"https://github.com/mattn/vim-lsp-settings/blob/2d9b59c0111e7b167330064c0d3040ee146e20a9/settings/json-languageserver.vim#L11"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"MPuwP"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c9874e9a-b85b-4411-bbc0-7e26f6617a25","type":"message","user":"UAZ33BKV2","text":"ローカルのを優先していいとは思う...","ts":"1587199690.495600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"s=Sb"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c4d84204-3fbd-4c56-9ef5-576bd9dd66f6","type":"message","user":"UG6DF6W87","text":"ただそうすると一つ指定したいだけなのにそのプロジェクト配下で使う全ての JSON schema を .vim-lsp-settings/settings.json で指定しないといけなくなっちゃいません?","ts":"1587199782.497000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"fS9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"1af551e5-b364-4d69-90ce-f07ad6b1a86f","type":"message","user":"UAZ33BKV2","text":"まあ、それはあるか...","ts":"1587199838.498000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"b6z12"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"95d18f54-7945-45c7-a6d0-1e137d575bd0","type":"message","user":"UAZ33BKV2","text":"順に読んで先にヒットしたら使われるなら結合を逆にすればいいかな、とは思いますが","ts":"1587199862.498700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"CSmp"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6ea9941b-aab9-40d2-9095-fa5ea474b54d","type":"message","user":"UG6DF6W87","text":"そうですね、ちょっと試してみます","ts":"1587199907.499700","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Q7Xyh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"cc6de495-da45-416c-b259-da5e68634c1d","type":"message","user":"UG6DF6W87","text":"んーだめそう\nローカルの設定を配列の頭に持ってきても末尾に持ってきても変わらずでした...\njson-languageserver 側に priority の設定値があればいいんですが...","ts":"1587200924.001000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"EMC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6404a69c-4e47-4c6e-b1c4-de00a569f597","type":"message","user":"UAZ33BKV2","text":"どういう基準でそうなるんでしょうねえ...","ts":"1587201114.001500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"AEr"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"59153df0-aaa7-4184-b119-d588bcd7f424","type":"message","user":"UG6DF6W87","text":"<https://github.com/microsoft/vscode-json-languageservice/blob/fabbc8069d2b03b0ac73c1f710be4a5535df41d5/src/services/jsonSchemaService.ts#L567>\nあ、全部マージされてる...?","ts":"1587202479.002000","attachments":[{"fallback":"GitHub: microsoft/vscode-json-languageservice","id":1,"title":"microsoft/vscode-json-languageservice","title_link":"https://github.com/microsoft/vscode-json-languageservice/blob/fabbc8069d2b03b0ac73c1f710be4a5535df41d5/src/services/jsonSchemaService.ts#L567","text":"JSON language service extracted from VSCode to be reused, e.g in the Monaco editor. - microsoft/vscode-json-languageservice","thumb_url":"https://avatars2.githubusercontent.com/u/6154722?s=400&v=4","blocks":null,"service_name":"GitHub","service_icon":"https://a.slack-edge.com/80588/img/unfurl_icons/github.png","thumb_width":400,"thumb_height":400,"from_url":"https://github.com/microsoft/vscode-json-languageservice/blob/fabbc8069d2b03b0ac73c1f710be4a5535df41d5/src/services/jsonSchemaService.ts#L567","original_url":"https://github.com/microsoft/vscode-json-languageservice/blob/fabbc8069d2b03b0ac73c1f710be4a5535df41d5/src/services/jsonSchemaService.ts#L567"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Q0MMG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"032e2786-8fbb-4bca-b750-7ff22d0e0378","type":"message","user":"UG6DF6W87","text":"ためすか...","ts":"1587202552.002600","team":"T03C4RC8V","reactions":[{"name":"gativim","count":1,"users":["UAZ33BKV2"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YF/Qe"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f2713776-40e7-4c00-947b-23b876a6de78","type":"message","user":"UG6DF6W87","text":"あー...マージされてるなぁ","ts":"1587203110.003000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"XJ2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"0d1a142f-5b00-42f6-9f64-91da2adf7464","type":"message","user":"UG6DF6W87","text":"```{\n  \"json-languageserver\": {\n    \"schemas\": [\n      {\n        \"fileMatch\": [\"hoge.json\"],\n        \"url\": \"<http://json.schemastore.org/prettierrc>\"\n      },\n      {\n        \"fileMatch\": [\"hoge.json\"],\n        \"url\": \"<http://json.schemastore.org/package>\"\n      }\n    ]\n  }\n}```\nこれが `.vim-lsp-settings/settings.json`\nこの状態で `hoge.json` を\n```{\n  \"bracketSpacing\": true,\n  \"dependencies\": {}\n}```\nこうしてもエラーは吐かれないし、prettierrc のフィールドも package.json のフィールドも補完される...","ts":"1587203233.004600","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"9lnH"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8b7d618a-6bc5-40e2-bb59-90911e768fce","type":"message","user":"UG6DF6W87","text":"で、フィールド名が被ってるときの挙動は JSON schema の allOf か <https://json-schema.org/understanding-json-schema/reference/combining.html#allof>","ts":"1587203464.005300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2ZC"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5b76078e-5e5f-4d42-bdf3-684c635c5e8d","type":"message","user":"UG6DF6W87","text":"えー、これどうすりゃええんや...","ts":"1587203714.006100","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sec"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"540341f0-0ea1-41a8-9904-4c1760bacacf","type":"message","user":"UG6DF6W87","text":"vim-lsp-settings: ローカルに指定したやつ追加して送るやで &lt;- わかる\nvim-lsp/json-languageserver: 言われたやつをそのまま送るやで &lt;- わかる\njson-languageservice: 不便やろし JSON Schema にマージするための機能あるから fileMatch 被ってたらマージしとくやで &lt;- わかる","ts":"1587204472.009000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"eZaz"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6ebb4b34-bcd4-4725-bd44-e40de3931133","type":"message","user":"UAZ33BKV2","text":"善意の側面衝突みたいななにか...","ts":"1587204831.009300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"uZod"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"}]
