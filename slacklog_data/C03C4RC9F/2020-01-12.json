[{"client_msg_id":"29d9cf4f-534f-4aed-8575-23136fa9c4e5","type":"message","user":"U0M7GCBPD","text":"<https://twitter.com/_tyru_/status/1216020195602386944>","ts":"1578756915.271000","attachments":[{"fallback":"<https://twitter.com/_tyru_|@_tyru_>: macOS 10.15.2、Vim 8.2.96 で writefile({lines}, {fname}, 's') を行っているにも関わらず getftime() が古い変更日時を返す現象に出くわしてしまって時間が溶けた…\n<https://github.com/tyru/eskk.vim/pull/220>","id":1,"author_name":"tyru","author_subname":"@_tyru_","author_link":"https://twitter.com/_tyru_/status/1216020195602386944","author_icon":"https://pbs.twimg.com/profile_images/716604835328438272/4sZOAwSL_normal.jpg","text":"macOS 10.15.2、Vim 8.2.96 で writefile({lines}, {fname}, 's') を行っているにも関わらず getftime() が古い変更日時を返す現象に出くわしてしまって時間が溶けた…\n<https://github.com/tyru/eskk.vim/pull/220>","blocks":null,"footer":"Twitter","footer_icon":"https://a.slack-edge.com/80588/img/services/twitter_pixel_snapped_32.png","ts":1578756781,"service_name":"twitter","from_url":"https://twitter.com/_tyru_/status/1216020195602386944","original_url":"https://twitter.com/_tyru_/status/1216020195602386944"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"1qMzh"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"6971f021-5948-4b32-ab23-d3112fa55e77","type":"message","user":"U0M7GCBPD","text":"<@U9S4G0LJW> さんに登録してもらった issue 調査してたら闇に出会ってしまった","ts":"1578756948.271800","thread_ts":"1578756948.271800","reply_count":16,"replies":[{"user":"U9S4G0LJW","ts":"1578757086.272100"},{"user":"U9S4G0LJW","ts":"1578757513.272500"},{"user":"U0M7GCBPD","ts":"1578757689.273100"},{"user":"U9S4G0LJW","ts":"1578757792.274600"},{"user":"U0M7GCBPD","ts":"1578757805.274800"},{"user":"U9S4G0LJW","ts":"1578757857.275000"},{"user":"U0M7GCBPD","ts":"1578758109.275200"},{"user":"U0M7GCBPD","ts":"1578758133.275400"},{"user":"U9S4G0LJW","ts":"1578758194.275600"},{"user":"U0M7GCBPD","ts":"1578758222.275800"},{"user":"U0M7GCBPD","ts":"1578758251.276000"},{"user":"U0M7GCBPD","ts":"1578758323.276300"},{"user":"U9S4G0LJW","ts":"1578758428.276600"},{"user":"U0M7GCBPD","ts":"1578758732.276800"},{"user":"U9S4G0LJW","ts":"1578759505.277000"},{"user":"U9S4G0LJW","ts":"1578759806.277200"}],"team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"38K1p"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"69bbc80a-0001-4153-a2e0-93b7d971d967","type":"message","user":"U9S4G0LJW","text":"お、見てみます","ts":"1578757086.272100","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","reactions":[{"name":"kan","count":1,"users":["U0M7GCBPD"]},{"name":"sha","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"OeOL"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"fc387ac9-bdd0-4924-8ab8-e6ef51d27191","type":"message","user":"U9S4G0LJW","text":"動作確認取れました。自分でも中身見てたんですけど全く検討違いのところ見てたみたいです…","ts":"1578757513.272500","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"2Zf"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9f2f2c10-b76f-46b8-a128-051d44f96fe8","type":"message","user":"U9S4G0LJW","text":"これ、Vim本体側が悪い感じです？","ts":"1578757673.273000","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"Gi2"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8c857c50-1240-4356-a37f-0c7c18201914","type":"message","user":"U0M7GCBPD","text":"ありがとうございます！\n自分も右往左往したので大丈夫です :innocent: （eskk のコード見辛い + 原因不明の現象）","ts":"1578757689.273100","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"NIcuZ"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"40e2d5aa-abe2-4846-8b8d-71b1ab086da4","type":"message","user":"U0M7GCBPD","text":"分からないです…\n`writefile()` に `s` フラグは渡してるので `fsync()` してるはず (= メタデータも flush されてるはず？) なので `getftime()` で書込み後の変更日時が返ってくると思ったんですが…","ts":"1578757777.274500","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"v30B"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"db5d3825-ce33-4c27-857f-444b65032cb1","type":"message","user":"U9S4G0LJW","text":"原因不明の現象といえば一つ試してみてほしいことがあるんですがいいでしょうか","ts":"1578757792.274600","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lm25"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"df914e46-35d3-4c92-9799-28a8f919d7ab","type":"message","user":"U0M7GCBPD","text":"はい","ts":"1578757805.274800","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"FyO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"2d9b9b71-857f-4a7f-97f4-e39b7412684d","type":"message","user":"U9S4G0LJW","text":"eskkの辞書登録画面でCtrl+F押すと履歴出ると思うんですけど、そこでEnter押すとどうなります？","ts":"1578757857.275000","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"YHO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"c5aed4c8-2668-43a8-9a73-970d6fd0c55b","type":"message","user":"U0M7GCBPD","text":"「▽あいう」に「漢字」を登録する場合\n「▼漢字」って内容の cmdwin に移って\n`&lt;CR&gt;` 押しても bell 鳴るだけで何も起きないですね。\nちなみに `:q` すると Vim が落ちました :innocent:","ts":"1578758109.275200","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"JHr6x"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"f08095a7-0f32-49a7-8779-48d49384582c","type":"message","user":"U0M7GCBPD","text":"Vim が落ちるのはよく分からないですが cmdwin は完全に想定してなかったので対応してみます…","ts":"1578758133.275400","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"v=E"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"92a08899-4346-4789-a721-c738a4cb51d9","type":"message","user":"U9S4G0LJW","text":"そうですか、こっち(Archlinux)だとEnter押した時点でSEGVするんですよねぇ…環境依存感というか本体の問題な気がするので暇な時間にでも探ってみます","ts":"1578758194.275600","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"sYG"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"9143b9ac-c5dd-484a-ac74-0dd0657d4467","type":"message","user":"U0M7GCBPD","text":"あープラグインを eskk.vim だけにしたら同じになりました（Enter押した時点でSEGV）","ts":"1578758222.275800","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","reactions":[{"name":"innocent","count":1,"users":["U9S4G0LJW"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"THah"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"8eba5608-3c8b-4867-b632-113d81eb17a1","type":"message","user":"U0M7GCBPD","text":"落ちるのは本体の問題ですねぇ…","ts":"1578758251.276000","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"y+5"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"205ebb4d-9a8f-4b0b-a021-7ca21b0170da","type":"message","user":"U0M7GCBPD","text":"というか `input()` で cmdwin 使うの完全に想定してなかったですね…\nあまり使われてなさそうなので考慮してない部分が多いのかも :thinking_vim:","ts":"1578758323.276300","thread_ts":"1578756948.271800","edited":{"user":"U0M7GCBPD","ts":"1578758331.000000"},"parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"4K/n"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"ae7c1afa-ea2c-4873-80e7-184bb54d1bd1","type":"message","user":"U9S4G0LJW","text":"僕もC-gの誤爆で偶然引いちゃった感じですからね、このバグ。そもそもこれ見るまで使えることすら知らなかったという。","ts":"1578758428.276600","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"dekZO"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"7101ec71-0d6b-4d66-91c2-6086e6114af0","type":"message","user":"U0M7GCBPD","text":"当然だけど `input()` で cmdwin に入っただけじゃ落ちないな。\nわからんですが、language mapping ある時に何か問題があるのかもですね。","ts":"1578758732.276800","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yLR"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"06f4180a-93c9-4f40-9e2a-e56385e84a18","type":"message","user":"U9S4G0LJW","text":"試しに `inoremap &lt;expr&gt; &lt;C-a&gt; input(\"a\")` みたいなのマッピングした上でinsert mode上でeskk有効にして `input()` 上でcmdwinに入ってみたんですけど、これでも落ちないですね","ts":"1578759505.277000","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"/F23"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"5c4afe09-eb3a-4c1e-ab33-142000003007","type":"message","user":"U9S4G0LJW","text":"gdbで走らせてみたら例外キャッチするところで死んでるみたいで、eskk関係なさそうですね。空いた時間にでも再現手順探ってみます、お騒がせしました。","ts":"1578759806.277200","thread_ts":"1578756948.271800","parent_user_id":"U0M7GCBPD","team":"T03C4RC8V","reactions":[{"name":"+1","count":1,"users":["U0M7GCBPD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"lNG9"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"USLS9DENS","text":"<@USLS9DENS> has joined the channel","ts":"1578776073.277600","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"68138130-ddc1-4f18-b628-2faa5a2f20ed","type":"message","user":"U03C4RC8X","text":"lua実際かなり好きです。indexが1ではじまるのだけはいくらたっても全然なれないけど・・・","ts":"1578781868.278100","team":"T03C4RC8V","reactions":[{"name":"sorena","count":2,"users":["U9S4G0LJW","UEBF2KQTD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"yUT+"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"client_msg_id":"346b5a08-f1fb-45e3-b28b-5dfc5b365e41","type":"message","user":"U03C4RC8X","text":"weakrefとかもかわいいですよね","ts":"1578781873.278300","team":"T03C4RC8V","replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"SUR3R"}],"source_team":"T03C4RC8V","user_team":"T03C4RC8V"},{"type":"message","user":"US5U85UJW","text":"<@US5U85UJW> has joined the channel","ts":"1578784682.278500","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"type":"message","user":"US79LVATD","text":"<@US79LVATD> has joined the channel","ts":"1578794074.278900","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"type":"message","user":"US7A43NFM","text":"<@US7A43NFM> has joined the channel","ts":"1578797505.279200","subtype":"channel_join","replace_original":false,"delete_original":false,"blocks":null},{"client_msg_id":"f7cc9041-2904-4eeb-8aaf-b4293be81304","type":"message","user":"UEB130KJN","text":"ここに貼っていいかわかんないんですけどどうしても<@U03C71D7H> さんに届けたくて…","ts":"1578840896.282700","edited":{"user":"UEB130KJN","ts":"1578840911.000000"},"files":[{"id":"FS7GSATSP","created":1578840891,"timestamp":1578840891,"name":"IMG_20200112_115341.jpg","title":"65125","mimetype":"image/jpeg","image_exif_rotation":1,"filetype":"jpg","pretty_type":"JPEG","user":"UEB130KJN","mode":"hosted","editable":false,"is_external":false,"external_type":"","size":189681,"url":"","url_download":"","url_private":"https://files.slack.com/files-pri/T03C4RC8V-FS7GSATSP/img_20200112_115341.jpg","url_private_download":"https://files.slack.com/files-pri/T03C4RC8V-FS7GSATSP/download/img_20200112_115341.jpg","original_h":3024,"original_w":4032,"thumb_64":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_64.jpg","thumb_80":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_80.jpg","thumb_160":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_160.jpg","thumb_360":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_360.jpg","thumb_360_gif":"","thumb_360_w":360,"thumb_360_h":270,"thumb_480":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_480.jpg","thumb_480_w":480,"thumb_480_h":360,"thumb_720":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_720.jpg","thumb_720_w":720,"thumb_720_h":540,"thumb_960":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_960.jpg","thumb_960_w":960,"thumb_960_h":720,"thumb_1024":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_1024.jpg","thumb_1024_w":1024,"thumb_1024_h":768,"permalink":"https://vim-jp.slack.com/files/UEB130KJN/FS7GSATSP/img_20200112_115341.jpg","permalink_public":"https://slack-files.com/T03C4RC8V-FS7GSATSP-936680ca61","edit_link":"","preview":"","preview_highlight":"","lines":0,"lines_more":0,"is_public":true,"public_url_shared":false,"channels":null,"groups":null,"ims":null,"initial_comment":{},"comments_count":0,"num_stars":0,"is_starred":false,"shares":{"public":null,"private":null},"display_as_bot":false,"has_rich_preview":false,"thumb_800":"https://files.slack.com/files-tmb/T03C4RC8V-FS7GSATSP-f2af7bc312/img_20200112_115341_800.jpg","thumb_800_h":600,"thumb_800_w":800,"thumb_tiny":"AwAkADCkBSgZpQKXkD5eDW9jK4opQaQMTw3X1pDVJiHZpwPFR5pwNNMTQmAB1/WlG3HvUgUDsKXpRYXMQ4GckE/hTtgI6U8HNLTsJsjZUC8H5qZgj6U6ThuFJNOBOBlcfSo6lX0H03qadSVoQLRRRQIKQ0tIaBn/2Q==","username":""}],"upload":true,"reactions":[{"name":"thinca","count":23,"users":["U9S4G0LJW","U03C6TEAZ","U6XP9LZ6V","U7B4ZD49X","U03C71D7H","U78A6ESHM","U8CC7MDCL","UEX9VPSET","UBDMG6N2J","U06ECBRTJ","U8R597E9H","UG6DF6W87","UL6CFN8NR","UL5G6QL5U","U776661HA","U0M7GCBPD","UGMLBL4NN","UEB17JJJE","UKHUVMBJR","U782D5DF1","U76GA7MFA","UMUPYCYN8","UEBF2KQTD"]}],"replace_original":false,"delete_original":false,"blocks":[{"type":"rich_text","block_id":"3KtW"}]}]
